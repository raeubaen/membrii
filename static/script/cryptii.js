/*! cryptii v4.0.8+master.008b8a3 - (c) Fränz Friederes 2020 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("crypto")):"function"==typeof define&&define.amd?define("cryptii",["exports","crypto"],t):t((e=e||self).cryptii={},e.crypto)}(this,(function(e,t){t=t&&t.hasOwnProperty("default")?t.default:t;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e,t){return e(t={exports:{}},t.exports),t.exports}var o,s,l,u=function(e){return e&&e.Math==Math&&e},c=u("object"==typeof globalThis&&globalThis)||u("object"==typeof window&&window)||u("object"==typeof self&&self)||u("object"==typeof r&&r)||Function("return this")(),h=function(e){try{return!!e()}catch(e){return!0}},d=!h((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),f={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,p={f:g&&!f.call({1:2},1)?function(e){var t=g(this,e);return!!t&&t.enumerable}:f},v=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},m={}.toString,b=function(e){return m.call(e).slice(8,-1)},w="".split,_=h((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==b(e)?w.call(e,""):Object(e)}:Object,S=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},x=function(e){return _(S(e))},C=function(e){return"object"==typeof e?null!==e:"function"==typeof e},I=function(e,t){if(!C(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!C(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!C(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!C(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},V={}.hasOwnProperty,E=function(e,t){return V.call(e,t)},A=c.document,T=C(A)&&C(A.createElement),M=function(e){return T?A.createElement(e):{}},L=!d&&!h((function(){return 7!=Object.defineProperty(M("div"),"a",{get:function(){return 7}}).a})),P=Object.getOwnPropertyDescriptor,B={f:d?P:function(e,t){if(e=x(e),t=I(t,!0),L)try{return P(e,t)}catch(e){}if(E(e,t))return v(!p.f.call(e,t),e[t])}},z=function(e){if(!C(e))throw TypeError(String(e)+" is not an object");return e},N=Object.defineProperty,R={f:d?N:function(e,t,n){if(z(e),t=I(t,!0),z(n),L)try{return N(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},O=d?function(e,t,n){return R.f(e,t,v(1,n))}:function(e,t,n){return e[t]=n,e},F=function(e,t){try{O(c,e,t)}catch(n){c[e]=t}return t},D=c["__core-js_shared__"]||F("__core-js_shared__",{}),q=a((function(e){(e.exports=function(e,t){return D[e]||(D[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.4.1",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),$=q("native-function-to-string",Function.toString),U=c.WeakMap,W="function"==typeof U&&/native code/.test($.call(U)),H=0,G=Math.random(),K=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++H+G).toString(36)},Z=q("keys"),X=function(e){return Z[e]||(Z[e]=K(e))},Y={},J=c.WeakMap;if(W){var Q=new J,ee=Q.get,te=Q.has,ne=Q.set;o=function(e,t){return ne.call(Q,e,t),t},s=function(e){return ee.call(Q,e)||{}},l=function(e){return te.call(Q,e)}}else{var re=X("state");Y[re]=!0,o=function(e,t){return O(e,re,t),t},s=function(e){return E(e,re)?e[re]:{}},l=function(e){return E(e,re)}}var ie={set:o,get:s,has:l,enforce:function(e){return l(e)?s(e):o(e,{})},getterFor:function(e){return function(t){var n;if(!C(t)||(n=s(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ae=a((function(e){var t=ie.get,n=ie.enforce,r=String($).split("toString");q("inspectSource",(function(e){return $.call(e)})),(e.exports=function(e,t,i,a){var o=!!a&&!!a.unsafe,s=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||E(i,"name")||O(i,"name",t),n(i).source=r.join("string"==typeof t?t:"")),e!==c?(o?!l&&e[t]&&(s=!0):delete e[t],s?e[t]=i:O(e,t,i)):s?e[t]=i:F(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||$.call(this)}))})),oe=c,se=function(e){return"function"==typeof e?e:void 0},le=function(e,t){return arguments.length<2?se(oe[e])||se(c[e]):oe[e]&&oe[e][t]||c[e]&&c[e][t]},ue=Math.ceil,ce=Math.floor,he=function(e){return isNaN(e=+e)?0:(e>0?ce:ue)(e)},de=Math.min,fe=function(e){return e>0?de(he(e),9007199254740991):0},ge=Math.max,pe=Math.min,ve=function(e,t){var n=he(e);return n<0?ge(n+t,0):pe(n,t)},ye=function(e){return function(t,n,r){var i,a=x(t),o=fe(a.length),s=ve(r,o);if(e&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},me={includes:ye(!0),indexOf:ye(!1)},be=me.indexOf,ke=function(e,t){var n,r=x(e),i=0,a=[];for(n in r)!E(Y,n)&&E(r,n)&&a.push(n);for(;t.length>i;)E(r,n=t[i++])&&(~be(a,n)||a.push(n));return a},we=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_e=we.concat("length","prototype"),Se={f:Object.getOwnPropertyNames||function(e){return ke(e,_e)}},xe={f:Object.getOwnPropertySymbols},Ce=le("Reflect","ownKeys")||function(e){var t=Se.f(z(e)),n=xe.f;return n?t.concat(n(e)):t},Ie=function(e,t){for(var n=Ce(t),r=R.f,i=B.f,a=0;a<n.length;a++){var o=n[a];E(e,o)||r(e,o,i(t,o))}},Ve=/#|\.prototype\./,Ee=function(e,t){var n=Te[Ae(e)];return n==Le||n!=Me&&("function"==typeof t?h(t):!!t)},Ae=Ee.normalize=function(e){return String(e).replace(Ve,".").toLowerCase()},Te=Ee.data={},Me=Ee.NATIVE="N",Le=Ee.POLYFILL="P",Pe=Ee,Be=B.f,ze=function(e,t){var n,r,i,a,o,s=e.target,l=e.global,u=e.stat;if(n=l?c:u?c[s]||F(s,{}):(c[s]||{}).prototype)for(r in t){if(a=t[r],i=e.noTargetGet?(o=Be(n,r))&&o.value:n[r],!Pe(l?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;Ie(a,i)}(e.sham||i&&i.sham)&&O(a,"sham",!0),ae(n,r,a,e)}},Ne=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Re=function(e,t,n){if(Ne(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},Oe=function(e){return Object(S(e))},Fe=Array.isArray||function(e){return"Array"==b(e)},De=!!Object.getOwnPropertySymbols&&!h((function(){return!String(Symbol())})),je=c.Symbol,qe=q("wks"),$e=function(e){return qe[e]||(qe[e]=De&&je[e]||(De?je:K)("Symbol."+e))},Ue=$e("species"),We=function(e,t){var n;return Fe(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Fe(n.prototype)?C(n)&&null===(n=n[Ue])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},He=[].push,Ge=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,a=6==e,o=5==e||a;return function(s,l,u,c){for(var h,d,f=Oe(s),g=_(f),p=Re(l,u,3),v=fe(g.length),y=0,m=c||We,b=t?m(s,v):n?m(s,0):void 0;v>y;y++)if((o||y in g)&&(d=p(h=g[y],y,f),e))if(t)b[y]=d;else if(d)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:He.call(b,h)}else if(i)return!1;return a?-1:r||i?i:b}},Ke={forEach:Ge(0),map:Ge(1),filter:Ge(2),some:Ge(3),every:Ge(4),find:Ge(5),findIndex:Ge(6)},Ze=function(e,t){var n=[][e];return!n||!h((function(){n.call(null,t||function(){throw 1},1)}))},Xe=Ke.forEach,Ye=Ze("forEach")?function(e){return Xe(this,e,arguments.length>1?arguments[1]:void 0)}:[].forEach;ze({target:"Array",proto:!0,forced:[].forEach!=Ye},{forEach:Ye});var Je=Object.keys||function(e){return ke(e,we)},Qe=Object.assign,et=!Qe||h((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=Qe({},e)[n]||"abcdefghijklmnopqrst"!=Je(Qe({},t)).join("")}))?function(e,t){for(var n=Oe(e),r=arguments.length,i=1,a=xe.f,o=p.f;r>i;)for(var s,l=_(arguments[i++]),u=a?Je(l).concat(a(l)):Je(l),c=u.length,h=0;c>h;)s=u[h++],d&&!o.call(l,s)||(n[s]=l[s]);return n}:Qe;ze({target:"Object",stat:!0,forced:Object.assign!==et},{assign:et});var tt={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var nt in tt){var rt=c[nt],it=rt&&rt.prototype;if(it&&it.forEach!==Ye)try{O(it,"forEach",Ye)}catch(e){it.forEach=Ye}}function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function st(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t,n){return t&&st(e.prototype,t),n&&st(e,n),e}function ut(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dt(e,t,n){return(dt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&ht(i,n.prototype),i}).apply(null,arguments)}function ft(e){var t="function"==typeof Map?new Map:void 0;return(ft=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return dt(e,arguments,ct(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ht(r,e)})(e)}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pt(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?gt(e):t}function vt(e,t,n){return(vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ct(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var bt,kt,wt=le("navigator","userAgent")||"",_t=c.process,St=_t&&_t.versions,xt=St&&St.v8;xt?kt=(bt=xt.split("."))[0]+bt[1]:wt&&(!(bt=wt.match(/Edge\/(\d+)/))||bt[1]>=74)&&(bt=wt.match(/Chrome\/(\d+)/))&&(kt=bt[1]);var Ct=kt&&+kt,It=$e("species"),Vt=function(e){return Ct>=51||!h((function(){var t=[];return(t.constructor={})[It]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Et=Ke.filter;ze({target:"Array",proto:!0,forced:!Vt("filter")},{filter:function(e){return Et(this,e,arguments.length>1?arguments[1]:void 0)}});var At=me.indexOf,Tt=[].indexOf,Mt=!!Tt&&1/[1].indexOf(1,-0)<0,Lt=Ze("indexOf");ze({target:"Array",proto:!0,forced:Mt||Lt},{indexOf:function(e){return Mt?Tt.apply(this,arguments)||0:At(this,e,arguments.length>1?arguments[1]:void 0)}});var Pt=function(e,t,n){var r=I(t);r in e?R.f(e,r,v(0,n)):e[r]=n},Bt=Math.max,zt=Math.min;ze({target:"Array",proto:!0,forced:!Vt("splice")},{splice:function(e,t){var n,r,i,a,o,s,l=Oe(this),u=fe(l.length),c=ve(e,u),h=arguments.length;if(0===h?n=r=0:1===h?(n=0,r=u-c):(n=h-2,r=zt(Bt(he(t),0),u-c)),u+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(i=We(l,r),a=0;a<r;a++)(o=c+a)in l&&Pt(i,a,l[o]);if(i.length=r,n<r){for(a=c;a<u-r;a++)s=a+n,(o=a+r)in l?l[s]=l[o]:delete l[s];for(a=u;a>u-r+n;a--)delete l[a-1]}else if(n>r)for(a=u-r;a>c;a--)s=a+n-1,(o=a+r-1)in l?l[s]=l[o]:delete l[s];for(a=0;a<n;a++)l[a+c]=arguments[a+2];return l.length=u-r+n,i}});var Nt=Date.prototype,Rt=Nt.toString,Ot=Nt.getTime;new Date(NaN)+""!="Invalid Date"&&ae(Nt,"toString",(function(){var e=Ot.call(this);return e==e?Rt.call(this):"Invalid Date"}));var Ft=h((function(){Je(1)}));ze({target:"Object",stat:!0,forced:Ft},{keys:function(e){return Je(Oe(e))}});var Dt=$e("toStringTag"),jt="Arguments"==b(function(){return arguments}()),qt=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Dt))?n:jt?b(t):"Object"==(r=b(t))&&"function"==typeof t.callee?"Arguments":r},$t={};$t[$e("toStringTag")]="z";var Ut="[object z]"!==String($t)?function(){return"[object "+qt(this)+"]"}:$t.toString,Wt=Object.prototype;Ut!==Wt.toString&&ae(Wt,"toString",Ut,{unsafe:!0});var Ht=function(){var e=z(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Gt=RegExp.prototype,Kt=Gt.toString,Zt=h((function(){return"/a/b"!=Kt.call({source:"a",flags:"b"})})),Xt="toString"!=Kt.name;(Zt||Xt)&&ae(RegExp.prototype,"toString",(function(){var e=z(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Gt)?Ht.call(e):n)}),{unsafe:!0});var Yt={role:"role",ariaHidden:"aria-hidden",ariaLabel:"aria-label"},Jt=function(){function e(){ot(this,e),this._$root=null,this._superview=null,this._subviews=[],this._model=null,this._focus=!1,this._needsUpdate=!1}return lt(e,null,[{key:"createElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=document.createElement(e);if(Object.keys(t).forEach((function(e){var n=t[e];if(void 0===Yt[e]){var i=0===e.indexOf("on")?e.toLowerCase():e;r[i]=n}else r.setAttribute(Yt[e],n)})),null!==n)switch(Object.prototype.toString.call(n)){case"[object String]":r.innerText=n;break;case"[object Array]":n.forEach((function(e){return e&&r.appendChild(e)}));break;default:r.appendChild(n)}return r}}]),lt(e,[{key:"getElement",value:function(){return null===this._$root&&(this.willRender(),this._$root=this.render(),this.didRender()),this._$root}},{key:"refresh",value:function(){var e=this._$root;return null===e?this:(this._$root=null,this.willRender(),this._$root=this.render(),this.didRender(),this.getSubviews().forEach(this.appendSubviewElement),e&&e.parentNode&&e.parentNode.replaceChild(this._$root,e),this)}},{key:"render",value:function(){return e.createElement("div")}},{key:"setNeedsUpdate",value:function(){var e=this;return this._needsUpdate||(this._needsUpdate=!0,window.requestAnimationFrame((function(){e._needsUpdate=!1,e.update()}))),this}},{key:"update",value:function(){}},{key:"willRender",value:function(){}},{key:"didRender",value:function(){this.update()}},{key:"layout",value:function(){return this._subviews.forEach((function(e){return e.layout()})),this}},{key:"addSubview",value:function(e){e.removeFromSuperview(),this.appendSubviewElement(e),e.setSuperview(this),this._subviews.push(e)}},{key:"getSubviews",value:function(){return this._subviews}},{key:"appendSubviewElement",value:function(e){return e.getElement().parentNode!==this.getElement()&&this.getElement().appendChild(e.getElement()),this}},{key:"removeSubview",value:function(e){var t=this._subviews.indexOf(e);-1!==t&&(this._subviews.splice(t,1),e.setSuperview(null),this.removeSubviewElement(e))}},{key:"removeSubviewElement",value:function(e){var t=e.getElement();return null!==t.parentNode&&t.parentNode.removeChild(e.getElement()),this}},{key:"removeFromSuperview",value:function(){return null!==this._superview&&this._superview.removeSubview(this),this}},{key:"getSuperview",value:function(){return this._superview}},{key:"setSuperview",value:function(e){return this._superview=e,this}},{key:"focus",value:function(){return this.setFocus(!0)}},{key:"blur",value:function(){return this.setFocus(!1)}},{key:"setFocus",value:function(e){return e!==this._focus&&(this._focus=e,e?(null!==this._superview&&this._superview.subviewDidFocus(this),this.didFocus()):(this._subviews.forEach((function(e){return e.blur()})),this.didBlur())),this}},{key:"hasFocus",value:function(){return this._focus}},{key:"subviewDidFocus",value:function(e){this.hasFocus()?this._subviews.filter((function(t){return t!==e})).forEach((function(e){return e.blur()})):this.focus()}},{key:"didFocus",value:function(){}},{key:"didBlur",value:function(){}},{key:"getModel",value:function(){return this._model}},{key:"hasModel",value:function(){return null!==this._model}},{key:"setModel",value:function(e){return this._model=e,this}}]),e}(),Qt=function(e){function t(){return ot(this,t),pt(this,ct(t).apply(this,arguments))}return ut(t,e),lt(t,[{key:"render",value:function(){var e=document.querySelector(".app");return window.addEventListener("resize",this.windowDidResize.bind(this),!1),e}},{key:"windowDidResize",value:function(e){this.layout()}}]),t}(Jt),en=Ke.map;ze({target:"Array",proto:!0,forced:!Vt("map")},{map:function(e){return en(this,e,arguments.length>1?arguments[1]:void 0)}});var tn=R.f,nn=Function.prototype,rn=nn.toString,an=/^\s*function ([^ (]*)/;!d||"name"in nn||tn(nn,"name",{configurable:!0,get:function(){try{return rn.call(this).match(an)[1]}catch(e){return""}}});var on=function(){function e(){ot(this,e),this._identifiers=[],this._invokables=[]}return lt(e,[{key:"getIdentifiers",value:function(){return this._identifiers}},{key:"getInvokable",value:function(e){var t=this._identifiers.indexOf(e);if(-1===t)throw new Error("Invokable for '".concat(e,"' has not been registered yet."));return this._invokables[t]}},{key:"register",value:function(e,t){if(this.exists(e))throw new Error("Invokable can't be registered. "+"Identifier ".concat(e," already exists."));return this._identifiers.push(e),this._invokables.push(t),this}},{key:"exists",value:function(e){return-1!==this._identifiers.indexOf(e)}},{key:"create",value:function(e){if(!this.exists(e))throw new Error("Can't create '".concat(e,"', invokable has not been registered."));for(var t=this._identifiers.indexOf(e),n=this._invokables[t],r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i.splice(0,0,n),new(Function.prototype.bind.apply(n,i))}}],[{key:"getInstance",value:function(){}}]),e}(),sn="\t\n\v\f\r                　\u2028\u2029\ufeff",ln="["+sn+"]",un=RegExp("^"+ln+ln+"*"),cn=RegExp(ln+ln+"*$"),hn=function(e){return function(t){var n=String(S(t));return 1&e&&(n=n.replace(un,"")),2&e&&(n=n.replace(cn,"")),n}},dn={start:hn(1),end:hn(2),trim:hn(3)},fn=dn.trim,gn=c.parseInt,pn=/^[+-]?0[Xx]/,vn=8!==gn(sn+"08")||22!==gn(sn+"0x16")?function(e,t){var n=fn(String(e));return gn(n,t>>>0||(pn.test(n)?16:10))}:gn;ze({global:!0,forced:parseInt!=vn},{parseInt:vn});var yn=[].join,mn=_!=Object,bn=Ze("join",",");ze({target:"Array",proto:!0,forced:mn||bn},{join:function(e){return yn.call(x(this),void 0===e?",":e)}});var kn=RegExp.prototype.exec,wn=String.prototype.replace,_n=kn,Sn=function(){var e=/a/,t=/b*/g;return kn.call(e,"a"),kn.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),xn=void 0!==/()??/.exec("")[1];(Sn||xn)&&(_n=function(e){var t,n,r,i,a=this;return xn&&(n=new RegExp("^"+a.source+"$(?!\\s)",Ht.call(a))),Sn&&(t=a.lastIndex),r=kn.call(a,e),Sn&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),xn&&r&&r.length>1&&wn.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var Cn=_n;ze({target:"RegExp",proto:!0,forced:/./.exec!==Cn},{exec:Cn});var In=$e("species"),Vn=!h((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),En=!h((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),An=function(e,t,n,r){var i=$e(e),a=!h((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),o=a&&!h((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[In]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!a||!o||"replace"===e&&!Vn||"split"===e&&!En){var s=/./[i],l=n(i,""[e],(function(e,t,n,r,i){return t.exec===Cn?a&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),u=l[0],c=l[1];ae(String.prototype,e,u),ae(RegExp.prototype,i,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)}),r&&O(RegExp.prototype[i],"sham",!0)}},Tn=$e("match"),Mn=function(e){var t;return C(e)&&(void 0!==(t=e[Tn])?!!t:"RegExp"==b(e))},Ln=$e("species"),Pn=function(e,t){var n,r=z(e).constructor;return void 0===r||null==(n=z(r)[Ln])?t:Ne(n)},Bn=function(e){return function(t,n){var r,i,a=String(S(t)),o=he(n),s=a.length;return o<0||o>=s?e?"":void 0:(r=a.charCodeAt(o))<55296||r>56319||o+1===s||(i=a.charCodeAt(o+1))<56320||i>57343?e?a.charAt(o):r:e?a.slice(o,o+2):i-56320+(r-55296<<10)+65536}},zn={codeAt:Bn(!1),charAt:Bn(!0)},Nn=zn.charAt,Rn=function(e,t,n){return t+(n?Nn(e,t).length:1)},On=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==b(e))throw TypeError("RegExp#exec called on incompatible receiver");return Cn.call(e,t)},Fn=[].push,Dn=Math.min,jn=!h((function(){return!RegExp(4294967295,"y")}));An("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(S(this)),i=void 0===n?4294967295:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!Mn(e))return t.call(r,e,i);for(var a,o,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,h=new RegExp(e.source,u+"g");(a=Cn.call(h,r))&&!((o=h.lastIndex)>c&&(l.push(r.slice(c,a.index)),a.length>1&&a.index<r.length&&Fn.apply(l,a.slice(1)),s=a[0].length,c=o,l.length>=i));)h.lastIndex===a.index&&h.lastIndex++;return c===r.length?!s&&h.test("")||l.push(""):l.push(r.slice(c)),l.length>i?l.slice(0,i):l}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=S(this),a=null==t?void 0:t[e];return void 0!==a?a.call(t,i,n):r.call(String(i),t,n)},function(e,i){var a=n(r,e,this,i,r!==t);if(a.done)return a.value;var o=z(e),s=String(this),l=Pn(o,RegExp),u=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(jn?"y":"g"),h=new l(jn?o:"^(?:"+o.source+")",c),d=void 0===i?4294967295:i>>>0;if(0===d)return[];if(0===s.length)return null===On(h,s)?[s]:[];for(var f=0,g=0,p=[];g<s.length;){h.lastIndex=jn?g:0;var v,y=On(h,jn?s:s.slice(g));if(null===y||(v=Dn(fe(h.lastIndex+(jn?0:g)),s.length))===f)g=Rn(s,g,u);else{if(p.push(s.slice(f,g)),p.length===d)return p;for(var m=1;m<=y.length-1;m++)if(p.push(y[m]),p.length===d)return p;g=f=v}}return p.push(s.slice(f)),p}]}),!jn);var qn=d?Object.defineProperties:function(e,t){z(e);for(var n,r=Je(t),i=r.length,a=0;i>a;)R.f(e,n=r[a++],t[n]);return e},$n=le("document","documentElement"),Un=X("IE_PROTO"),Wn=function(){},Hn=function(){var e,t=M("iframe"),n=we.length;for(t.style.display="none",$n.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),Hn=e.F;n--;)delete Hn.prototype[we[n]];return Hn()},Gn=Object.create||function(e,t){var n;return null!==e?(Wn.prototype=z(e),n=new Wn,Wn.prototype=null,n[Un]=e):n=Hn(),void 0===t?n:qn(n,t)};Y[Un]=!0;var Kn=Se.f,Zn={}.toString,Xn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Yn={f:function(e){return Xn&&"[object Window]"==Zn.call(e)?function(e){try{return Kn(e)}catch(e){return Xn.slice()}}(e):Kn(x(e))}},Jn={f:$e},Qn=R.f,er=function(e){var t=oe.Symbol||(oe.Symbol={});E(t,e)||Qn(t,e,{value:Jn.f(e)})},tr=R.f,nr=$e("toStringTag"),rr=function(e,t,n){e&&!E(e=n?e:e.prototype,nr)&&tr(e,nr,{configurable:!0,value:t})},ir=Ke.forEach,ar=X("hidden"),or=$e("toPrimitive"),sr=ie.set,lr=ie.getterFor("Symbol"),ur=Object.prototype,cr=c.Symbol,hr=le("JSON","stringify"),dr=B.f,fr=R.f,gr=Yn.f,pr=p.f,vr=q("symbols"),yr=q("op-symbols"),mr=q("string-to-symbol-registry"),br=q("symbol-to-string-registry"),kr=q("wks"),wr=c.QObject,_r=!wr||!wr.prototype||!wr.prototype.findChild,Sr=d&&h((function(){return 7!=Gn(fr({},"a",{get:function(){return fr(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=dr(ur,t);r&&delete ur[t],fr(e,t,n),r&&e!==ur&&fr(ur,t,r)}:fr,xr=function(e,t){var n=vr[e]=Gn(cr.prototype);return sr(n,{type:"Symbol",tag:e,description:t}),d||(n.description=t),n},Cr=De&&"symbol"==typeof cr.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof cr},Ir=function(e,t,n){e===ur&&Ir(yr,t,n),z(e);var r=I(t,!0);return z(n),E(vr,r)?(n.enumerable?(E(e,ar)&&e[ar][r]&&(e[ar][r]=!1),n=Gn(n,{enumerable:v(0,!1)})):(E(e,ar)||fr(e,ar,v(1,{})),e[ar][r]=!0),Sr(e,r,n)):fr(e,r,n)},Vr=function(e,t){z(e);var n=x(t),r=Je(n).concat(Mr(n));return ir(r,(function(t){d&&!Er.call(n,t)||Ir(e,t,n[t])})),e},Er=function(e){var t=I(e,!0),n=pr.call(this,t);return!(this===ur&&E(vr,t)&&!E(yr,t))&&(!(n||!E(this,t)||!E(vr,t)||E(this,ar)&&this[ar][t])||n)},Ar=function(e,t){var n=x(e),r=I(t,!0);if(n!==ur||!E(vr,r)||E(yr,r)){var i=dr(n,r);return!i||!E(vr,r)||E(n,ar)&&n[ar][r]||(i.enumerable=!0),i}},Tr=function(e){var t=gr(x(e)),n=[];return ir(t,(function(e){E(vr,e)||E(Y,e)||n.push(e)})),n},Mr=function(e){var t=e===ur,n=gr(t?yr:x(e)),r=[];return ir(n,(function(e){!E(vr,e)||t&&!E(ur,e)||r.push(vr[e])})),r};if(De||(ae((cr=function(){if(this instanceof cr)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=K(e),n=function(e){this===ur&&n.call(yr,e),E(this,ar)&&E(this[ar],t)&&(this[ar][t]=!1),Sr(this,t,v(1,e))};return d&&_r&&Sr(ur,t,{configurable:!0,set:n}),xr(t,e)}).prototype,"toString",(function(){return lr(this).tag})),p.f=Er,R.f=Ir,B.f=Ar,Se.f=Yn.f=Tr,xe.f=Mr,d&&(fr(cr.prototype,"description",{configurable:!0,get:function(){return lr(this).description}}),ae(ur,"propertyIsEnumerable",Er,{unsafe:!0})),Jn.f=function(e){return xr($e(e),e)}),ze({global:!0,wrap:!0,forced:!De,sham:!De},{Symbol:cr}),ir(Je(kr),(function(e){er(e)})),ze({target:"Symbol",stat:!0,forced:!De},{for:function(e){var t=String(e);if(E(mr,t))return mr[t];var n=cr(t);return mr[t]=n,br[n]=t,n},keyFor:function(e){if(!Cr(e))throw TypeError(e+" is not a symbol");if(E(br,e))return br[e]},useSetter:function(){_r=!0},useSimple:function(){_r=!1}}),ze({target:"Object",stat:!0,forced:!De,sham:!d},{create:function(e,t){return void 0===t?Gn(e):Vr(Gn(e),t)},defineProperty:Ir,defineProperties:Vr,getOwnPropertyDescriptor:Ar}),ze({target:"Object",stat:!0,forced:!De},{getOwnPropertyNames:Tr,getOwnPropertySymbols:Mr}),ze({target:"Object",stat:!0,forced:h((function(){xe.f(1)}))},{getOwnPropertySymbols:function(e){return xe.f(Oe(e))}}),hr){var Lr=!De||h((function(){var e=cr();return"[null]"!=hr([e])||"{}"!=hr({a:e})||"{}"!=hr(Object(e))}));ze({target:"JSON",stat:!0,forced:Lr},{stringify:function(e,t,n){for(var r,i=[e],a=1;arguments.length>a;)i.push(arguments[a++]);if(r=t,(C(t)||void 0!==e)&&!Cr(e))return Fe(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Cr(t))return t}),i[1]=t,hr.apply(null,i)}})}cr.prototype[or]||O(cr.prototype,or,cr.prototype.valueOf),rr(cr,"Symbol"),Y[ar]=!0;var Pr=R.f,Br=c.Symbol;if(d&&"function"==typeof Br&&(!("description"in Br.prototype)||void 0!==Br().description)){var zr={},Nr=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Nr?new Br(e):void 0===e?Br():Br(e);return""===e&&(zr[t]=!0),t};Ie(Nr,Br);var Rr=Nr.prototype=Br.prototype;Rr.constructor=Nr;var Or=Rr.toString,Fr="Symbol(test)"==String(Br("test")),Dr=/^Symbol\((.*)\)[^)]+$/;Pr(Rr,"description",{configurable:!0,get:function(){var e=C(this)?this.valueOf():this,t=Or.call(e);if(E(zr,e))return"";var n=Fr?t.slice(7,-1):t.replace(Dr,"$1");return""===n?void 0:n}}),ze({global:!0,forced:!0},{Symbol:Nr})}er("iterator");var jr=$e("unscopables"),qr=Array.prototype;null==qr[jr]&&O(qr,jr,Gn(null));var $r,Ur,Wr,Hr=function(e){qr[jr][e]=!0},Gr={},Kr=!h((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Zr=X("IE_PROTO"),Xr=Object.prototype,Yr=Kr?Object.getPrototypeOf:function(e){return e=Oe(e),E(e,Zr)?e[Zr]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Xr:null},Jr=$e("iterator"),Qr=!1;[].keys&&("next"in(Wr=[].keys())?(Ur=Yr(Yr(Wr)))!==Object.prototype&&($r=Ur):Qr=!0),null==$r&&($r={}),E($r,Jr)||O($r,Jr,(function(){return this}));var ei={IteratorPrototype:$r,BUGGY_SAFARI_ITERATORS:Qr},ti=ei.IteratorPrototype,ni=function(){return this},ri=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return z(n),function(e){if(!C(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),ii=ei.IteratorPrototype,ai=ei.BUGGY_SAFARI_ITERATORS,oi=$e("iterator"),si=function(){return this},li=function(e,t,n,r,i,a,o){!function(e,t,n){var r=t+" Iterator";e.prototype=Gn(ti,{next:v(1,n)}),rr(e,r,!1),Gr[r]=ni}(n,t,r);var s,l,u,c=function(e){if(e===i&&p)return p;if(!ai&&e in f)return f[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},h=t+" Iterator",d=!1,f=e.prototype,g=f[oi]||f["@@iterator"]||i&&f[i],p=!ai&&g||c(i),y="Array"==t&&f.entries||g;if(y&&(s=Yr(y.call(new e)),ii!==Object.prototype&&s.next&&(Yr(s)!==ii&&(ri?ri(s,ii):"function"!=typeof s[oi]&&O(s,oi,si)),rr(s,h,!0))),"values"==i&&g&&"values"!==g.name&&(d=!0,p=function(){return g.call(this)}),f[oi]!==p&&O(f,oi,p),Gr[t]=p,i)if(l={values:c("values"),keys:a?p:c("keys"),entries:c("entries")},o)for(u in l)!ai&&!d&&u in f||ae(f,u,l[u]);else ze({target:t,proto:!0,forced:ai||d},l);return l},ui=ie.set,ci=ie.getterFor("Array Iterator"),hi=li(Array,"Array",(function(e,t){ui(this,{type:"Array Iterator",target:x(e),index:0,kind:t})}),(function(){var e=ci(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");Gr.Arguments=Gr.Array,Hr("keys"),Hr("values"),Hr("entries");var di=$e("species"),fi=[].slice,gi=Math.max;ze({target:"Array",proto:!0,forced:!Vt("slice")},{slice:function(e,t){var n,r,i,a=x(this),o=fe(a.length),s=ve(e,o),l=ve(void 0===t?o:t,o);if(Fe(a)&&("function"!=typeof(n=a.constructor)||n!==Array&&!Fe(n.prototype)?C(n)&&null===(n=n[di])&&(n=void 0):n=void 0,n===Array||void 0===n))return fi.call(a,s,l);for(r=new(void 0===n?Array:n)(gi(l-s,0)),i=0;s<l;s++,i++)s in a&&Pt(r,i,a[s]);return r.length=i,r}});var pi,vi=R.f,yi=c.DataView,mi=yi&&yi.prototype,bi=c.Int8Array,ki=bi&&bi.prototype,wi=c.Uint8ClampedArray,_i=wi&&wi.prototype,Si=bi&&Yr(bi),xi=ki&&Yr(ki),Ci=Object.prototype,Ii=Ci.isPrototypeOf,Vi=$e("toStringTag"),Ei=K("TYPED_ARRAY_TAG"),Ai=!(!c.ArrayBuffer||!yi),Ti=Ai&&!!ri&&"Opera"!==qt(c.opera),Mi=!1,Li={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Pi=function(e){return C(e)&&E(Li,qt(e))};for(pi in Li)c[pi]||(Ti=!1);if((!Ti||"function"!=typeof Si||Si===Function.prototype)&&(Si=function(){throw TypeError("Incorrect invocation")},Ti))for(pi in Li)c[pi]&&ri(c[pi],Si);if((!Ti||!xi||xi===Ci)&&(xi=Si.prototype,Ti))for(pi in Li)c[pi]&&ri(c[pi].prototype,xi);if(Ti&&Yr(_i)!==xi&&ri(_i,xi),d&&!E(xi,Vi))for(pi in Mi=!0,vi(xi,Vi,{get:function(){return C(this)?this[Ei]:void 0}}),Li)c[pi]&&O(c[pi],Ei,pi);Ai&&ri&&Yr(mi)!==Ci&&ri(mi,Ci);var Bi={NATIVE_ARRAY_BUFFER:Ai,NATIVE_ARRAY_BUFFER_VIEWS:Ti,TYPED_ARRAY_TAG:Mi&&Ei,aTypedArray:function(e){if(Pi(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(ri){if(Ii.call(Si,e))return e}else for(var t in Li)if(E(Li,pi)){var n=c[t];if(n&&(e===n||Ii.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportProto:function(e,t,n){if(d){if(n)for(var r in Li){var i=c[r];i&&E(i.prototype,e)&&delete i.prototype[e]}xi[e]&&!n||ae(xi,e,n?t:Ti&&ki[e]||t)}},exportStatic:function(e,t,n){var r,i;if(d){if(ri){if(n)for(r in Li)(i=c[r])&&E(i,e)&&delete i[e];if(Si[e]&&!n)return;try{return ae(Si,e,n?t:Ti&&bi[e]||t)}catch(e){}}for(r in Li)!(i=c[r])||i[e]&&!n||ae(i,e,t)}},isView:function(e){var t=qt(e);return"DataView"===t||E(Li,t)},isTypedArray:Pi,TypedArray:Si,TypedArrayPrototype:xi},zi=function(e,t,n){for(var r in t)ae(e,r,t[r],n);return e},Ni=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Ri=function(e){if(void 0===e)return 0;var t=he(e),n=fe(t);if(t!==n)throw RangeError("Wrong length or index");return n},Oi=function(e){for(var t=Oe(this),n=fe(t.length),r=arguments.length,i=ve(r>1?arguments[1]:void 0,n),a=r>2?arguments[2]:void 0,o=void 0===a?n:ve(a,n);o>i;)t[i++]=e;return t},Fi=Bi.NATIVE_ARRAY_BUFFER,Di=Se.f,ji=R.f,qi=ie.get,$i=ie.set,Ui=c.ArrayBuffer,Wi=Ui,Hi=c.DataView,Gi=c.Math,Ki=c.RangeError,Zi=Gi.abs,Xi=Gi.pow,Yi=Gi.floor,Ji=Gi.log,Qi=Gi.LN2,ea=function(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,c=23===t?Xi(2,-24)-Xi(2,-77):0,h=e<0||0===e&&1/e<0?1:0,d=0;for((e=Zi(e))!=e||e===1/0?(i=e!=e?1:0,r=l):(r=Yi(Ji(e)/Qi),e*(a=Xi(2,-r))<1&&(r--,a*=2),(e+=r+u>=1?c/a:c*Xi(2,1-u))*a>=2&&(r++,a/=2),r+u>=l?(i=0,r=l):r+u>=1?(i=(e*a-1)*Xi(2,t),r+=u):(i=e*Xi(2,u-1)*Xi(2,t),r=0));t>=8;o[d++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[d++]=255&r,r/=256,s-=8);return o[--d]|=128*h,o},ta=function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,o=a>>1,s=i-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;s>0;c=256*c+e[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=t;s>0;n=256*n+e[l],l--,s-=8);if(0===c)c=1-o;else{if(c===a)return n?NaN:u?-1/0:1/0;n+=Xi(2,t),c-=o}return(u?-1:1)*n*Xi(2,c-t)},na=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},ra=function(e){return[255&e]},ia=function(e){return[255&e,e>>8&255]},aa=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},oa=function(e){return ea(e,23,4)},sa=function(e){return ea(e,52,8)},la=function(e,t){ji(e.prototype,t,{get:function(){return qi(this)[t]}})},ua=function(e,t,n,r){var i=Ri(+n),a=qi(e);if(i+t>a.byteLength)throw Ki("Wrong index");var o=qi(a.buffer).bytes,s=i+a.byteOffset,l=o.slice(s,s+t);return r?l:l.reverse()},ca=function(e,t,n,r,i,a){var o=Ri(+n),s=qi(e);if(o+t>s.byteLength)throw Ki("Wrong index");for(var l=qi(s.buffer).bytes,u=o+s.byteOffset,c=r(+i),h=0;h<t;h++)l[u+h]=c[a?h:t-h-1]};if(Fi){if(!h((function(){Ui(1)}))||!h((function(){new Ui(-1)}))||h((function(){return new Ui,new Ui(1.5),new Ui(NaN),"ArrayBuffer"!=Ui.name}))){for(var ha,da=(Wi=function(e){return Ni(this,Wi),new Ui(Ri(e))}).prototype=Ui.prototype,fa=Di(Ui),ga=0;fa.length>ga;)(ha=fa[ga++])in Wi||O(Wi,ha,Ui[ha]);da.constructor=Wi}var pa=new Hi(new Wi(2)),va=Hi.prototype.setInt8;pa.setInt8(0,2147483648),pa.setInt8(1,2147483649),!pa.getInt8(0)&&pa.getInt8(1)||zi(Hi.prototype,{setInt8:function(e,t){va.call(this,e,t<<24>>24)},setUint8:function(e,t){va.call(this,e,t<<24>>24)}},{unsafe:!0})}else Wi=function(e){Ni(this,Wi,"ArrayBuffer");var t=Ri(e);$i(this,{bytes:Oi.call(new Array(t),0),byteLength:t}),d||(this.byteLength=t)},Hi=function(e,t,n){Ni(this,Hi,"DataView"),Ni(e,Wi,"DataView");var r=qi(e).byteLength,i=he(t);if(i<0||i>r)throw Ki("Wrong offset");if(i+(n=void 0===n?r-i:fe(n))>r)throw Ki("Wrong length");$i(this,{buffer:e,byteLength:n,byteOffset:i}),d||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},d&&(la(Wi,"byteLength"),la(Hi,"buffer"),la(Hi,"byteLength"),la(Hi,"byteOffset")),zi(Hi.prototype,{getInt8:function(e){return ua(this,1,e)[0]<<24>>24},getUint8:function(e){return ua(this,1,e)[0]},getInt16:function(e){var t=ua(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=ua(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return na(ua(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return na(ua(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return ta(ua(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return ta(ua(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){ca(this,1,e,ra,t)},setUint8:function(e,t){ca(this,1,e,ra,t)},setInt16:function(e,t){ca(this,2,e,ia,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){ca(this,2,e,ia,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){ca(this,4,e,aa,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){ca(this,4,e,aa,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){ca(this,4,e,oa,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){ca(this,8,e,sa,t,arguments.length>2?arguments[2]:void 0)}});rr(Wi,"ArrayBuffer"),rr(Hi,"DataView");var ya={ArrayBuffer:Wi,DataView:Hi},ma=ya.ArrayBuffer,ba=ya.DataView,ka=ma.prototype.slice,wa=h((function(){return!new ma(2).slice(1,void 0).byteLength}));ze({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:wa},{slice:function(e,t){if(void 0!==ka&&void 0===t)return ka.call(z(this),e);for(var n=z(this).byteLength,r=ve(e,n),i=ve(void 0===t?n:t,n),a=new(Pn(this,ma))(fe(i-r)),o=new ba(this),s=new ba(a),l=0;r<i;)s.setUint8(l++,o.getUint8(r++));return a}});var _a=zn.charAt,Sa=ie.set,xa=ie.getterFor("String Iterator");li(String,"String",(function(e){Sa(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=xa(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=_a(n,r),t.index+=e.length,{value:e,done:!1})})),An("match",1,(function(e,t,n){return[function(t){var n=S(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=z(e),a=String(this);if(!i.global)return On(i,a);var o=i.unicode;i.lastIndex=0;for(var s,l=[],u=0;null!==(s=On(i,a));){var c=String(s[0]);l[u]=c,""===c&&(i.lastIndex=Rn(a,fe(i.lastIndex),o)),u++}return 0===u?null:l}]}));var Ca=$e("iterator"),Ia=!1;try{var Va=0,Ea={next:function(){return{done:!!Va++}},return:function(){Ia=!0}};Ea[Ca]=function(){return this},Array.from(Ea,(function(){throw 2}))}catch(e){}var Aa=function(e,t){if(!t&&!Ia)return!1;var n=!1;try{var r={};r[Ca]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Ta=Bi.NATIVE_ARRAY_BUFFER_VIEWS,Ma=c.ArrayBuffer,La=c.Int8Array,Pa=!Ta||!h((function(){La(1)}))||!h((function(){new La(-1)}))||!Aa((function(e){new La,new La(null),new La(1.5),new La(e)}),!0)||h((function(){return 1!==new La(new Ma(2),1,void 0).length})),Ba=function(e,t){var n=function(e){var t=he(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}(e);if(n%t)throw RangeError("Wrong offset");return n},za=$e("iterator"),Na=function(e){if(null!=e)return e[za]||e["@@iterator"]||Gr[qt(e)]},Ra=$e("iterator"),Oa=Array.prototype,Fa=function(e){return void 0!==e&&(Gr.Array===e||Oa[Ra]===e)},Da=Bi.aTypedArrayConstructor,ja=function(e){var t,n,r,i,a,o,s=Oe(e),l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,h=Na(s);if(null!=h&&!Fa(h))for(o=(a=h.call(s)).next,s=[];!(i=o.call(a)).done;)s.push(i.value);for(c&&l>2&&(u=Re(u,arguments[2],2)),n=fe(s.length),r=new(Da(this))(n),t=0;n>t;t++)r[t]=c?u(s[t],t):s[t];return r},qa=$e("species"),$a=function(e){var t=le(e),n=R.f;d&&t&&!t[qa]&&n(t,qa,{configurable:!0,get:function(){return this}})},Ua=function(e,t,n){var r,i;return ri&&"function"==typeof(r=t.constructor)&&r!==n&&C(i=r.prototype)&&i!==n.prototype&&ri(e,i),e},Wa=a((function(e){var t=Se.f,n=Ke.forEach,r=ie.get,i=ie.set,a=R.f,o=B.f,s=Math.round,l=c.RangeError,u=ya.ArrayBuffer,h=ya.DataView,f=Bi.NATIVE_ARRAY_BUFFER_VIEWS,g=Bi.TYPED_ARRAY_TAG,p=Bi.TypedArray,y=Bi.TypedArrayPrototype,m=Bi.aTypedArrayConstructor,b=Bi.isTypedArray,k=function(e,t){for(var n=0,r=t.length,i=new(m(e))(r);r>n;)i[n]=t[n++];return i},w=function(e,t){a(e,t,{get:function(){return r(this)[t]}})},_=function(e){var t;return e instanceof u||"ArrayBuffer"==(t=qt(e))||"SharedArrayBuffer"==t},S=function(e,t){return b(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},x=function(e,t){return S(e,t=I(t,!0))?v(2,e[t]):o(e,t)},V=function(e,t,n){return!(S(e,t=I(t,!0))&&C(n)&&E(n,"value"))||E(n,"get")||E(n,"set")||n.configurable||E(n,"writable")&&!n.writable||E(n,"enumerable")&&!n.enumerable?a(e,t,n):(e[t]=n.value,e)};d?(f||(B.f=x,R.f=V,w(y,"buffer"),w(y,"byteOffset"),w(y,"byteLength"),w(y,"length")),ze({target:"Object",stat:!0,forced:!f},{getOwnPropertyDescriptor:x,defineProperty:V}),e.exports=function(e,o,d,v){var m=e+(v?"Clamped":"")+"Array",w="get"+e,S="set"+e,x=c[m],I=x,V=I&&I.prototype,E={},A=function(e,t){a(e,t,{get:function(){return function(e,t){var n=r(e);return n.view[w](t*o+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=r(e);v&&(n=(n=s(n))<0?0:n>255?255:255&n),i.view[S](t*o+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};f?Pa&&(I=d((function(e,t,n,r){return Ni(e,I,m),Ua(C(t)?_(t)?void 0!==r?new x(t,Ba(n,o),r):void 0!==n?new x(t,Ba(n,o)):new x(t):b(t)?k(I,t):ja.call(I,t):new x(Ri(t)),e,I)})),ri&&ri(I,p),n(t(x),(function(e){e in I||O(I,e,x[e])})),I.prototype=V):(I=d((function(e,t,n,r){Ni(e,I,m);var a,s,c,d=0,f=0;if(C(t)){if(!_(t))return b(t)?k(I,t):ja.call(I,t);a=t,f=Ba(n,o);var g=t.byteLength;if(void 0===r){if(g%o)throw l("Wrong length");if((s=g-f)<0)throw l("Wrong length")}else if((s=fe(r)*o)+f>g)throw l("Wrong length");c=s/o}else c=Ri(t),a=new u(s=c*o);for(i(e,{buffer:a,byteOffset:f,byteLength:s,length:c,view:new h(a)});d<c;)A(e,d++)})),ri&&ri(I,p),V=I.prototype=Gn(y)),V.constructor!==I&&O(V,"constructor",I),g&&O(V,g,m),E[m]=I,ze({global:!0,forced:I!=x,sham:!f},E),"BYTES_PER_ELEMENT"in I||O(I,"BYTES_PER_ELEMENT",o),"BYTES_PER_ELEMENT"in V||O(V,"BYTES_PER_ELEMENT",o),$a(m)}):e.exports=function(){}}));Wa("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Ha=Math.min,Ga=[].copyWithin||function(e,t){var n=Oe(this),r=fe(n.length),i=ve(e,r),a=ve(t,r),o=arguments.length>2?arguments[2]:void 0,s=Ha((void 0===o?r:ve(o,r))-a,r-i),l=1;for(a<i&&i<a+s&&(l=-1,a+=s-1,i+=s-1);s-- >0;)a in n?n[i]=n[a]:delete n[i],i+=l,a+=l;return n},Ka=Bi.aTypedArray;Bi.exportProto("copyWithin",(function(e,t){return Ga.call(Ka(this),e,t,arguments.length>2?arguments[2]:void 0)}));var Za=Ke.every,Xa=Bi.aTypedArray;Bi.exportProto("every",(function(e){return Za(Xa(this),e,arguments.length>1?arguments[1]:void 0)}));var Ya=Bi.aTypedArray;Bi.exportProto("fill",(function(e){return Oi.apply(Ya(this),arguments)}));var Ja=Ke.filter,Qa=Bi.aTypedArray,eo=Bi.aTypedArrayConstructor;Bi.exportProto("filter",(function(e){for(var t=Ja(Qa(this),e,arguments.length>1?arguments[1]:void 0),n=Pn(this,this.constructor),r=0,i=t.length,a=new(eo(n))(i);i>r;)a[r]=t[r++];return a}));var to=Ke.find,no=Bi.aTypedArray;Bi.exportProto("find",(function(e){return to(no(this),e,arguments.length>1?arguments[1]:void 0)}));var ro=Ke.findIndex,io=Bi.aTypedArray;Bi.exportProto("findIndex",(function(e){return ro(io(this),e,arguments.length>1?arguments[1]:void 0)}));var ao=Ke.forEach,oo=Bi.aTypedArray;Bi.exportProto("forEach",(function(e){ao(oo(this),e,arguments.length>1?arguments[1]:void 0)}));var so=me.includes,lo=Bi.aTypedArray;Bi.exportProto("includes",(function(e){return so(lo(this),e,arguments.length>1?arguments[1]:void 0)}));var uo=me.indexOf,co=Bi.aTypedArray;Bi.exportProto("indexOf",(function(e){return uo(co(this),e,arguments.length>1?arguments[1]:void 0)}));var ho=$e("iterator"),fo=c.Uint8Array,go=hi.values,po=hi.keys,vo=hi.entries,yo=Bi.aTypedArray,mo=Bi.exportProto,bo=fo&&fo.prototype[ho],ko=!!bo&&("values"==bo.name||null==bo.name),wo=function(){return go.call(yo(this))};mo("entries",(function(){return vo.call(yo(this))})),mo("keys",(function(){return po.call(yo(this))})),mo("values",wo,!ko),mo(ho,wo,!ko);var _o=Bi.aTypedArray,So=[].join;Bi.exportProto("join",(function(e){return So.apply(_o(this),arguments)}));var xo=Math.min,Co=[].lastIndexOf,Io=!!Co&&1/[1].lastIndexOf(1,-0)<0,Vo=Ze("lastIndexOf"),Eo=Io||Vo?function(e){if(Io)return Co.apply(this,arguments)||0;var t=x(this),n=fe(t.length),r=n-1;for(arguments.length>1&&(r=xo(r,he(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:Co,Ao=Bi.aTypedArray;Bi.exportProto("lastIndexOf",(function(e){return Eo.apply(Ao(this),arguments)}));var To=Ke.map,Mo=Bi.aTypedArray,Lo=Bi.aTypedArrayConstructor;Bi.exportProto("map",(function(e){return To(Mo(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(Lo(Pn(e,e.constructor)))(t)}))}));var Po=function(e){return function(t,n,r,i){Ne(n);var a=Oe(t),o=_(a),s=fe(a.length),l=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=n(i,o[l],l,a));return i}},Bo={left:Po(!1),right:Po(!0)},zo=Bo.left,No=Bi.aTypedArray;Bi.exportProto("reduce",(function(e){return zo(No(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var Ro=Bo.right,Oo=Bi.aTypedArray;Bi.exportProto("reduceRight",(function(e){return Ro(Oo(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var Fo=Bi.aTypedArray,Do=Math.floor;Bi.exportProto("reverse",(function(){for(var e,t=Fo(this).length,n=Do(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}));var jo=Bi.aTypedArray,qo=h((function(){new Int8Array(1).set({})}));Bi.exportProto("set",(function(e){jo(this);var t=Ba(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=Oe(e),i=fe(r.length),a=0;if(i+t>n)throw RangeError("Wrong length");for(;a<i;)this[t+a]=r[a++]}),qo);var $o=Bi.aTypedArray,Uo=Bi.aTypedArrayConstructor,Wo=[].slice,Ho=h((function(){new Int8Array(1).slice()}));Bi.exportProto("slice",(function(e,t){for(var n=Wo.call($o(this),e,t),r=Pn(this,this.constructor),i=0,a=n.length,o=new(Uo(r))(a);a>i;)o[i]=n[i++];return o}),Ho);var Go=Ke.some,Ko=Bi.aTypedArray;Bi.exportProto("some",(function(e){return Go(Ko(this),e,arguments.length>1?arguments[1]:void 0)}));var Zo=Bi.aTypedArray,Xo=[].sort;Bi.exportProto("sort",(function(e){return Xo.call(Zo(this),e)}));var Yo=Bi.aTypedArray;Bi.exportProto("subarray",(function(e,t){var n=Yo(this),r=n.length,i=ve(e,r);return new(Pn(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,fe((void 0===t?r:ve(t,r))-i))}));var Jo=c.Int8Array,Qo=Bi.aTypedArray,es=[].toLocaleString,ts=[].slice,ns=!!Jo&&h((function(){es.call(new Jo(1))})),rs=h((function(){return[1,2].toLocaleString()!=new Jo([1,2]).toLocaleString()}))||!h((function(){Jo.prototype.toLocaleString.call([1,2])}));Bi.exportProto("toLocaleString",(function(){return es.apply(ns?ts.call(Qo(this)):Qo(this),arguments)}),rs);var is=c.Uint8Array,as=is&&is.prototype,os=[].toString,ss=[].join;h((function(){os.call({})}))&&(os=function(){return ss.call(this)}),Bi.exportProto("toString",os,(as||{}).toString!=os);var ls=$e("iterator"),us=$e("toStringTag"),cs=hi.values;for(var hs in tt){var ds=c[hs],fs=ds&&ds.prototype;if(fs){if(fs[ls]!==cs)try{O(fs,ls,cs)}catch(e){fs[ls]=cs}if(fs[us]||O(fs,us,hs),tt[hs])for(var gs in hi)if(fs[gs]!==hi[gs])try{O(fs,gs,hi[gs])}catch(e){fs[gs]=hi[gs]}}}var ps=$e("isConcatSpreadable"),vs=Ct>=51||!h((function(){var e=[];return e[ps]=!1,e.concat()[0]!==e})),ys=Vt("concat"),ms=function(e){if(!C(e))return!1;var t=e[ps];return void 0!==t?!!t:Fe(e)};ze({target:"Array",proto:!0,forced:!vs||!ys},{concat:function(e){var t,n,r,i,a,o=Oe(this),s=We(o,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?o:arguments[t],ms(a)){if(l+(i=fe(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,l++)n in a&&Pt(s,l,a[n])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Pt(s,l++,a)}return s.length=l,s}}),ze({target:"Array",proto:!0},{fill:Oi}),Hr("fill");var bs=Ke.findIndex,ks=!0;"findIndex"in[]&&Array(1).findIndex((function(){ks=!1})),ze({target:"Array",proto:!0,forced:ks},{findIndex:function(e){return bs(this,e,arguments.length>1?arguments[1]:void 0)}}),Hr("findIndex"),Wa("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var ws=null,_s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ot(this,e),this._seed=t,this._crypto="undefined"!=typeof window&&(window.crypto||window.msCrypto)||null}return lt(e,[{key:"next",value:function(){if(this._crypto){var e=new Uint32Array(1);return this._crypto.getRandomValues(e),e/4294967296}return Math.random()}},{key:"nextFloat",value:function(e,t){return this.next()*(t-e)+e}},{key:"nextInteger",value:function(e,t){return Math.floor(this.next()*(t-e+1))+e}},{key:"nextBytes",value:function(e){var t=new Uint8Array(e);if(this._crypto)this._crypto.getRandomValues(t);else for(var n=0;n<e;n++)t[n]=this.nextInteger(0,255);return t}},{key:"nextBoolean",value:function(){return this.next()>=.5}},{key:"nextChoice",value:function(e){return e[this.nextInteger(0,e.length-1)]}}],[{key:"getInstance",value:function(){return null===ws&&(ws=new e),ws}}]),e}(),Ss=function(){function e(){ot(this,e)}return lt(e,null,[{key:"isEqual",value:function(t,n){if(t===n)return!0;if(null===t&&null===n)return!0;if(null===t||null===n)return!1;if(at(t)!==at(n))return!1;if(t instanceof Array){if(t.length!==n.length)return!1;for(var r=-1,i=!0;i&&++r<t.length;)i=e.isEqual(t[r],n[r]);return i}if(t instanceof Object){if("function"==typeof t.isEqualTo)return t.isEqualTo(n);if("function"==typeof n.isEqualTo)return n.isEqualTo(t);for(var a=e.unique(Object.keys(t).concat(Object.keys(n))),o=-1,s=!0;s&&++o<a.length;){var l=a[o];s=e.isEqual(t[l],n[l])}return s}return t instanceof Date&&t.getTime()===n.getTime()}},{key:"isUnique",value:function(e){return-1===e.findIndex((function(t,n){return e.indexOf(t)!==n}))}},{key:"unique",value:function(e){return e.filter((function(t,n){return e.indexOf(t)===n}))}},{key:"shuffle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=t||_s.getInstance();var n,r,i=e.slice();for(n=i.length-1;n>0;n--){var a=[i[r=t.nextInteger(0,n)],i[n]];i[n]=a[0],i[r]=a[1]}return i}},{key:"chunk",value:function(e,t){for(var n=Math.ceil(e.length/t),r=new Array(n),i=0;i<n;i++)r[i]=e.slice(i*t,(i+1)*t);return r}},{key:"joinSlices",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.length,r=t.length,i=[],a=0;a<n;a++)r>0&&a>0&&(i=i.concat(t)),i=i.concat(e[a]);return i}},{key:"indexOfSlice",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===t.length)return-1;for(var r=-1,i=n-1;-1===r&&-1!==(i=e.indexOf(t[0],i+1));)this.isEqual(e.slice(i,i+t.length),t)&&(r=i);return r}},{key:"replaceSlice",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=-1,a=[];-1!==(i=this.indexOfSlice(e,t,i+1));)a=(a=a.concat(e.slice(r,i))).concat(n),r=i+t.length;return a=a.concat(e.slice(r))}},{key:"resizeBitSizedArray",value:function(e,t,n){for(var r,i,a,o,s,l,u,c,h=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=Math.ceil(e.length*t/n),f=8===n?new Uint8Array(d):new Array(d).fill(0),g=(1<<n)-1,p=0;p<e.length;p++)for(r=e[p],i=p*t,a=(p+1)*t,o=Math.floor(i/n),l=n-a%n,f[s=Math.floor(a/n)]|=r<<l&g,u=r>>n-l,c=s;--c>=o&&u>0;)f[c]|=u&g,u>>=n;if(h){for(var v=f.length-1;0===f[v];)v--;return f.slice(0,v+1)}return f}}]),e}(),xs=function(e,t,n,r){try{return r?t(z(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&z(i.call(e)),t}},Cs=!Aa((function(e){Array.from(e)}));ze({target:"Array",stat:!0,forced:Cs},{from:function(e){var t,n,r,i,a,o=Oe(e),s="function"==typeof this?this:Array,l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,h=0,d=Na(o);if(c&&(u=Re(u,l>2?arguments[2]:void 0,2)),null==d||s==Array&&Fa(d))for(n=new s(t=fe(o.length));t>h;h++)Pt(n,h,c?u(o[h],h):o[h]);else for(a=(i=d.call(o)).next,n=new s;!(r=a.call(i)).done;h++)Pt(n,h,c?xs(i,u,[r.value,h],!0):r.value);return n.length=h,n}});var Is="".repeat||function(e){var t=String(S(this)),n="",r=he(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},Vs=Math.ceil,Es=function(e){return function(t,n,r){var i,a,o=String(S(t)),s=o.length,l=void 0===r?" ":String(r),u=fe(n);return u<=s||""==l?o:(i=u-s,(a=Is.call(l,Vs(i/l.length))).length>i&&(a=a.slice(0,i)),e?o+a:a+o)}},As={start:Es(!1),end:Es(!0)},Ts=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(wt),Ms=As.end;ze({target:"String",proto:!0,forced:Ts},{padEnd:function(e){return Ms(this,e,arguments.length>1?arguments[1]:void 0)}});var Ls=R.f,Ps=Se.f,Bs=$e("match"),zs=c.RegExp,Ns=zs.prototype,Rs=/a/g,Os=/a/g,Fs=new zs(Rs)!==Rs;if(d&&Pe("RegExp",!Fs||h((function(){return Os[Bs]=!1,zs(Rs)!=Rs||zs(Os)==Os||"/a/i"!=zs(Rs,"i")})))){for(var Ds=function(e,t){var n=this instanceof Ds,r=Mn(e),i=void 0===t;return!n&&r&&e.constructor===Ds&&i?e:Ua(Fs?new zs(r&&!i?e.source:e,t):zs((r=e instanceof Ds)?e.source:e,r&&i?Ht.call(e):t),n?this:Ns,Ds)},js=function(e){e in Ds||Ls(Ds,e,{configurable:!0,get:function(){return zs[e]},set:function(t){zs[e]=t}})},qs=Ps(zs),$s=0;qs.length>$s;)js(qs[$s++]);Ns.constructor=Ds,Ds.prototype=Ns,ae(c,"RegExp",Ds)}$a("RegExp");var Us=Math.max,Ws=Math.min,Hs=Math.floor,Gs=/\$([$&'`]|\d\d?|<[^>]*>)/g,Ks=/\$([$&'`]|\d\d?)/g;An("replace",2,(function(e,t,n){return[function(n,r){var i=S(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,i,r):t.call(String(i),n,r)},function(e,i){var a=n(t,e,this,i);if(a.done)return a.value;var o=z(e),s=String(this),l="function"==typeof i;l||(i=String(i));var u=o.global;if(u){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=On(o,s);if(null===d)break;if(h.push(d),!u)break;""===String(d[0])&&(o.lastIndex=Rn(s,fe(o.lastIndex),c))}for(var f,g="",p=0,v=0;v<h.length;v++){d=h[v];for(var y=String(d[0]),m=Us(Ws(he(d.index),s.length),0),b=[],k=1;k<d.length;k++)b.push(void 0===(f=d[k])?f:String(f));var w=d.groups;if(l){var _=[y].concat(b,m,s);void 0!==w&&_.push(w);var S=String(i.apply(void 0,_))}else S=r(y,s,m,b,w,i);m>=p&&(g+=s.slice(p,m)+S,p=m+y.length)}return g+s.slice(p)}];function r(e,n,r,i,a,o){var s=r+e.length,l=i.length,u=Ks;return void 0!==a&&(a=Oe(a),u=Gs),t.call(o,u,(function(t,o){var u;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(s);case"<":u=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return t;if(c>l){var h=Hs(c/10);return 0===h?t:h<=l?void 0===i[h-1]?o.charAt(1):i[h-1]+o.charAt(1):t}u=i[c-1]}return void 0===u?"":u}))}}));var Zs=0,Xs=function(){function e(){ot(this,e)}return lt(e,null,[{key:"camelCaseToRegular",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/\b([A-Z]+)([A-Z])([a-z])/,"$1 $2$3").replace(/^./,(function(e){return e.toUpperCase()}))}},{key:"uniqueId",value:function(){return"u"+(++Zs).toString(16)}},{key:"chunk",value:function(e,t){return""!==e?e.match(new RegExp(".{1,".concat(t,"}"),"g")):[]}},{key:"isWhitespace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e[t];return!!n&&null!==n.match(/\s/)}},{key:"removeWhitespaces",value:function(e){return this.replaceWhitespaces(e,"",!0)}},{key:"normalizeWhitespaces",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.replaceWhitespaces(e," ",t)}},{key:"replaceWhitespaces",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e.replace(/\s+/g,t):e.replace(/\s/g,t)}}]),e}(),Ys=function(e){function t(e){var n;return ot(this,t),(n=pt(this,ct(t).call(this,e))).name=n.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(gt(n),n.constructor):n.stack=new Error(e).stack,n}return ut(t,e),t}(ft(Error)),Js=function(e){function t(){return ot(this,t),pt(this,ct(t).apply(this,arguments))}return ut(t,e),t}(Ys),Qs=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ot(this,t),(n=pt(this,ct(t).call(this,e))).index=r,n}return ut(t,e),t}(Js),el={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",padding:"=",paddingOptional:!1,foreignCharacters:!1,maxLineLength:null,lineSeparator:"\r\n"},tl=function(){function e(){ot(this,e)}return lt(e,null,[{key:"hexStringFromBytes",value:function(e){return Array.from(e).map((function(e){return("0"+e.toString(16)).slice(-2)})).join("")}},{key:"bytesFromHexString",value:function(e){(e=Xs.removeWhitespaces(e)).length%2==1&&(e+="0");var t=Xs.chunk(e,2).map((function(e,t){var n=parseInt(e,16);if(null===e.match(/[0-9a-f]{2}/i)||isNaN(n))throw new Qs("Invalid hex encoded byte '".concat(e,"'"));return n}));return new Uint8Array(t)}},{key:"binaryStringFromBytes",value:function(e){return Array.from(e).map((function(e){return("0000000"+e.toString(2)).slice(-8)})).join("")}},{key:"bytesFromBinaryString",value:function(e){(e=Xs.removeWhitespaces(e)).length%8>0&&(e=e.padEnd(e.length-e.length%8+8,"0"));var t=Xs.chunk(e,8).map((function(e,t){var n=parseInt(e,2);if(null===e.match(/[0-1]{8}/)||isNaN(n))throw new Qs("Invalid binary encoded byte '".concat(e,"'"));return n}));return new Uint8Array(t)}},{key:"base64StringFromBytes",value:function(e){for(var t,n,r,i,a,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Object.assign({},el,s),u=l.alphabet,c=l.padding,h=l.paddingOptional,d=l.maxLineLength,f=l.lineSeparator,g=!h&&c?c:"",p="",v=0;v<e.length;v+=3)i=(3&(t=e[v]))<<4|(n=v+1<e.length?e[v+1]:NaN)>>4,a=(15&n)<<2|(r=v+2<e.length?e[v+2]:NaN)>>6,o=63&r,p+=u[t>>2]+u[i]+(isNaN(n)?g:u[a])+(isNaN(r)?g:u[o]);if(d){for(var y="",m=0;m<p.length;m+=d)y+=(""!==y?f:"")+p.substr(m,d);p=y}return p}},{key:"bytesFromBase64String",value:function(e){for(var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},el,r),a=i.alphabet,o=i.padding,s=(i.paddingOptional,i.foreignCharacters),l=i.maxLineLength,u=i.lineSeparator,c=e.length,h=[],d=-1;++d<c;)if(t=e[d],null!==l&&u&&t===u[0]&&e.substr(d,u.length)===u)d=d+u.length-1;else if(t===o);else if(-1!==(n=a.indexOf(t)))h.push(n);else if(!s)throw new Qs("Forbidden character '".concat(t,"' at index ").concat(d));var f=(4-h.length%4)%4;if(3===f)throw new Qs("A single remaining encoded character in the last quadruple or a padding of 3 characters is not allowed");for(d=0;d<f;d++)h.push(0);var g,p=h.length/4*3,v=new Uint8Array(p);for(d=0;d<h.length;d+=4)v[g=d/4*3]=h[d]<<2|h[d+1]>>4,v[g+1]=(15&h[d+1])<<4|h[d+2]>>2,v[g+2]=(3&h[d+2])<<6|h[d+3];return v.slice(0,p-f)}}]),e}(),nl=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ot(this,t),(n=pt(this,ct(t).call(this,e))).byteIndex=r,n}return ut(t,e),t}(Js),rl=function(){function e(){ot(this,e)}return lt(e,null,[{key:"validateCodePoint",value:function(e){return isFinite(e)&&e>=0&&e<=1114111&&Math.floor(e)===e}},{key:"validateCodePoints",value:function(t){for(var n=!0,r=0;n&&r<t.length;)n=e.validateCodePoint(t[r]),r++;return n}},{key:"stringFromCodePoints",value:function(e){var t,n,r=new Array(2*e.length),i=0;for(t=0;t<e.length;t++)(n=e[t])<65536?r[i++]=String.fromCharCode(n):(n-=65536,r[i++]=String.fromCharCode(55296+(n>>10)),r[i++]=String.fromCharCode(n%1024+56320));return r.slice(0,i).join("")}},{key:"codePointsFromString",value:function(e){for(var t,n,r=e.length,i=new Array(r),a=0,o=0;o<r;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r?56320==(64512&(n=e.charCodeAt(o++)))?i[a++]=((1023&t)<<10)+(1023&n)+65536:(i[a++]=t,o--):i[a++]=t;return i.slice(0,a)}},{key:"bytesFromCodePoints",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";switch(n){case"utf8":return e._encodeCodePointsToUTF8Bytes(t);default:throw new Error("Encoding to '".concat(n,"' is currently not supported."))}}},{key:"codePointsFromBytes",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";switch(n){case"utf8":return e._decodeCodePointsFromUTF8Bytes(t);default:throw new Error("Decoding from '".concat(n,"' is currently not supported."))}}},{key:"_encodeCodePointsToUTF8Bytes",value:function(e){var t,n,r=new Uint8Array(4*e.length),i=0;for(t=0;t<e.length;t++)(n=e[t])<=127?r[i++]=n:n<=2047?(r[i++]=192|n>>6,r[i++]=128|63&n):n<=65535?(r[i++]=224|n>>12,r[i++]=128|(4095&n)>>6,r[i++]=128|63&n):(r[i++]=240|n>>18,r[i++]=128|(262143&n)>>12,r[i++]=128|(4095&n)>>6,r[i++]=128|63&n);return r.slice(0,i)}},{key:"_decodeCodePointsFromUTF8Bytes",value:function(e){for(var t,n,r=e.length,i=new Array(r),a=0,o=-1,s=0;++o<r;)if((t=e[o])>127&&t<=191){if(--a<0)throw new nl("Invalid UTF-8 encoded text: "+"Unexpected continuation byte at 0x".concat(o.toString(16)),o);n=n<<6|63&t,0===a&&(i[s++]=n)}else{if(a>0)throw new nl("Invalid UTF-8 encoded text: "+"Continuation byte expected at 0x".concat(o.toString(16)),o);if(t<=127)i[s++]=t;else if(t<=223)n=31&t,a=1;else if(t<=239)n=15&t,a=2;else{if(!(t<=247))throw new nl("Invalid UTF-8 encoded text: "+"Invalid byte ".concat(t," at 0x").concat(o.toString(16)),o);n=7&t,a=3}}if(0!==a)throw new nl("Invalid UTF-8 encoded text: Unexpected end of bytes");return i.slice(0,s)}}]),e}(),il=null,al=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(ot(this,e),this._codePoints=null,this._string=null,this._bytes=null,this._encoding=n,null===t)this._codePoints=[],this._string="",this._bytes=new Uint8Array(0);else{var r=Object.prototype.toString.call(t);switch(r){case"[object Array]":if(!rl.validateCodePoints(t))throw new Error("Chain constructor expects a valid array of code points.");this._codePoints=t;break;case"[object String]":this._string=t;break;case"[object Uint8Array]":this._bytes=t;break;default:throw new Error("Chain constructor expects one optional parameter of type "+"Array, String or Uint8Array. Received unexpected ".concat(r,"."))}}}return lt(e,[{key:"getCodePoints",value:function(){return null===this._codePoints&&(null!==this._string?this._codePoints=rl.codePointsFromString(this._string):this._codePoints=rl.codePointsFromBytes(this._bytes,this._encoding)),this._codePoints}},{key:"getChars",value:function(){return this.getCodePoints().map((function(e){return rl.stringFromCodePoints([e])}))}},{key:Symbol.iterator,value:function(){return this.getCodePoints().values}},{key:"getCodePointAt",value:function(e){return this.getCodePoints()[e]}},{key:"getCharAt",value:function(e){return rl.stringFromCodePoints([this.getCodePointAt(e)])}},{key:"getCharBytesAt",value:function(e){return rl.bytesFromCodePoints([this.getCodePointAt(e)])}},{key:"getLength",value:function(){return this.getCodePoints().length}},{key:"getString",value:function(){return null===this._string&&(this._string=rl.stringFromCodePoints(this.getCodePoints())),this._string}},{key:"toString",value:function(){return this.getString()}},{key:"toLowerCase",value:function(){return e.wrap(this.getString().toLowerCase(),this._encoding)}},{key:"toUpperCase",value:function(){return e.wrap(this.getString().toUpperCase(),this._encoding)}},{key:"split",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return n=n instanceof e?n.toString():n,this.getString().split(n,r).map((function(n){return e.wrap(n,t._encoding)}))}},{key:"substr",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(n<=0||t>=this.getLength())return e.empty();t<0&&(t=Math.max(this.getLength()+t,0));var r=this.getCodePoints().slice(t,n?t+n:void 0);return e.wrap(r,this._encoding)}},{key:"truncate",value:function(t){return this.getLength()>t?e.wrap(this.substr(0,t).getString()+"…",this._encoding):this}},{key:"extend",value:function(t){for(var n,r=this.getCodePoints(),i=e.wrap(t).getCodePoints(),a=r.slice(),o=0;a.length<i.length&&o<i.length;)n=i[o++],-1===r.indexOf(n)&&a.push(n);return e.wrap(a)}},{key:"match",value:function(e){return this.getString().match(e)}},{key:"getDescription",value:function(){return null!==this._string?"String(".concat(this._string,")"):null!==this._codePoints?"CodePoints(".concat(this._codePoints.join(", "),")"):"Bytes(".concat(tl.hexStringFromBytes(this._bytes),")")}},{key:"contains",value:function(e){return-1!==this.getString().indexOf(e.toString())}},{key:"indexOfCodePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.getCodePoints().indexOf(e,t)}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.getString(),r=n.indexOf(e.toString(),t);if(-1===r)return-1;var i=n.substr(0,r),a=rl.codePointsFromString(i);return a.length}},{key:"getBytes",value:function(){return null===this._bytes&&(this._bytes=rl.bytesFromCodePoints(this.getCodePoints(),this._encoding)),this._bytes}},{key:"getByteAt",value:function(e){return this.getBytes()[e]}},{key:"getSize",value:function(){return this.getBytes().length}},{key:"needsTextEncoding",value:function(){return null===this._codePoints&&null===this._string}},{key:"needsByteEncoding",value:function(){return null===this._bytes}},{key:"isEmpty",value:function(){return this===il||null!==this._codePoints&&0===this._codePoints.length||null!==this._string&&""===this._string||null!==this._bytes&&0===this._bytes.length}},{key:"isEqualTo",value:function(t){if(t===this)return!0;if(!(t instanceof e))return!1;if(this.isEmpty()&&t.isEmpty())return!0;if(t.getEncoding()!==this._encoding)return!1;if(null!==this._string&&this._string===t._string)return!0;if(null!==this._bytes&&null!==t._bytes)return Ss.isEqual(this._bytes,t._bytes);try{return Ss.isEqual(this.getCodePoints(),t.getCodePoints())}catch(e){if(e instanceof nl)return!1;throw e}}},{key:"getEncoding",value:function(){return this._encoding}}],[{key:"isEqual",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length<2)return!0;var i=n[0];if(!(i instanceof e))return!1;for(var a=!0,o=0;a&&++o<n.length;)a=i.isEqualTo(n[o]);return a}},{key:"wrap",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return t instanceof e?t:null===t||0===t.length?e.empty():new e(t,n)}},{key:"join",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e.wrap(t.map((function(e){return e.toString()})).join(n))}},{key:"empty",value:function(){return null===il&&(il=new e),il}}]),e}(),ol=[].reverse,sl=[1,2];ze({target:"Array",proto:!0,forced:String(sl)===String(sl.reverse())},{reverse:function(){return Fe(this)&&(this.length=this.length),ol.call(this)}});var ll,ul,cl,hl=c.Promise,dl=a((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,i,a){var o,s,l,u,c,h,d,f=Re(n,r,i?2:1);if(a)o=e;else{if("function"!=typeof(s=Na(e)))throw TypeError("Target is not iterable");if(Fa(s)){for(l=0,u=fe(e.length);u>l;l++)if((c=i?f(z(d=e[l])[0],d[1]):f(e[l]))&&c instanceof t)return c;return new t(!1)}o=s.call(e)}for(h=o.next;!(d=h.call(o)).done;)if("object"==typeof(c=xs(o,f,d.value,i))&&c&&c instanceof t)return c;return new t(!1)}).stop=function(e){return new t(!0,e)}})),fl=/(iphone|ipod|ipad).*applewebkit/i.test(wt),gl=c.location,pl=c.setImmediate,vl=c.clearImmediate,yl=c.process,ml=c.MessageChannel,bl=c.Dispatch,kl=0,wl={},_l=function(e){if(wl.hasOwnProperty(e)){var t=wl[e];delete wl[e],t()}},Sl=function(e){return function(){_l(e)}},xl=function(e){_l(e.data)},Cl=function(e){c.postMessage(e+"",gl.protocol+"//"+gl.host)};pl&&vl||(pl=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return wl[++kl]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},ll(kl),kl},vl=function(e){delete wl[e]},"process"==b(yl)?ll=function(e){yl.nextTick(Sl(e))}:bl&&bl.now?ll=function(e){bl.now(Sl(e))}:ml&&!fl?(cl=(ul=new ml).port2,ul.port1.onmessage=xl,ll=Re(cl.postMessage,cl,1)):!c.addEventListener||"function"!=typeof postMessage||c.importScripts||h(Cl)?ll="onreadystatechange"in M("script")?function(e){$n.appendChild(M("script")).onreadystatechange=function(){$n.removeChild(this),_l(e)}}:function(e){setTimeout(Sl(e),0)}:(ll=Cl,c.addEventListener("message",xl,!1)));var Il,Vl,El,Al,Tl,Ml,Ll,Pl,Bl={set:pl,clear:vl},zl=B.f,Nl=Bl.set,Rl=c.MutationObserver||c.WebKitMutationObserver,Ol=c.process,Fl=c.Promise,Dl="process"==b(Ol),jl=zl(c,"queueMicrotask"),ql=jl&&jl.value;ql||(Il=function(){var e,t;for(Dl&&(e=Ol.domain)&&e.exit();Vl;){t=Vl.fn,Vl=Vl.next;try{t()}catch(e){throw Vl?Al():El=void 0,e}}El=void 0,e&&e.enter()},Dl?Al=function(){Ol.nextTick(Il)}:Rl&&!fl?(Tl=!0,Ml=document.createTextNode(""),new Rl(Il).observe(Ml,{characterData:!0}),Al=function(){Ml.data=Tl=!Tl}):Fl&&Fl.resolve?(Ll=Fl.resolve(void 0),Pl=Ll.then,Al=function(){Pl.call(Ll,Il)}):Al=function(){Nl.call(c,Il)});var $l,Ul,Wl,Hl,Gl=ql||function(e){var t={fn:e,next:void 0};El&&(El.next=t),Vl||(Vl=t,Al()),El=t},Kl=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Ne(t),this.reject=Ne(n)},Zl={f:function(e){return new Kl(e)}},Xl=function(e,t){if(z(e),C(t)&&t.constructor===e)return t;var n=Zl.f(e);return(0,n.resolve)(t),n.promise},Yl=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Jl=Bl.set,Ql=$e("species"),eu="Promise",tu=ie.get,nu=ie.set,ru=ie.getterFor(eu),iu=hl,au=c.TypeError,ou=c.document,su=c.process,lu=q("inspectSource"),uu=le("fetch"),cu=Zl.f,hu=cu,du="process"==b(su),fu=!!(ou&&ou.createEvent&&c.dispatchEvent),gu=Pe(eu,(function(){var e=lu(iu)!==String(iu);if(66===Ct)return!0;if(!e&&!du&&"function"!=typeof PromiseRejectionEvent)return!0;if(Ct>=51&&/native code/.test(iu))return!1;var t=iu.resolve(1),n=function(e){e((function(){}),(function(){}))};return(t.constructor={})[Ql]=n,!(t.then((function(){}))instanceof n)})),pu=gu||!Aa((function(e){iu.all(e).catch((function(){}))})),vu=function(e){var t;return!(!C(e)||"function"!=typeof(t=e.then))&&t},yu=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;Gl((function(){for(var i=t.value,a=1==t.state,o=0;r.length>o;){var s,l,u,c=r[o++],h=a?c.ok:c.fail,d=c.resolve,f=c.reject,g=c.domain;try{h?(a||(2===t.rejection&&wu(e,t),t.rejection=1),!0===h?s=i:(g&&g.enter(),s=h(i),g&&(g.exit(),u=!0)),s===c.promise?f(au("Promise-chain cycle")):(l=vu(s))?l.call(s,d,f):d(s)):f(i)}catch(e){g&&!u&&g.exit(),f(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&bu(e,t)}))}},mu=function(e,t,n){var r,i;fu?((r=ou.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},(i=c["on"+e])?i(r):"unhandledrejection"===e&&function(e,t){var n=c.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},bu=function(e,t){Jl.call(c,(function(){var n,r=t.value;if(ku(t)&&(n=Yl((function(){du?su.emit("unhandledRejection",r,e):mu("unhandledrejection",e,r)})),t.rejection=du||ku(t)?2:1,n.error))throw n.value}))},ku=function(e){return 1!==e.rejection&&!e.parent},wu=function(e,t){Jl.call(c,(function(){du?su.emit("rejectionHandled",e):mu("rejectionhandled",e,t.value)}))},_u=function(e,t,n,r){return function(i){e(t,n,i,r)}},Su=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,yu(e,t,!0))},xu=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw au("Promise can't be resolved itself");var i=vu(n);i?Gl((function(){var r={done:!1};try{i.call(n,_u(xu,e,r,t),_u(Su,e,r,t))}catch(n){Su(e,r,n,t)}})):(t.value=n,t.state=1,yu(e,t,!1))}catch(n){Su(e,{done:!1},n,t)}}};gu&&(iu=function(e){Ni(this,iu,eu),Ne(e),$l.call(this);var t=tu(this);try{e(_u(xu,this,t),_u(Su,this,t))}catch(e){Su(this,t,e)}},($l=function(e){nu(this,{type:eu,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=zi(iu.prototype,{then:function(e,t){var n=ru(this),r=cu(Pn(this,iu));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=du?su.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&yu(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Ul=function(){var e=new $l,t=tu(e);this.promise=e,this.resolve=_u(xu,e,t),this.reject=_u(Su,e,t)},Zl.f=cu=function(e){return e===iu||e===Wl?new Ul(e):hu(e)},"function"==typeof hl&&(Hl=hl.prototype.then,ae(hl.prototype,"then",(function(e,t){var n=this;return new iu((function(e,t){Hl.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof uu&&ze({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Xl(iu,uu.apply(c,arguments))}}))),ze({global:!0,wrap:!0,forced:gu},{Promise:iu}),rr(iu,eu,!1),$a(eu),Wl=le(eu),ze({target:eu,stat:!0,forced:gu},{reject:function(e){var t=cu(this);return t.reject.call(void 0,e),t.promise}}),ze({target:eu,stat:!0,forced:gu},{resolve:function(e){return Xl(this,e)}}),ze({target:eu,stat:!0,forced:pu},{all:function(e){var t=this,n=cu(t),r=n.resolve,i=n.reject,a=Yl((function(){var n=Ne(t.resolve),a=[],o=0,s=1;dl(e,(function(e){var l=o++,u=!1;a.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,a[l]=e,--s||r(a))}),i)})),--s||r(a)}));return a.error&&i(a.value),n.promise},race:function(e){var t=this,n=cu(t),r=n.reject,i=Yl((function(){var i=Ne(t.resolve);dl(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});a((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),o=new V(r||[]);return a._invoke=function(e,t,n){var r=c;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw a;return A()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var l=u(e,t,n);if("normal"===l.type){if(r=n.done?f:h,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=f,n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",g={};function p(){}function v(){}function y(){}var m={};m[a]=function(){return this};var b=Object.getPrototypeOf,k=b&&b(b(E([])));k&&k!==n&&r.call(k,a)&&(m=k);var w=y.prototype=p.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function S(e){var t;this._invoke=function(n,i){function a(){return new Promise((function(t,a){!function t(n,i,a,o){var s=u(e[n],e,i);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,a,o)}),(function(e){t("throw",e,a,o)})):Promise.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return t("throw",e,a,o)}))}o(s.arg)}(n,i,t,a)}))}return t=t?t.then(a,a):a()}}function x(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=u(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function V(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function E(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=w.constructor=y,y.constructor=v,y[s]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},_(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i){var a=new S(l(t,n,r,i));return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(w),w[s]="Generator",w[a]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,V.prototype={constructor:V,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:E(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var Cu=Ke.find,Iu=!0;"find"in[]&&Array(1).find((function(){Iu=!1})),ze({target:"Array",proto:!0,forced:Iu},{find:function(e){return Cu(this,e,arguments.length>1?arguments[1]:void 0)}}),Hr("find");var Vu=[],Eu=Vu.sort,Au=h((function(){Vu.sort(void 0)})),Tu=h((function(){Vu.sort(null)})),Mu=Ze("sort");ze({target:"Array",proto:!0,forced:Au||!Tu||Mu},{sort:function(e){return void 0===e?Eu.call(Oe(this)):Eu.call(Oe(this),Ne(e))}});var Lu=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$message=null,e._message=null,e._id=Xs.uniqueId(),e._first=!1,e}return ut(t,e),lt(t,[{key:"isFirst",value:function(){return this._first}},{key:"setFirst",value:function(e){return this._first!==e&&(this._first=e,e?this.getElement().classList.add("field--first"):this.getElement().classList.remove("field--first")),this}},{key:"getMessage",value:function(){return this._message}},{key:"setMessage",value:function(e){return this._message=e,this.update()}},{key:"clearMessage",value:function(){return this.setMessage(null)}},{key:"getId",value:function(){return this._id}},{key:"render",value:function(){return Jt.createElement("div",{className:"field"+(this._first?" field--first":"")},[this.renderLabel(),this.renderField()])}},{key:"renderLabel",value:function(){return Jt.createElement("label",{className:"field__label",htmlFor:this.getId()},this.getModel().getLabel())}},{key:"renderField",value:function(){return Jt.createElement("div",{className:"field__field"})}},{key:"renderMessage",value:function(){return null!==this.getMessage()?Jt.createElement("div",{className:"field__message"},this.getMessage()):null}},{key:"didRender",value:function(){vt(ct(t.prototype),"didRender",this).call(this),this.updateValue()}},{key:"update",value:function(){var e=this.getElement();return e.dataset.width=this.getModel().getWidth(),this.hasFocus()?e.classList.add("field--focus"):e.classList.remove("field--focus"),this.getModel().isValid()&&null===this.getMessage()?e.classList.remove("field--invalid"):e.classList.add("field--invalid"),null!==this._$message&&null!==this._$message.parentNode&&this._$message.parentNode.removeChild(this._$message),this._$message=null,this._$message=this.renderMessage(),null!==this._$message&&this.getElement().appendChild(this._$message),this}},{key:"didFocus",value:function(){this.getElement().classList.add("field--focus")}},{key:"didBlur",value:function(){this.getElement().classList.remove("field--focus")}},{key:"updateValue",value:function(){return this}}]),t}(Jt),Pu=function(e){function t(){return ot(this,t),pt(this,ct(t).apply(this,arguments))}return ut(t,e),lt(t,[{key:"render",value:function(){return Jt.createElement("div",{className:"form"})}},{key:"appendSubviewElement",value:function(e){if(e instanceof Lu){this.getElement();var n=this.getSubviews().filter((function(e){return e instanceof Lu}));n.push(e);var r=this.getModel().getFields();n.sort((function(e,t){return r.indexOf(e.getModel())-r.indexOf(t.getModel())}));var i=n.indexOf(e),a=i<n.length-1?n[i+1].getElement():null;this.getElement().insertBefore(e.getElement(),a);var o=0;return n.forEach((function(e){var t=e.getModel().getWidth();(o+=t)===t||o>12?(o=t,e.setFirst(!0)):e.setFirst(!1)})),this}return vt(ct(t.prototype),"appendSubviewElement",this).call(this,e)}}]),t}(Jt),Bu='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 7H3.83l3.58-3.59L6 2 0 8l6 6 1.41-1.41L3.83 9H16z"/></svg>',zu={forward:Bu,backward:Bu,error:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M15 2.41L13.59 1 8 6.59 2.41 1 1 2.41 6.59 8 1 13.59 2.41 15 8 9.41 13.59 15 15 13.59 9.41 8z"/></svg>'},Nu=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$menu=null,e._$body=null,e._$settings=null,e._$header=null,e._$status=null,e._$statusIcon=null,e._$statusMessage=null,e._menuVisible=!1,e._menuHideHandler=e.toggleMenu.bind(gt(e)),e}return ut(t,e),lt(t,[{key:"render",value:function(){this._$settings=this.renderSettings(),this._$header=this.renderHeader();var e=this.getModel().getMeta();return Jt.createElement("div",{className:"brick",role:"region",ariaLabel:"".concat(e.title," ").concat(e.type)},[this._$header,this._$settings,this.renderContent(),this.renderStatus()])}},{key:"renderHeader",value:function(){var e=this;this._$menu=this.renderMenu();var t=Jt.createElement("button",{className:"brick__btn-menu",onClick:function(t){t.preventDefault(),e.toggleMenu()}});t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><circle cx="8" cy="2" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="14" r="1.5"/></svg>';var n=Jt.createElement("div",{className:"brick__title-caret"});return n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3 6l5 5 5-5z"/></svg>',Jt.createElement("header",{className:"brick__header"},[Jt.createElement("button",{className:"brick__title",onClick:function(t){t.preventDefault(),e.getModel().viewReplaceButtonDidClick(e)}},[Jt.createElement("h3",{className:"brick__title-inner"},this.getModel().getTitle()),n]),t])}},{key:"renderMenu",value:function(){var e=this,t=[];return this.getModel().hasPipe()&&(t.push({label:"Remove",name:"remove"}),t.push({label:"Hide",name:"hide"}),t.push({label:"Duplicate",name:"duplicate"})),this.getModel().isRandomizable()&&t.push({label:"Randomize",name:"randomize"}),Jt.createElement("div",{className:"brick__menu menu"},[Jt.createElement("ul",{className:"menu__list"},t.map((function(t){return Jt.createElement("li",{className:"menu__item"},[Jt.createElement("button",{className:"menu__button",onClick:function(n){n.preventDefault(),e.getModel().viewMenuItemDidClick(e,t.name)}},t.label)])})))])}},{key:"renderSettings",value:function(){return Jt.createElement("div",{className:"brick__settings"})}},{key:"renderContent",value:function(){return Jt.createElement("div",{className:"brick__content"})}},{key:"renderStatus",value:function(){return this._$statusIcon=Jt.createElement("div",{className:"brick__status-icon"}),this._$statusMessage=Jt.createElement("div",{className:"brick__status-message"}),this._$status=Jt.createElement("footer",{className:"brick__status brick__status--hidden"},[this._$statusIcon,this._$statusMessage]),this._$status}},{key:"appendSubviewElement",value:function(e){return e instanceof Pu?(this.getElement(),this._$settings.appendChild(e.getElement()),this):vt(ct(t.prototype),"appendSubviewElement",this).call(this,e)}},{key:"didFocus",value:function(){this.getElement().classList.add("brick--focus")}},{key:"didBlur",value:function(){this.getElement().classList.remove("brick--focus")}},{key:"toggleMenu",value:function(){var e=this;this._menuVisible=!this._menuVisible,this._menuVisible?(this._$header.appendChild(this._$menu),this._$menu.getBoundingClientRect(),this._$menu.classList.add("menu--visible"),window.requestAnimationFrame((function(){window.addEventListener("click",e._menuHideHandler)}))):(this._$header.removeChild(this._$menu),window.removeEventListener("click",this._menuHideHandler))}},{key:"updateStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===e?(this._$status.classList.add("brick__status--hidden"),this._$statusIcon.innerHTML=null,this._$statusMessage.innerText=null):(this._$status.className="brick__status brick__status--".concat(e),this._$statusIcon.innerHTML=zu[e]||"",this._$statusMessage.innerText=t||"","forward"!==e&&"backward"!==e||(this._$status.classList.add("brick__status--flash"),this._$status.getBoundingClientRect(),this._$status.classList.remove("brick__status--flash"))),this}}]),t}(Jt),Ru=null,Ou=function(){function e(){ot(this,e),this._observerNames=[],this._observerCallbacks=[]}return lt(e,[{key:"trigger",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;-1!==(n=this._observerNames.indexOf(e,n));)this._observerCallbacks[n](e,t),n++;return this}},{key:"subscribe",value:function(e,t){return this._observerNames.push(e),this._observerCallbacks.push(t),this}},{key:"unsubscribe",value:function(e,t){for(var n=0;-1!==(n=this._observerNames.indexOf(e,n));)this._observerCallbacks[n]===t?(this._observerNames.splice(n,1),this._observerCallbacks.splice(n,1)):n++;return this}}],[{key:"getSharedInstance",value:function(){return null===Ru&&(Ru=new e),Ru}},{key:"trigger",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.getSharedInstance().trigger(t,n)}}]),e}(),Fu=function(){function e(){ot(this,e),this._view=null,this._viewPrototype=Jt}return lt(e,[{key:"hasView",value:function(){return null!==this._view}},{key:"getView",value:function(){return null===this._view&&(this._view=new this._viewPrototype,this._view.setModel(this),this.didCreateView(this._view)),this._view}},{key:"updateView",value:function(){return this.hasView()&&this.getView().setNeedsUpdate(),this}},{key:"didCreateView",value:function(e){}}]),e}(),Du=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ot(this,t),(n=pt(this,ct(t).call(this)))._viewPrototype=Lu,n._name=e,n._value=void 0!==r.value?r.value:null,n._delegate=r.delegate||null,n._randomizable=!1!==r.randomizable,n._valid=!0,n._message=null,n._messageKey=null,n._validateValueCallback=r.validateValue||null,n._filterValueCallback=r.filterValue||null,n._randomizeValueCallback=r.randomizeValue||null,n._label=r.label||Xs.camelCaseToRegular(e),n._visible=!1!==r.visible,n._priority=void 0!==r.priority?r.priority:0,n._width=r.width||12,n}return ut(t,e),lt(t,[{key:"getName",value:function(){return this._name}},{key:"getLabel",value:function(){return this._label}},{key:"isVisible",value:function(){return this._visible}},{key:"setVisible",value:function(e){return this._visible=e,this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getPriority",value:function(){return this._priority}},{key:"setPriority",value:function(e){return this._priority=e,this._delegate&&this._delegate.fieldPriorityDidChange&&this._delegate.fieldPriorityDidChange(this,e),this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(e){return this._width=e,this.updateView(),this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getDelegate",value:function(){return this._delegate}},{key:"setDelegate",value:function(e){return this._delegate=e,this}},{key:"unsetDelegate",value:function(){return this._delegate=null,this}},{key:"isValid",value:function(){return this._valid}},{key:"getMessage",value:function(){return this._message}},{key:"getMessageKey",value:function(){return this._messageKey}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.validateValue(e);if(this._valid=!0===n,this._valid?(this._message=null,this._messageKey=null):"object"===at(n)?(this._message=n.message,this._messageKey=n.key):(this._message="The value is invalid",this._messageKey="invalid"),this.hasView()&&this.getView().setMessage(this.getMessage()),!this._valid)return this._value=e,this;var r=this.filterValue(e),i=r instanceof al?r.isEqualTo(this._value):this._value===r;return i||(this._value=r,this.hasView()&&this.getView()!==t&&this.getView().updateValue(),this._delegate&&this._delegate!==t&&void 0!==this._delegate.fieldValueDidChange&&this.getDelegate().fieldValueDidChange(this,r)),this}},{key:"revalidateValue",value:function(){return this.setValue(this.getValue())}},{key:"validateValue",value:function(e){return null===this._validateValueCallback||this._validateValueCallback(e,this)}},{key:"filterValue",value:function(e){return null!==this._filterValueCallback?this._filterValueCallback(e,this):e}},{key:"isRandomizable",value:function(){return this._randomizable}},{key:"randomize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.isRandomizable())return this;var t=this.randomizeValue(e||new _s);return null!==t?this.setValue(t):this}},{key:"randomizeValue",value:function(e){return this.randomizeValueWithCallback(e)}},{key:"randomizeValueWithCallback",value:function(e){return null!==this._randomizeValueCallback?this._randomizeValueCallback(e,this):null}},{key:"isCustomRandomizationSet",value:function(){return null!==this._randomizeValueCallback}},{key:"serializeValue",value:function(){if(!this.isValid())throw new Error("Invalid field values can't be serialized.");var e=this.getValue();if("boolean"!=typeof e&&"number"!=typeof e&&"string"!=typeof e&&null!==e)throw new Error("Field value serialization is not possible. Generic fields can only serialize boolean, number, string or null values safely. "+"Received value type '".concat(at(e),"'."));return e}},{key:"extract",value:function(e){return this.setValue(this.extractValue(e)),this}},{key:"extractValue",value:function(e){return e}},{key:"didCreateView",value:function(e){this.getView().setMessage(this.getMessage())}}]),t}(Fu),ju=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$input=null,e}return ut(t,e),lt(t,[{key:"updateValue",value:function(){return this._$input.checked=this.getModel().getValue(),this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("field-boolean"),e}},{key:"renderField",value:function(){var e=this;this._$input=Jt.createElement("input",{className:"field-boolean__input",type:"checkbox",id:this.getId(),onChange:this.inputValueDidChange.bind(this),checked:this.getModel().getValue(),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=Jt.createElement("label",{className:"field-boolean__toggle",htmlFor:this.getId()},[Jt.createElement("span",{className:"field-boolean__choice"},this.getModel().getTrueLabel()),Jt.createElement("span",{className:"field-boolean__choice"},this.getModel().getFalseLabel())]),r=vt(ct(t.prototype),"renderField",this).call(this);return r.appendChild(this._$input),r.appendChild(n),r}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.checked)}}]),t}(Lu),qu=[!0,1,"1","true"],$u=[!1,0,"0","false"],Uu=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ot(this,t),(n=pt(this,ct(t).call(this,e,r)))._viewPrototype=ju,n._trueLabel=r.trueLabel||"Yes",n._falseLabel=r.falseLabel||"No",n}return ut(t,e),lt(t,[{key:"getTrueLabel",value:function(){return this._trueLabel}},{key:"getFalseLabel",value:function(){return this._falseLabel}},{key:"validateValue",value:function(e){return-1===qu.indexOf(e)&&-1===$u.indexOf(e)?{key:"booleanInvalid",message:"The value is not a boolean"}:vt(ct(t.prototype),"validateValue",this).call(this,e)}},{key:"filterValue",value:function(e){return vt(ct(t.prototype),"filterValue",this).call(this,-1!==qu.indexOf(e))}},{key:"randomizeValue",value:function(e){var n=vt(ct(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:e.nextBoolean()}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(Du),Wu=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$input=null,e}return ut(t,e),lt(t,[{key:"updateValue",value:function(){var e=this.getModel().getValue(),t=tl.hexStringFromBytes(e);return t=Xs.chunk(t,2).join(" "),this._$input.value=t,this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("field-byte"),e}},{key:"renderField",value:function(){var e=this;this._$input=Jt.createElement("input",{className:"field-byte__input",id:this.getId(),type:"text",spellcheck:!1,onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=vt(ct(t.prototype),"renderField",this).call(this);return n.classList.remove("field__field"),n.classList.add("field-byte__field"),n.appendChild(this._$input),n}},{key:"inputValueDidChange",value:function(e){var t=Xs.removeWhitespaces(this._$input.value);if(null===t.match(/^[0-9a-f]+$/gi))return this.setMessage("The value contains non-hexadecimal characters");this.clearMessage();var n=tl.bytesFromHexString(t);this.getModel().viewValueDidChange(this,n)}}]),t}(Lu),Hu=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ot(this,t),(n=pt(this,ct(t).call(this,e,r)))._viewPrototype=Wu,n._value=r.value||new Uint8Array,n._minSize=null,n._maxSize=null,n._randomizeSize=r.randomizeSize||null,n.setMinSize(r.minSize||null,!1),n.setMaxSize(r.maxSize||null,!1),n}return ut(t,e),lt(t,[{key:"getMinSize",value:function(){return this._minSize}},{key:"setMinSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._minSize===e?this:(this._minSize=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getMaxSize",value:function(){return this._maxSize}},{key:"setMaxSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._maxSize===e?this:(this._maxSize=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"validateValue",value:function(e){return e instanceof Uint8Array?null!==this._minSize&&e.length<this._minSize?{key:"byteSizeTooShort",message:"The value must be at least ".concat(this._minSize," ")+"".concat(1===this._minSize?"byte":"bytes"," long, ")+"found ".concat(e.length," ").concat(1===e.length?"byte":"bytes")}:null!==this._maxSize&&e.length>this._maxSize?{key:"byteSizeTooLong",message:"The value must not exceed ".concat(this._maxSize," ")+"".concat(1===this._maxSize?"byte":"bytes"," in length, ")+"found ".concat(e.length," ").concat(1===e.length?"byte":"bytes")}:vt(ct(t.prototype),"validateValue",this).call(this,e):{key:"byteUnexpectedType",message:"The value is expected to be of type Uint8Array"}}},{key:"randomizeValue",value:function(e){var n=vt(ct(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:null!==this._randomizeSize?e.nextBytes(this._randomizeSize):null!==this.getMinSize()?e.nextBytes(this.getMinSize()):this.isValid()?e.nextBytes(this.getValue().length):null}},{key:"serializeValue",value:function(){return tl.base64StringFromBytes(this.getValue())}},{key:"extractValue",value:function(e){if("string"!=typeof e)throw new Error("Value of field '".concat(this.getName(),"' is expected to be a valid ")+"base64 string.");return tl.bytesFromBase64String(e)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(Du),Gu=me.includes;ze({target:"Array",proto:!0},{includes:function(e){return Gu(this,e,arguments.length>1?arguments[1]:void 0)}}),Hr("includes");var Ku=function(e){if(Mn(e))throw TypeError("The method doesn't accept regular expressions");return e},Zu=$e("match");ze({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Zu]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(S(this)).indexOf(Ku(e),arguments.length>1?arguments[1]:void 0)}});var Xu=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._style="default",e._$select=null,e._$$radio=[],e}return ut(t,e),lt(t,[{key:"getStyle",value:function(){return this._style}},{key:"setStyle",value:function(e){return this._style!==e&&(this._style=e,this.refresh()),this}},{key:"updateValue",value:function(){var e=this.getModel().getSelectedIndex();return"radio"===this.getStyle()?this._$$radio.forEach((function(t,n){t.checked=n===e})):this._$select.value=e,this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.className+=" field-enum field-enum--".concat(this.getStyle()),e}},{key:"renderField",value:function(){var e=this,n=this.getModel().getElementLabels(),r=this.getModel().getElementDescriptions(),i=vt(ct(t.prototype),"renderField",this).call(this);if(i.classList.remove("field__field"),i.classList.add("field-enum__field"),"radio"===this.getStyle()){this._$$radio=[];var a=Jt.createElement("div",{className:"field-enum__options",role:"radiogroup",id:this.getId()});i.appendChild(a),n.map((function(t,n){var r="".concat(e.getId(),"-").concat(n+1),i=Jt.createElement("input",{type:"radio",className:"field-enum__option-radio",id:r,onChange:e.valueDidChange.bind(e),name:e.getId()}),o=Jt.createElement("div",{className:"field-enum__option"},[i,Jt.createElement("label",{htmlFor:r,className:"field-enum__option-label"},t)]);e._$$radio.push(i),a.appendChild(o)}))}else{var o=n.map((function(e,t){return Jt.createElement("option",{value:t,title:r[t]||""},e)}));this._$select=Jt.createElement("select",{className:"field-enum__select",id:this.getId(),onChange:this.valueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}},o),i.appendChild(this._$select)}return i}},{key:"valueDidChange",value:function(e){var t="radio"===this.getStyle()?this._$$radio.findIndex((function(e){return e.checked})):parseInt(this._$select.value),n=this.getModel().getElementAt(t);this.getModel().viewValueDidChange(this,n)}}]),t}(Lu),Yu=function(e){function t(e,n){var r;return ot(this,t),(r=pt(this,ct(t).call(this,e,n)))._viewPrototype=Xu,r._elements=[],r._labels=[],r._descriptions=[],r._style=n.style||"default",r._blackChoiceList=n.blackChoiceList||[],r.setElements(n.elements,n.labels||null,n.descriptions||null,!1),r}return ut(t,e),lt(t,[{key:"getElements",value:function(){return this._elements}},{key:"getElementLabels",value:function(){return this._labels}},{key:"getElementDescriptions",value:function(){return this._descriptions}},{key:"setElements",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(0===e.length)throw new Error("Array of elements can't be empty.");if(null!==t&&e.length!==t.length)throw new Error("Element and label arrays require the same length.");if(null!==n&&e.length!==n.length)throw new Error("Element and description arrays require the same length.");return this._elements=e,this._labels=null!==t?t:e,this._descriptions=null!==n?n:e.map((function(){return null})),null===this._value&&(this._value=this._elements[0]),this.hasView()&&this.getView().refresh(),r?this.revalidateValue():this}},{key:"getElementAt",value:function(e){return e<this._elements.length?this._elements[e]:null}},{key:"getSelectedIndex",value:function(){return this._elements.indexOf(this.getValue())}},{key:"setSelectedIndex",value:function(e){var t=this._elements[e];return this.setValue(t)}},{key:"getStyle",value:function(){return this._style}},{key:"setStyle",value:function(e){return this._style=e,this.hasView()&&this.getView().setStyle(e),this}},{key:"getBlackChoiceList",value:function(){return this._blackChoiceList}},{key:"setBlackChoiceList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._blackChoiceList=e,t?this.revalidateValue():this}},{key:"validateValue",value:function(e){return-1===this._elements.indexOf(e)?{key:"enumNotInHaystack",message:"The value must be occur in the list of elements"}:this._blackChoiceList.includes(e)?{key:this.name,message:"Chosen option is not compatible with other settings"}:vt(ct(t.prototype),"validateValue",this).call(this,e)}},{key:"randomizeValue",value:function(e){var n=vt(ct(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:e.nextChoice(this._elements)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}},{key:"didCreateView",value:function(e){vt(ct(t.prototype),"didCreateView",this).call(this,e),this.getView().setStyle(this.getStyle())}}]),t}(Du),Ju=dn.trim,Qu=c.parseFloat,ec=1/Qu(sn+"-0")!=-1/0?function(e){var t=Ju(String(e)),n=Qu(t);return 0===n&&"-"==t.charAt(0)?-0:n}:Qu;ze({global:!0,forced:parseFloat!=ec},{parseFloat:ec});var tc,nc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$input=null,e._displayEnabled=!1,e._$display=null,e._$displayValue=null,e._$displayDescription=null,e}return ut(t,e),lt(t,[{key:"updateValue",value:function(){var e=this.getModel().getValue();return this._$input.value=e,this._updateValueDisplay(),this}},{key:"_updateValueDisplay",value:function(){var e=this.getModel().getValue(),t=this.getModel().getValueDescription(),n=null!==t;return this._displayEnabled!==n&&(this._displayEnabled=n,n?this._$display.classList.add("field-number__display--enabled"):(this._$display.classList.remove("field-number__display--enabled"),this._$displayValue.innerText="",this._$displayDescription.innerText="")),n&&(this._$displayValue.innerText=e,this._$displayDescription.innerText=t),this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("field-number"),e}},{key:"renderField",value:function(){var e=this;this._$input=Jt.createElement("input",{className:"field-number__input",id:this.getId(),type:"number",onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}}),this._$displayValue=Jt.createElement("span",{className:"field-number__display-value"}),this._$displayDescription=Jt.createElement("span",{className:"field-number__display-description"}),this._$display=Jt.createElement("div",{className:"field-number__display"},[this._$displayValue,this._$displayDescription]);var n=Jt.createElement("button",{className:"field-number__btn-step-down",onClick:this.stepDownButtonDidClick.bind(this)},"Step Down"),r=Jt.createElement("div",{className:"field-number__value"},[this._$input,this._$display]),i=Jt.createElement("button",{className:"field-number__btn-step-up",onClick:this.stepUpButtonDidClick.bind(this)},"Step Up"),a=vt(ct(t.prototype),"renderField",this).call(this);return a.classList.remove("field__field"),a.classList.add("field-number__field"),a.appendChild(n),a.appendChild(r),a.appendChild(i),a}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.value),this._updateValueDisplay()}},{key:"stepDownButtonDidClick",value:function(e){return this.getModel().stepDown(),e.preventDefault(),!1}},{key:"stepUpButtonDidClick",value:function(e){return this.getModel().stepUp(),e.preventDefault(),!1}}]),t}(Lu),rc=function(e){function t(e,n){var r;return ot(this,t),(r=pt(this,ct(t).call(this,e,n)))._viewPrototype=nc,r._integer=n.integer||!1,r._step=n.step||1,r._min=void 0!==n.min?n.min:null,r._max=void 0!==n.max?n.max:null,r._rotate=void 0!==n.rotate?n.rotate:null!==r._min&&null!==r._max,r._describeValueCallback=n.describeValue||null,r}return ut(t,e),lt(t,[{key:"isInteger",value:function(){return this._integer}},{key:"setInteger",value:function(e){return this._integer=e,this.revalidateValue()}},{key:"getStep",value:function(){return this._step}},{key:"setStep",value:function(e){return this._step=e,this}},{key:"stepValue",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=this.getValue(),r=0,i=!1;!i&&r++<t&&(this._rotate||e>0||n!==this._min)&&(this._rotate||e<0||n!==this._max);)n+=e,this._rotate&&n>this._max&&this._rotate?n=this._min:this._rotate&&n<this._min&&this._rotate&&(n=this._max+e),i=!0===this.validateValue(n);return i?n:null}},{key:"stepUp",value:function(){var e=this.stepValue(this._step);return null!==e?this.setValue(e):this}},{key:"stepDown",value:function(){var e=this.stepValue(-this._step);return null!==e?this.setValue(e):this}},{key:"getMin",value:function(){return this._min}},{key:"setMin",value:function(e){return this._min=e,this.revalidateValue()}},{key:"getMax",value:function(){return this._max}},{key:"setMax",value:function(e){return this._max=e,this.revalidateValue()}},{key:"isRotate",value:function(){return this._rotate}},{key:"setRotate",value:function(e){return this._rotate=e&&null!==this._min&&null!==this._max,this}},{key:"getValueDescription",value:function(){return this.isValid()&&null!==this._describeValueCallback?this._describeValueCallback(this.getValue(),this):null}},{key:"setNeedsValueDescriptionUpdate",value:function(){this.hasView()&&this.getView().updateValue()}},{key:"validateValue",value:function(e){var n=this.filterValue(e);return isNaN(n)||!isFinite(n)?{key:"numberNotNumeric",message:"The value is not numeric"}:null!==this._min&&n<this._min?{key:"numberTooSmall",message:"The value must be greater than or equal to ".concat(this._min)}:null!==this._max&&n>=this._max?{key:"numberTooLarge",message:"The value must be less than ".concat(this._max)}:vt(ct(t.prototype),"validateValue",this).call(this,n)}},{key:"filterValue",value:function(e){return e=this.isInteger()?parseInt(e):parseFloat(e),vt(ct(t.prototype),"filterValue",this).call(this,e)}},{key:"randomizeValue",value:function(e){var n=vt(ct(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:null!==this.getMin()&&null!==this.getMax()?this.isInteger()?e.nextInteger(this.getMin(),Math.ceil(this.getMax())-1):e.nextFloat(this.getMin(),this.getMax()):null}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(Du),ic=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$input=null,e}return ut(t,e),lt(t,[{key:"updateValue",value:function(){return this._$input.value=this.getModel().getValue().getString(),this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("field-text"),e}},{key:"renderField",value:function(){var e=this;this._$input=Jt.createElement("input",{className:"field-text__input",id:this.getId(),type:"text",spellcheck:!1,onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=vt(ct(t.prototype),"renderField",this).call(this);return n.classList.remove("field__field"),n.classList.add("field-text__field"),n.appendChild(this._$input),n}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.value)}}]),t}(Lu),ac=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ot(this,t),(n=pt(this,ct(t).call(this,e,r)))._viewPrototype=ic,n._value=al.wrap(r.value||null),n._minLength=null,n._maxLength=null,n._whitelistChars=null,n._blacklistChars=null,n._uniqueChars=!1,n._caseSensitivity=null,n.setMinLength(void 0!==r.minLength?r.minLength:null,!1),n.setMaxLength(void 0!==r.maxLength?r.maxLength:null,!1),n.setWhitelistChars(r.whitelistChars||null,!1),n.setBlacklistChars(r.blacklistChars||null,!1),n.setUniqueChars(r.uniqueChars||!1,!1),n.setCaseSensitivity(!1!==r.caseSensitivity,!1),n}return ut(t,e),lt(t,[{key:"getMinLength",value:function(){return this._minLength}},{key:"setMinLength",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._minLength===e?this:(this._minLength=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getMaxLength",value:function(){return this._maxLength}},{key:"setMaxLength",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._maxLength===e?this:(this._maxLength=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getWhitelistChars",value:function(){return this._whitelistChars}},{key:"setWhitelistChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._whitelistChars=null!==e?al.wrap(e).getCodePoints():null,t?this.revalidateValue():this}},{key:"getBlacklistChars",value:function(){return this._blacklistChars}},{key:"setBlacklistChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._blacklistChars=null!==e?al.wrap(e).getCodePoints():null,t?this.revalidateValue():this}},{key:"isUniqueChars",value:function(){return this._uniqueChars}},{key:"setUniqueChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._uniqueChars===e?this:(this._uniqueChars=e,t?this.revalidateValue():this)}},{key:"isCaseSensitive",value:function(){return this._caseSensitivity}},{key:"setCaseSensitivity",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._caseSensitivity===e?this:(this._caseSensitivity=e,t?this.revalidateValue():this)}},{key:"validateValue",value:function(e){if("function"!=typeof e.toString)return{key:"textInvalidString",message:"The value can't be casted to a string"};var n=this.filterValue(e);if(null!==this._minLength&&n.getLength()<this._minLength)return{key:"textLengthTooShort",message:"The value must be at least ".concat(this._minLength," ")+"".concat(1===this._minLength?"character":"characters"," long")};if(null!==this._maxLength&&n.getLength()>this._maxLength)return{key:"textLengthTooLong",message:"The value must not exceed ".concat(this._maxLength," ")+"".concat(1===this._maxLength?"character":"characters"," in length")};if(this._uniqueChars&&!Ss.isUnique(n.getCodePoints()))return{key:"textCharactersNotUnique",message:"The value must not contain duplicate characters"};if(null!==this._whitelistChars||null!==this._blacklistChars){for(var r,i=this._whitelistChars,a=this._blacklistChars,o=[],s=0;s<n.getLength();s++)r=n.getCodePointAt(s),(null!==i&&-1===i.indexOf(r)||null!==a&&-1!==a.indexOf(r))&&o.push(n.getCharAt(s));if(o.length>0)return o=Ss.unique(o),{key:"textForbiddenCharacter",message:"The value contains forbidden characters: "+"'".concat(o.join(""),"'")}}return vt(ct(t.prototype),"validateValue",this).call(this,n)}},{key:"filterValue",value:function(e){return e=al.wrap(e),!1===this._caseSensitivity&&(e=e.toLowerCase()),al.wrap(vt(ct(t.prototype),"filterValue",this).call(this,e))}},{key:"randomizeValue",value:function(e){var n=vt(ct(t.prototype),"randomizeValue",this).call(this,e);if(null!==n)return n;if(this.isValid()){if(this.isUniqueChars()){var r=this.getValue().getCodePoints();return al.wrap(Ss.shuffle(r,e))}if(null!==this.getWhitelistChars()){for(var i=this.getValue().getLength(),a=[],o=0;o<i;o++)a.push(e.nextChoice(this.getWhitelistChars()));return al.wrap(a)}}return null}},{key:"serializeValue",value:function(){return this.getValue().getString()}},{key:"extractValue",value:function(e){if("string"!=typeof e)throw new Error("Value of field '".concat(this.getName(),"' is expected to be a string."));return al.wrap(e)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(Du),oc=null,sc=function(e){function t(){var e;ot(this,t),e=pt(this,ct(t).call(this));var n={boolean:Uu,bytes:Hu,enum:Yu,number:rc,text:ac};for(var r in n)e.register(r,n[r]);return e}return ut(t,e),lt(t,[{key:"create",value:function(e){if(!e.name)throw new Error("Field specification requires a 'name' field.");if(!e.type)throw new Error("Field specification requires a 'type' field.");if(!this.exists(e.type))throw new Error("Unknown Field type '".concat(e.type,"'."));return vt(ct(t.prototype),"create",this).call(this,e.type,e.name,e)}}],[{key:"getInstance",value:function(){return null===oc&&(oc=new t),oc}}]),t}(on),lc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=Pu,e._delegate=null,e._fieldFactory=r,e._fields=[],e.addFields(n),e}return ut(t,e),lt(t,[{key:"getFields",value:function(){return this._fields.slice()}},{key:"getInvalidFields",value:function(){return this._fields.filter((function(e){return!e.isValid()}))}},{key:"getVisibleFields",value:function(){return this._fields.filter((function(e){return e.isVisible()}))}},{key:"addFields",value:function(e){return e.forEach(this.addField.bind(this)),this}},{key:"removeFields",value:function(e){return e.forEach(this.removeField.bind(this)),this}},{key:"getField",value:function(e){return this._fields.find((function(t){return t.getName()===e}))||null}},{key:"addField",value:function(e){var t=e;if(!(e instanceof Du)){var n=e;void 0===n.priority&&(n.priority=this._calculateDefaultPriority()),t=this.getFieldFactory().create(n)}if(this.getField(t.getName()))throw new Error("Name '".concat(t.getName(),"' is already assigned to a field."));return this._fields.push(t),t.setDelegate(this),this._sortFields(),t.isVisible()&&this.hasView()&&this.getView().addSubview(t.getView()),this}},{key:"removeField",value:function(e){var t=e;if(!(e instanceof Du)){var n=e;void 0===n.priority&&(n.priority=this._calculateDefaultPriority()),t=this.getFieldFactory().create(n)}if(!this.getField(t.getName()))throw new Error("Field '".concat(t.getName(),"' is not assigned to the field."));var r=this._fields.indexOf(t);return this._fields.splice(r,1),t.unsetDelegate(),this._sortFields(),t.isVisible()&&this.hasView()&&this.getView().removeSubview(t.getView()),this}},{key:"getFieldValue",value:function(e){var t=this.getField(e);if(null===t)throw new Error("There is no field assigned to the name '".concat(e,"'."));return t.getValue()}},{key:"setFieldValue",value:function(e,t){var n=this.getField(e);if(null===n)throw new Error("There is no field assigned to the name '".concat(e,"'."));return n.setValue(t),this}},{key:"getFieldValues",value:function(){var e={};return this.getVisibleFields().forEach((function(t){e[t.getName()]=t.getValue()})),e}},{key:"setFieldValues",value:function(e){for(var t in e)this.setFieldValue(t,e[t]);return this}},{key:"getFieldFactory",value:function(){return null===this._fieldFactory&&(this._fieldFactory=sc.getInstance()),this._fieldFactory}},{key:"setFieldFactory",value:function(e){return this._fieldFactory=e,this}},{key:"isValid",value:function(){return 0===this.getInvalidFields().length}},{key:"isRandomizable",value:function(){return void 0!==this._fields.find((function(e){return e.isRandomizable()}))}},{key:"randomize",value:function(){return this._fields.filter((function(e){return e.isVisible()&&e.isRandomizable()})).forEach((function(e){return e.randomize()})),this}},{key:"getDelegate",value:function(){return this._delegate}},{key:"setDelegate",value:function(e){return this._delegate=e,this}},{key:"serializeValues",value:function(){var e={};return this.getVisibleFields().forEach((function(t){e[t.getName()]=t.serializeValue()})),e}},{key:"extract",value:function(e){return this.setFieldValues(this.extractValues(e))}},{key:"extractValues",value:function(e){if("object"!==at(e))throw new Error("Serialized form values is expected to be an object mapping field names to their respective serialized values. "+"Received value type '".concat(at(e),"'."));var t={};for(var n in e){if("string"!=typeof n)throw new Error("Field name is expected to be a string. "+"Received type '".concat(at(n),"'."));var r=this.getField(n);if(null===r)throw new Error("There is no field assigned to the name '".concat(n,"'."));t[n]=r.extractValue(e[n])}return t}},{key:"_calculateDefaultPriority",value:function(){if(0===this._fields.length)return 0;for(var e=this._fields[0].getPriority(),t=1;t<this._fields.length;t++)e=Math.min(e,this._fields[t].getPriority());return e-1}},{key:"_sortFields",value:function(){this._fields.sort((function(e,t){return t.getPriority()-e.getPriority()}))}},{key:"didCreateView",value:function(e){var t=this;this._fields.forEach((function(e){return t.fieldNeedsLayout(e)}))}},{key:"fieldPriorityDidChange",value:function(e,t){this._sortFields()}},{key:"fieldNeedsLayout",value:function(e){this.hasView()&&(e.getView().removeFromSuperview(),e.isVisible()&&this.getView().addSubview(e.getView()))}},{key:"fieldValueDidChange",value:function(e,t){this._delegate&&this._delegate.formValueDidChange&&this.getDelegate().formValueDidChange(this,e,t)}}]),t}(Fu),uc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._pipe=null,e._viewPrototype=Nu,e._settingsForm=new lc,e._settingsForm.setDelegate(gt(e)),e._title=null,e._hidden=!1,e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){throw new Error("Brick static method 'getMeta' has not been overridden.")}}]),lt(t,[{key:"getPipe",value:function(){return this._pipe}},{key:"hasPipe",value:function(){return null!==this._pipe}},{key:"setPipe",value:function(e){return this._pipe=e,this}},{key:"getMeta",value:function(){return this.constructor.getMeta()}},{key:"getName",value:function(){return this.getMeta().name}},{key:"getTitle",value:function(){return null===this._title?this.getMeta().title:this._title}},{key:"setTitle",value:function(e){return this._title=e&&e!==this.getMeta().title?e:null,this}},{key:"isHidden",value:function(){return this._hidden}},{key:"setHidden",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._hidden!==e&&(this._hidden=e,this.hasPipe()&&this.getPipe().brickVisibilityDidChange(this,e)),this}},{key:"getSettingsForm",value:function(){return this._settingsForm}},{key:"getSettings",value:function(){return this._settingsForm.getFields()}},{key:"addSettings",value:function(e){return this._settingsForm.addFields(e),this}},{key:"removeSettings",value:function(e){return this._settingsForm.removeFields(e),this}},{key:"getSetting",value:function(e){return this._settingsForm.getField(e)}},{key:"addSetting",value:function(e){return this._settingsForm.addField(e),this}},{key:"removeSetting",value:function(e){return this._settingsForm.removeField(e),this}},{key:"getSettingValue",value:function(e){return this._settingsForm.getFieldValue(e)}},{key:"setSettingValue",value:function(e,t){return this._settingsForm.setFieldValue(e,t),this}},{key:"getSettingValues",value:function(){return this._settingsForm.getFieldValues()}},{key:"setSettingValues",value:function(e){return this._settingsForm.setFieldValues(e),this}},{key:"isValid",value:function(){return this._settingsForm.isValid()}},{key:"isSettingValid",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return void 0===n.find((function(t){return!e.getSetting(t).isValid()}))}},{key:"isRandomizable",value:function(){return this._settingsForm.isRandomizable()}},{key:"randomize",value:function(){return this._settingsForm.randomize(),this}},{key:"formValueDidChange",value:function(e,t,n){e===this._settingsForm&&(this.settingValueDidChange(t,n),this.hasPipe()&&this.getPipe().brickSettingDidChange(this))}},{key:"settingValueDidChange",value:function(e,t){}},{key:"didCreateView",value:function(e){e.addSubview(this._settingsForm.getView())}},{key:"viewMenuItemDidClick",value:function(e,t){switch(Ou.trigger("brickMenuItemClick",{brick:this,menuItem:t}),t){case"remove":this.getPipe().removeBrick(this);break;case"hide":this.setHidden(!0);break;case"duplicate":this.isValid()&&this.getPipe().duplicateBrick(this);break;case"randomize":this.randomize()}}},{key:"viewReplaceButtonDidClick",value:function(e){this.hasPipe()&&(Ou.trigger("brickReplaceButtonClick",{brick:this}),this.getPipe().brickReplaceButtonDidClick(this))}},{key:"serialize",value:function(){var e={};e.name=this.getName(),null!==this._title&&(e.title=this._title),this.isHidden()&&(e.hidden=!0);var t=this._settingsForm.serializeValues();return Object.keys(t).length>0&&(e.settings=t),e}},{key:"copy",value:function(){if(!this.isValid())throw new Error("Invalid bricks can't be copied.");var e=new this.constructor;return e.setTitle(this.getTitle()),e.setHidden(this.isHidden()),e.setSettingValues(this.getSettingValues()),e}}],[{key:"extract",value:function(e,t){if("string"!=typeof e.name)throw new Error("Brick property 'name' is expected to be of type 'string'");var n=e.name;if(!t.exists(n))throw new Error("Brick property 'name' refers to an unknown brick '".concat(n,"'"));var r=t.create(n);if(void 0!==e.title){if("string"!=typeof e.title)throw new Error("Optional brick property 'title' is expected to be of type 'string'");r.setTitle(e.title)}if(void 0!==e.hidden){if("boolean"!=typeof e.hidden)throw new Error("Optional brick property 'hidden' is expected to be of type 'boolean'");r.setHidden(e.hidden)}if(void 0!==e.reverse){if("function"!=typeof r.setReverse)throw new Error("Optional brick property 'reverse' can only be set on encoder bricks");if("boolean"!=typeof e.reverse)throw new Error("Optional brick property 'reverse' is expected to be of type 'boolean'");r.setReverse(e.reverse)}return void 0!==e.settings&&r.getSettingsForm().extract(e.settings),r}}]),t}(Fu),cc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$encodeAction=null,e._$decodeAction=null,e}return ut(t,e),lt(t,[{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("encoder"),e}},{key:"renderHeader",value:function(){this._$encodeAction=Jt.createElement("a",{className:"brick__action brick__action--active",href:"#",onClick:this.actionDidClick.bind(this,"encode"),draggable:!1},"Encode"),this._$decodeAction=Jt.createElement("a",{className:"brick__action",href:"#",onClick:this.actionDidClick.bind(this,"decode"),draggable:!1},"Decode");var e=Jt.createElement("ul",{className:"brick__actions"},[Jt.createElement("li",{className:"brick__action-item"},this._$encodeAction),Jt.createElement("li",{className:"brick__action-item"},this._$decodeAction)]),n=vt(ct(t.prototype),"renderHeader",this).call(this);return n.insertBefore(e,n.firstChild),n}},{key:"renderContent",value:function(){return null}},{key:"actionDidClick",value:function(e,t){t.preventDefault();var n="decode"===e;this.getModel().isReverse()!==n&&this.getModel().viewDidReverse(this)}},{key:"update",value:function(){var e=this.getModel().isReverse();e?(this._$encodeAction.classList.remove("brick__action--active"),this._$decodeAction&&this._$decodeAction.classList.add("brick__action--active")):(this._$encodeAction.classList.add("brick__action--active"),this._$decodeAction&&this._$decodeAction.classList.remove("brick__action--active"));var t=this.getModel().getLastError(),n=this.getModel().getLastTranslationMeta();if(null!==n){var r=n.isEncode?"forward":"backward",i="".concat(n.isEncode!==e?"Encoded":"Decoded"," ");return null!==n.charCount?i+="".concat(n.charCount," ")+"".concat(1===n.charCount?"char":"chars"):i+="".concat(n.byteCount," ")+"".concat(1===n.byteCount?"byte":"bytes"),this.updateStatus(r,i)}return null!==t?this.updateStatus("error",t.message):this}}]),t}(Nu),hc=function(){function e(){ot(this,e)}return lt(e,null,[{key:"mod",value:function(e,t){var n=e%(t=t<0?-t:t);return n<0?n+t:n}},{key:"div",value:function(e,t){return Math.floor(e/t)}},{key:"isCoprime",value:function(t,n){return 1===e.gcd(t,n)}},{key:"gcd",value:function(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}},{key:"xgcd",value:function(t,n){if(0===n)return[1,0,t];var r=yt(e.xgcd(n,t%n),3),i=r[0],a=r[1],o=r[2];return[a,i-a*e.div(t,n),o]}},{key:"time",value:function(){return"undefined"!=typeof window&&void 0!==window.performance?window.performance.now():"undefined"!=typeof process?process.hrtime()[1]/1e6:parseFloat((new Date).getTime())}}]),e}(),dc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=cc,e._reverse=!1,e._encodeOnly=!1,e._lastError=null,e._lastTranslationMeta=null,e}return ut(t,e),lt(t,[{key:"encode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.translate(e,!0));case 1:case"end":return t.stop()}}),null,this)}},{key:"decode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.translate(e,!1));case 1:case"end":return t.stop()}}),null,this)}},{key:"translate",value:function(e,t){var n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,n=hc.time(),t!==this._reverse||!this.isEncodeOnly()){i.next=4;break}throw new Js("Decoding is not defined in brick '".concat(this.getMeta().title,"'"));case 4:if(!((r=this.getSettingsForm().getInvalidFields()).length>0)){i.next=7;break}throw new Js("Can't ".concat(t?"encode":"decode"," with invalid settings: ")+r.map((function(e){return e.getLabel()+" ("+(e.getMessage()||"none")+")"})).join(", "));case 7:if(e=al.wrap(e),t===this._reverse){i.next=26;break}return i.t0=al,i.next=12,regeneratorRuntime.awrap(this.willEncode(e));case 12:return i.t1=i.sent,e=i.t0.wrap.call(i.t0,i.t1),i.t2=al,i.next=17,regeneratorRuntime.awrap(this.performEncode(e));case 17:return i.t3=i.sent,e=i.t2.wrap.call(i.t2,i.t3),i.t4=al,i.next=22,regeneratorRuntime.awrap(this.didEncode(e));case 22:i.t5=i.sent,e=i.t4.wrap.call(i.t4,i.t5),i.next=41;break;case 26:return i.t6=al,i.next=29,regeneratorRuntime.awrap(this.willDecode(e));case 29:return i.t7=i.sent,e=i.t6.wrap.call(i.t6,i.t7),i.t8=al,i.next=34,regeneratorRuntime.awrap(this.performDecode(e));case 34:return i.t9=i.sent,e=i.t8.wrap.call(i.t8,i.t9),i.t10=al,i.next=39,regeneratorRuntime.awrap(this.didDecode(e));case 39:i.t11=i.sent,e=i.t10.wrap.call(i.t10,i.t11);case 41:return this._lastError=null,this._lastTranslationMeta={isEncode:t,duration:hc.time()-n,byteCount:e.needsByteEncoding()?null:e.getSize(),charCount:e.needsTextEncoding()?null:e.getLength()},this.updateView(),i.abrupt("return",e);case 47:throw i.prev=47,i.t12=i.catch(0),this._lastError=i.t12,this._lastTranslationMeta=null,this.updateView(),i.t12;case 53:case"end":return i.stop()}}),null,this,[[0,47]])}},{key:"isReverse",value:function(){return this._reverse}},{key:"setReverse",value:function(e){return this._reverse!==e&&(this._reverse=e,this.updateView(),this.hasPipe()&&this.getPipe().encoderDidReverse(this,e)),this}},{key:"isEncodeOnly",value:function(){return this._encodeOnly}},{key:"setEncodeOnly",value:function(e){return this._encodeOnly=e,this}},{key:"getLastError",value:function(){return this._lastError}},{key:"getLastTranslationMeta",value:function(){return this._lastTranslationMeta}},{key:"serialize",value:function(){var e=vt(ct(t.prototype),"serialize",this).call(this);return this.isReverse()&&(e.reverse=!0),e}},{key:"copy",value:function(){var e=vt(ct(t.prototype),"copy",this).call(this);return e.setReverse(this.isReverse()),e}},{key:"willEncode",value:function(e){return this.willTranslate(e,!0)}},{key:"performEncode",value:function(e){return this.performTranslate(e,!0)}},{key:"didEncode",value:function(e){return this.didTranslate(e,!0)}},{key:"willDecode",value:function(e){return this.willTranslate(e,!1)}},{key:"performDecode",value:function(e){return this.performTranslate(e,!1)}},{key:"didDecode",value:function(e){return this.didTranslate(e,!1)}},{key:"willTranslate",value:function(e,t){return e}},{key:"performTranslate",value:function(e,t){return e}},{key:"didTranslate",value:function(e,t){return e}},{key:"viewDidReverse",value:function(e){this.setReverse(!this.isReverse()),Ou.trigger("encoderReverse",{encoder:this,reverse:this.isReverse()})}}]),t}(uc),fc=0,gc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._mode=fc,e.registerSeparatorSetting(),e}return ut(t,e),lt(t,[{key:"setCharacterToBlockMode",value:function(){return this._mode=fc,this}},{key:"setBlockToCharacterMode",value:function(){return this._mode=1,this}},{key:"registerSeparatorSetting",value:function(){return this.addSetting({name:"separator",type:"text",value:" ",minLength:1,randomizable:!1,priority:-10})}},{key:"getSeparator",value:function(){return this.getSettingValue("separator")}},{key:"performEncode",value:function(e){var t=this;switch(this._mode){case fc:var n=e.getCodePoints().map((function(n,r){return t.performCharEncodeToBlock(n,r,e)})).filter((function(e){return null!==e})).map(al.wrap);return al.join(n,this.getSeparator());case 1:return e.split(this.getSeparator()).map((function(n,r,i){return t.performBlockEncodeToChar(n,r,i,e)})).filter((function(e){return null!==e}))}}},{key:"performDecode",value:function(e){var t=this;switch(this._mode){case fc:return e.split(this.getSeparator()).map((function(n,r,i){return t.performBlockDecodeToChar(n,r,i,e)})).filter((function(e){return null!==e}));case 1:var n=e.getCodePoints().map((function(n,r){return t.performCharDecodeToBlock(n,r,e)})).filter((function(e){return null!==e})).map(al.wrap);return al.join(n,this.getSeparator())}}},{key:"performCharEncodeToBlock",value:function(e,t,n){}},{key:"performBlockEncodeToChar",value:function(e,t,n,r){}},{key:"performCharDecodeToBlock",value:function(e,t,n){}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){}}]),t}(dc),pc={name:"a1z26",title:"A1Z26",category:"Ciphers",type:"encoder"},vc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:"abcdefghijklmnopqrstuvwxyz",uniqueChars:!0,minLength:2},{name:"caseSensitivity",type:"boolean",value:!1,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return pc}}]),lt(t,[{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other");break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}},{key:"willEncode",value:function(e){return this.getSettingValue("caseSensitivity")?e:e.toLowerCase()}},{key:"performCharEncodeToBlock",value:function(e,t,n){var r=this.getSettingValue("caseSensitivity"),i=this.getSettingValue("alphabet");r||(i=i.toLowerCase());var a=i.indexOfCodePoint(e);return-1===a?null:(a+=1).toString()}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){var i=this.getSettingValue("caseSensitivity"),a=this.getSettingValue("alphabet");i||(a=a.toLowerCase());var o=parseInt(e);return isNaN(o)||o<1||o>a.getLength()?null:a.getCodePointAt(o-1)}}]),t}(gc),yc={name:"polybius-square",title:"Polybius square",category:"Polybius square ciphers",type:"encoder"},mc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"alphabet",type:"text",value:"abcdefghiklmnopqrstuvwxyz",uniqueChars:!0,minLength:2,validateValue:e.validateAlphabetValue.bind(gt(e)),caseSensitivity:!1},{name:"rows",type:"text",value:"12345",uniqueChars:!0,minLength:2,width:6,randomizable:!1,caseSensitivity:!1},{name:"columns",type:"text",value:"12345",uniqueChars:!0,minLength:2,width:6,randomizable:!1,caseSensitivity:!1},{name:"separator",type:"text",value:"",randomizable:!1,caseSensitivity:!1,validateValue:e.validateSeparatorValue.bind(gt(e))},{name:"caseSensitivity",type:"boolean",width:6,value:!1,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!1,randomizable:!1,trueLabel:"Include",falseLabel:"Ignore"}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return yc}}]),lt(t,[{key:"willTranslate",value:function(e,t){return this.getSettingValue("caseSensitivity")?e:e.toLowerCase()}},{key:"performEncode",value:function(e){for(var t,n,r,i=this.getSettingValue("alphabet").getCodePoints(),a=this.getSettingValue("separator").getCodePoints(),o=this.getSettingValue("includeForeignChars"),s=this.getSettingValue("rows").getCodePoints(),l=this.getSettingValue("columns").getCodePoints(),u=l.length,c=e.getCodePoints(),h=a.length,d=c.length,f=new Array(d*(h+2)),g=0,p=!1,v=0;v<d;v++){if(t=c[v],n=i.indexOf(t),g>0&&(-1!==n||o&&!p))for(r=0;r<h;r++)f[g++]=a[r];p=!1,-1!==n?(f[g++]=s[Math.floor(n/u)],f[g++]=l[n%u]):o&&(f[g++]=t,p=!0)}return f.slice(0,g)}},{key:"performDecode",value:function(e){for(var t,n,r,i=this.getSettingValue("alphabet").getCodePoints(),a=this.getSettingValue("separator").getCodePoints(),o=this.getSettingValue("includeForeignChars"),s=this.getSettingValue("rows").getCodePoints(),l=this.getSettingValue("columns").getCodePoints(),u=Ss.replaceSlice(e.getCodePoints(),a),c=i.length,h=l.length,d=u.length,f=new Array(d),g=0,p=0;g<d;){for(t=null;null===t&&g<d;)-1!==(r=s.indexOf(u[g]))?t=r:o&&(f[p++]=u[g]),g++;for(n=null;null===n&&g<d;)-1!==(r=s.indexOf(u[g]))?n=r:o&&(f[p++]=u[g]),g++;if(null!==t&&null!==n){if((r=t*h+n)>=c)throw new Js("Polybius square cell at coordinates ".concat(t,",").concat(n," are not ")+"defined by the alphabet.");f[p++]=i[r]}else if(null!==t||null!==n)throw new Js("Reached unexpected end of content. The last set of Polybius square coordinates is incomplete.")}return f.slice(0,p)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"caseSensitivity":this.getSetting("alphabet").setCaseSensitivity(t),this.getSetting("rows").setCaseSensitivity(t),this.getSetting("columns").setCaseSensitivity(t),this.getSetting("separator").setCaseSensitivity(t);break;case"columns":case"rows":this.getSetting("alphabet").revalidateValue()}}},{key:"validateAlphabetValue",value:function(e,t){var n=e.getLength(),r=this.getSettingValue("columns").getLength(),i=this.getSettingValue("rows").getLength();return n>i*r?{key:"polybiusSquareAlphabetTooLong",message:"The alphabet size ".concat(n," is too big for the given ")+"".concat(i,"×").concat(r," Polybius square defined by the settings ")+"'columns' and 'rows'."}:!(n<=(i-1)*r)||{key:"polybiusSquareAlphabetTooShort",message:"The alphabet size ".concat(n," is too short for the given ")+"".concat(i,"×").concat(r," Polybius square defined by the settings ")+"'columns' and 'rows'."}}},{key:"validateSeparatorValue",value:function(e,t){var n=this.getSettingValue("rows").getCodePoints();return n.concat(this.getSettingValue("columns").getCodePoints()),!(void 0!==e.getCodePoints().find((function(e){return-1!==n.indexOf(e)})))||{key:"polybiusSquareSeparatorInvalid",message:"The separator shall not contain characters from the Polybius square rows or columns"}}}]),t}(dc),bc={name:"adfgx-cipher",title:"ADFGX cipher",category:"Polybius square ciphers",type:"encoder"},kc="adfgx",wc=[{name:"adfgx",label:"ADFGX",squarePositions:"adfgx",alphabet:"zyxwvutsrqponmlkihgfedcba"},{name:"adfgvx",label:"ADFGVX",squarePositions:"adfgvx",alphabet:"9876543210zyxwvutsrqponmlkjihgfedcba"}],_c="abcdefghiklmnopqrstuvwxyz",Sc=function(e){function t(){var e;ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",value:kc,elements:wc.map((function(e){return e.name})),labels:wc.map((function(e){return e.label})),randomizable:!1},{name:"alphabet",type:"text",value:_c,uniqueChars:!0,blacklistChars:" ",minLength:0,maxLength:25,caseSensitivity:!1},{name:"key",type:"text",value:"cargo",minLength:2,maxLength:24,caseSensitivity:!1}]);var n=e.constructor.getVariant(kc);return e._polybiusSquare=new mc,e._polybiusSquare.setSettingValues({alphabet:_c,rows:n.squarePositions,columns:n.squarePositions,separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return bc}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.getString(),"adfgx"===this.getSettingValue("variant")&&(t=t.replace(/j/gi,"i")),n=this.getSettingValue("key"),r=n.getLength(),i=this.mapElementsToSortedPosition(n.getChars()),f.next=8,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 8:for(a=f.sent,o=a.getLength(),s=new Array(o+r),d=0,l=0;l<r;l++)for(u=i[l],c=0;c*r+u<o;c++)h=c*r+u,s[d++]=a.getCodePointAt(h);return f.abrupt("return",Ss.joinSlices(Ss.chunk(s.slice(0,d),5),[32]));case 14:case"end":return f.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a=this.getSettingValue("variant"),o=this.constructor.getVariant(a),s=al.wrap(o.squarePositions).getCodePoints(),l=e.getCodePoints().filter((function(e){return-1!==s.indexOf(e)})),u=l.length,c=this.getSettingValue("key"),h=c.getLength(),d=this.mapElementsToSortedPosition(c.getChars()),f=u%h||h,g=Math.ceil(u/h),p=new Array(u),v=0;for(t=0;t<h;t++)for(i=(n=d[t])>=f?g-1:g,r=0;r<i;r++)p[r*h+n]=l[v++];return this._polybiusSquare.decode(p)}},{key:"mapElementsToSortedPosition",value:function(e){for(var t,n=e.length,r=new Array(n),i=e.slice(),a=e.slice().sort(),o=0;o<n;o++)t=i.indexOf(a[o]),r[o]=t,delete i[t];return r}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":var n=this.constructor.getVariant(t);this._polybiusSquare.setSettingValues({rows:n.squarePositions,columns:n.squarePositions});var r=this.getSetting("alphabet");r.isValid()&&this._polybiusSquare.setSettingValue("alphabet",r.getValue().extend(n.alphabet)),this.getSetting("alphabet").setMaxLength(n.alphabet.length),this.getSetting("key").setMaxLength(n.alphabet.length-1);break;case"alphabet":var i=this.constructor.getVariant(this.getSettingValue("variant"));this._polybiusSquare.setSettingValue("alphabet",t.extend(i.alphabet))}}}],[{key:"getVariant",value:function(e){return wc.find((function(t){return t.name===e}))||null}}]),t}(dc),xc={name:"affine-cipher",title:"Affine cipher",category:"Ciphers",type:"encoder"},Cc="abcdefghijklmnopqrstuvwxyz",Ic=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"a",type:"number",label:"Slope / a",value:5,integer:!0,min:1,validateValue:e.validateSlopeValue.bind(gt(e)),randomizeValue:e.randomizeSlopeValue.bind(gt(e)),width:6},{name:"b",type:"number",label:"Intercept / b",value:8,integer:!0,min:1,randomizeValue:e.randomizeInterceptValue.bind(gt(e)),width:6},{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:Cc,uniqueChars:!0,minLength:2,randomizable:!1,caseSensitivity:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!0,width:6,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return xc}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n,r=this.getSettingValues(),i=r.a,a=r.b,o=r.caseStrategy,s=r.includeForeignChars,l=this.getSettingValue("alphabet");"strict"!==o&&(n=(l=l.toLowerCase()).toUpperCase());var u,c,h,d,f,g,p=l.getLength(),v=e.getLength(),y=new Array(v).fill(0),m=0;for(h=0;h<v;h++)u=e.getCodePointAt(h),c=!1,-1===(f=l.indexOfCodePoint(u))&&"strict"!==o&&(f=n.indexOfCodePoint(u),c=!0),-1===f?s&&(y[m++]=u):(t?g=hc.mod(i*f+a,p):(d=hc.xgcd(i,p)[0],g=hc.mod(d*(f-a),p)),y[m++]="maintain"===o&&c?n.getCodePointAt(g):l.getCodePointAt(g));return y.slice(0,m)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.getSetting("a").revalidateValue(),"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other");break;case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t);break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}},{key:"validateSlopeValue",value:function(e){var t=this.getSetting("alphabet");if(!t.isValid())return!1;var n=t.getValue().getLength();return!!hc.isCoprime(e,n)||{key:"affineCipherFunctionInvalid",message:"The value must be chosen such that it is coprime to the size "+"of the alphabet (".concat(n,")")}}},{key:"randomizeSlopeValue",value:function(e,t){var n=this.getSetting("alphabet");if(n.isValid()){var r=n.getValue(),i=r.getLength(),a=r.getCodePoints().map((function(e,t){return t+1})).filter((function(e){return e>1&&hc.isCoprime(e,i)}));return a.length>0?e.nextChoice(a):1}return null}},{key:"randomizeInterceptValue",value:function(e,t){if(this.getSetting("alphabet").isValid()){var n=this.getSetting("alphabet").getValue().getLength();return e.nextInteger(1,n-1)}return null}}]),t}(dc),Vc={name:"alphabetical-substitution",title:"Atbash/Generic substitution",category:"Ciphers",type:"encoder"},Ec="abcdefghijklmnopqrstuvwxyz",Ac="zyxwvutsrqponmlkjihgfedcba",Tc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"plaintextLanguage",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],randomizable:!1},{name:"plaintextAlphabet",type:"text",value:Ec,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"ciphertextAlphabet",type:"text",value:Ac,uniqueChars:!0,minLength:0,caseSensitivity:!1,validateValue:e.validateCiphertextValue.bind(gt(e)),randomizeValue:e.randomizeCiphertextValue.bind(gt(e))},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!0,trueLabel:"Include",falseLabel:"Ignore",width:6,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Vc}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n,r,i=this.getSettingValue("caseStrategy"),a=this.getSettingValue("includeForeignChars"),o=this.getSettingValue("plaintextAlphabet"),s=this.getSettingValue("ciphertextAlphabet").extend(o);if(!t){var l=[o,s];s=l[0],o=l[1]}"strict"!==i&&(o=o.toLowerCase(),s=s.toLowerCase(),n=o.toUpperCase(),r=s.toUpperCase());for(var u,c,h,d=e.getCodePoints(),f=new Array(d.length).fill(0),g=0,p=0;p<d.length;p++)u=d[p],h=!1,-1===(c=o.indexOfCodePoint(u))&&"strict"!==i&&(c=n.indexOfCodePoint(u),h=!0),-1!==c?f[g++]="maintain"===i&&h?r.getCodePointAt(c):s.getCodePointAt(c):a&&(f[g++]=u);return f.slice(0,g)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"plaintextAlphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("plaintextLanguage").setValue("other"),this.getSetting("ciphertextAlphabet").setValue(t.split("").reverse().join(""));break;case"plaintextLanguage":"english"==t?this.getSetting("plaintextAlphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&this.getSetting("plaintextAlphabet").setValue("abcdefghilmnopqrstuvz");break;case"caseStrategy":this.getSetting("plaintextAlphabet").setCaseSensitivity("strict"===t),this.getSetting("ciphertextAlphabet").setCaseSensitivity("strict"===t)}}},{key:"validateCiphertextValue",value:function(e,t){if(!this.isSettingValid("plaintextAlphabet"))return!1;var n=this.getSettingValue("plaintextAlphabet");return!(e.getLength()>n.getLength())||{key:"alphabetContainsUnusedCharacters",message:"The ciphertext alphabet is longer than the plaintext alphabet"}}},{key:"randomizeCiphertextValue",value:function(e,t){if(!this.getSetting("plaintextAlphabet").isValid())return null;var n=this.getSettingValue("plaintextAlphabet");return al.wrap(Ss.shuffle(n.getCodePoints()))}}]),t}(dc),Mc={name:"ascii85",title:"Ascii85",category:"Encoding",type:"encoder"},Lc=[{name:"original",label:"Original",alphabet:null,zeroTupleChar:"z"},{name:"Z85",label:"Z85 (ZeroMQ)",alphabet:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#",zeroTupleChar:null}],Pc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSetting({name:"variant",type:"enum",label:"Variant",value:"original",elements:Lc.map((function(e){return e.name})),labels:Lc.map((function(e){return e.label})),randomizable:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Mc}}]),lt(t,[{key:"performEncode",value:function(e){for(var t,n,r,i=this,a=e.getBytes(),o=Lc.find((function(e){return e.name===i.getSettingValue("variant")})),s=a.length,l="",u=0;u<s;u+=4)if(r=(a[u]<<24)+((a[u+1]||0)<<16)+((a[u+2]||0)<<8)+(a[u+3]||0)>>>0,null===o.zeroTupleChar||r>0){for(t=[],n=0;n<5;n++)t.push(r%85),r=Math.floor(r/85);t=t.reverse(),s<u+4&&t.splice(s-(u+4),4),l+=t.map((function(e){return null===o.alphabet?String.fromCharCode(e+33):o.alphabet[e]})).join("")}else l+=o.zeroTupleChar;return l}},{key:"willDecode",value:function(e){var t=e.getString().match(/<~(.+?)~>/);return null!==t?t[1]:e}},{key:"performDecode",value:function(e){for(var t,n,r,i=this,a=Xs.removeWhitespaces(e.getString()),o=Lc.find((function(e){return e.name===i.getSettingValue("variant")})),s=a.length,l=[],u=0;u<s;)a[u]===o.zeroTupleChar?(l.push(0,0,0,0),u++):(r=[(n=52200625*(t=a.substr(u,5).split("").map((function(e,t){var n=null===o.alphabet?e.charCodeAt(0)-33:o.alphabet.indexOf(e);if(n<0||n>84)throw new Js("Invalid character '".concat(e,"' at index ").concat(t));return n})))[0]+614125*t[1]+7225*(u+2<s?t[2]:84)+85*(u+3<s?t[3]:84)+(u+4<s?t[4]:84))>>24&255,n>>16&255,n>>8&255,255&n],s<u+5&&r.splice(s-(u+5),5),l.push.apply(l,r),u+=5);return new Uint8Array(l)}}]),t}(dc),Bc={name:"bacon-cipher",title:"Bacon cipher",category:"Ciphers",type:"encoder"},zc=[{name:"original",label:"Original",alphabet:"abcdefghijklmnopqrstuvwxyz",codeAlphabet:"aaaaaaaaabaaabaaaabbaabaaaababaabbaaabbbabaaaabaaaabaabababaababbabbaaabbababbbaabbbbbaaaabaaabbaababaabbbaabbbabaabababbabbababbb"},{name:"unique",label:"Unique codes for each letter",alphabet:"abcdefghijklmnopqrstuvwxyz",codeAlphabet:"aaaaaaaaabaaabaaaabbaabaaaababaabbaaabbbabaaaabaabababaababbabbaaabbababbbaabbbbbaaaabaaabbaababaabbbabaabababbabbababbbbbaaabbaab"}],Nc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",label:"Variant",value:"original",elements:zc.map((function(e){return e.name})),labels:zc.map((function(e){return e.label})),randomizable:!1},{name:"aMark",label:"Letter 1",type:"text",width:6,value:"a",minLength:1,maxLength:1,randomizable:!1,validateValue:e.validateLetterSettingValue.bind(gt(e))},{name:"bMark",label:"Letter 2",type:"text",width:6,value:"b",minLength:1,maxLength:1,randomizable:!1,validateValue:e.validateLetterSettingValue.bind(gt(e))}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Bc}}]),lt(t,[{key:"validateLetterSettingValue",value:function(e,t){var n=this.getSetting("aMark"===t.getName()?"bMark":"aMark");return n.isValid()&&!e.isEqualTo(n.getValue())}},{key:"performEncode",value:function(e){for(var t,n=this._getVariant(),r=n.alphabet,i=n.codes,a=n.codeLength,o=this.getSettingValue("aMark").getCharAt(0),s=this.getSettingValue("bMark").getCharAt(0),l=e.toLowerCase(),u="",c=0;c<l.getLength();c++)-1!==(t=r.indexOf(l.getCharAt(c)))&&(u+=i[t]);return"a"===o&&"b"===s||(u=u.split("").map((function(e){return"a"===e?o:s})).join("")),Ss.chunk(al.wrap(u).getChars(),a).map((function(e){return e.join("")})).join(" ")}},{key:"performDecode",value:function(e){var t,n=this._getVariant(),r=n.alphabet,i=n.codes,a=n.codeLength,o=this.getSettingValue("aMark").getCodePointAt(0),s=this.getSettingValue("bMark").getCodePointAt(0),l=e.getCodePoints(),u="";for(t=0;t<l.length;t++)switch(l[t]){case o:u+="a";break;case s:u+="b"}var c,h=Xs.chunk(u,a),d="";for(t=0;t<h.length;t++)-1!==(c=i.indexOf(h[t]))&&(d+=r[c]);return d}},{key:"_getVariant",value:function(){var e=this.getSettingValue("variant"),t=zc.find((function(t){return t.name===e})),n=t.alphabet,r=t.codeAlphabet,i=r.length/n.length;return{alphabet:n,codes:Xs.chunk(r,i),codeLength:i}}}]),t}(dc),Rc={name:"base32",title:"Base32",category:"Encoding",type:"encoder"},Oc=[{name:"base32",label:"Base32 (RFC 3548, RFC 4648)",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",padding:61,decodeMap:{48:14,49:8}},{name:"base32hex",label:"Base32hex (RFC 4648)",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",padding:61},{name:"z-base-32",label:"z-base-32",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",padding:null},{name:"crockford-base32",label:"Crockford's Base32",alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",padding:null,decodeContentFilter:"uppercase",decodeMap:{79:0,73:1,76:1}},{name:"custom",label:"Custom"}],Fc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",value:Oc[0].name,elements:Oc.map((function(e){return e.name})),labels:Oc.map((function(e){return e.label})),randomizable:!1},{name:"alphabet",type:"text",value:Oc[0].alphabet,uniqueChars:!0,minLength:32,maxLength:32,caseSensitivity:!0,visible:!1},{name:"padding",type:"text",value:"=",blacklistChars:Oc[0].alphabet,minLength:0,maxLength:1,randomizable:!1,visible:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Rc}}]),lt(t,[{key:"performEncode",value:function(e){for(var t,n,r=this.getVariantOptions(),i=r.alphabet,a=r.padding,o=i.getCodePoints(),s=e.getBytes(),l=s.length,u=8*Math.ceil(l/5),c=new Array(u),h=0,d=3,f=0,g=0;g<l;g++)n=f|(t=s[g])>>d,c[h++]=o[31&n],d>5&&(n=t>>(d-=5),c[h++]=o[31&n]),f=t<<(d=5-d),d=8-d;if(3!==d&&(c[h++]=o[31&f]),null!==a){for(;h<u;)c[h++]=a;return c}return c.slice(0,h)}},{key:"performDecode",value:function(e){var t=this.getVariantOptions(),n=t.alphabet,r=t.decodeMap,i=t.padding;"uppercase"===t.decodeContentFilter&&(e=e.toUpperCase());for(var a=0;a<n.getLength();a++)r[n.getCodePointAt(a)]=a;for(var o,s,l=e.getCodePoints(),u=l.length,c=5*Math.ceil(u/8),h=new Uint8Array(c),d=0,f=8,g=0,p=0;p<u;p++)if((o=l[p])===i);else{if(void 0===r[o])throw new Js("Unexpected code point at index ".concat(p));s=255&r[o],(f-=5)>0?g|=s<<f:f<0?(h[d++]=g|s>>-f,g=s<<(f+=8)&255):(h[d++]=g|s,f=8,g=0)}return h.slice(0,d)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("alphabet").setVisible("custom"===t),this.getSetting("padding").setVisible("custom"===t);break;case"alphabet":this.getSetting("padding").setBlacklistChars(t)}}},{key:"getVariantOptions",value:function(){var e=this.getSettingValue("variant");if("custom"===e){var t=this.getSettingValue("padding");return{alphabet:this.getSettingValue("alphabet"),padding:1===t.getLength()?t.getCodePointAt(0):null,decodeContentFilter:null,decodeMap:{}}}var n=Oc.find((function(t){return t.name===e}));return n.alphabet=al.wrap(n.alphabet),n.decodeMap=n.decodeMap||{},n}}]),t}(dc),Dc={name:"base64",title:"Base64",category:"Encoding",type:"encoder"},jc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",qc=[{name:"base64",label:"Base64 (RFC 3548, RFC 4648)",description:null,alphabet:"".concat(jc,"+/")},{name:"base64url",label:"Base64url (RFC 4648 §5)",description:"URL and Filename Safe Alphabet",alphabet:"".concat(jc,"-_"),paddingOptional:!0},{name:"rfc2045",label:"Transfer encoding for MIME (RFC 2045)",description:null,alphabet:"".concat(jc,"+/"),foreignCharacters:!0,maxLineLength:76},{name:"rfc1421",label:"Original Base64 (RFC 1421)",description:"Privacy-Enhanced Mail (PEM)",alphabet:"".concat(jc,"+/"),maxLineLength:64},{name:"custom",label:"Custom"}],$c=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",value:qc[0].name,elements:qc.map((function(e){return e.name})),labels:qc.map((function(e){return e.label})),descriptions:qc.map((function(e){return e.description})),randomizable:!1},{name:"alphabet",type:"text",value:qc[0].alphabet,uniqueChars:!0,minLength:64,maxLength:64,caseSensitivity:!0,visible:!1},{name:"padding",type:"text",value:"=",blacklistChars:qc[0].alphabet,minLength:1,maxLength:1,randomizable:!1,visible:!1,width:6},{name:"paddingOptional",type:"boolean",value:!1,randomizable:!1,visible:!1,width:6}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Dc}}]),lt(t,[{key:"performEncode",value:function(e){return tl.base64StringFromBytes(e.getBytes(),this.getVariantOptions())}},{key:"performDecode",value:function(e){return tl.bytesFromBase64String(e.getString(),this.getVariantOptions())}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("alphabet").setVisible("custom"===t),this.getSetting("padding").setVisible("custom"===t),this.getSetting("paddingOptional").setVisible("custom"===t);break;case"alphabet":this.getSetting("padding").setBlacklistChars(t)}}},{key:"getVariantOptions",value:function(){var e=this.getSettingValue("variant");return"custom"===e?{alphabet:this.getSettingValue("alphabet").getString(),padding:this.getSettingValue("padding").getCharAt(0),paddingOptional:this.getSettingValue("paddingOptional")}:qc.find((function(t){return t.name===e}))}}]),t}(dc),Uc={name:"baudot-code",title:"Baudot code",category:"Encoding",type:"encoder"},Wc=[{name:"ita1",label:"Original Baudot - ITA 1",characterSet:[0,"A","E","\r","Y","U","I","O","FS","J","G","H","B","C","F","D"," ","\n","X","Z","S","T","W","V",127,"K","M","L","R","Q","N","P",0,"1","2","\r","3","4",null,"5"," ","6","7","+","8","9",null,"0","LS","\n",",",":",".",null,"?","'",127,"(",")","=","-","/",null,"%"]},{name:"original-eu",label:"Original Baudot - Continental European",extends:"ita1",overrides:{3:"É",17:"T",35:"&",38:"º",43:"h",46:"f",49:".",52:";",53:"!",62:"№"}},{name:"original-uk",label:"Original Baudot - Domestic UK",extends:"ita1",overrides:{3:"/",18:"-",35:"⅟",38:"³",43:"¹",46:"⁵",49:".",50:"⁹",52:"⁷",53:"²",62:"£",63:"+"}},{name:"ita2",label:"Baudot-Murray - ITA 2",characterSet:[0,"E","\n","A"," ","S","I","U","\r","D","R","J","N","F","C","K","T","Z","L","W","H","Y","P","Q","O","B","G","FS","M","X","V",15,0,"3","\n","-"," ","'","8","7","\r",5,"4",7,",","!",":","(","5","+",")","2","£","6","0","1","9","?","&",14,".","/","=","LS"]},{name:"us-tty",label:"Baudot-Murray - US-TTY",extends:"ita2",overrides:{37:"'",41:5,43:7,49:"+",52:"£",62:"="}},{name:"murray-code",label:"Baudot-Murray - Murray Code",extends:"ita2",overrides:{0:" ",2:null,4:15,8:"\n",31:"*",32:" ",34:null,35:null,36:"LS",40:"\n",41:"²",43:"⁷",44:"-",45:"⅟",46:"(",47:"⁹",49:".",50:"/",52:"⁵",58:"³",60:",",61:"£",62:")",63:"*"}}],Hc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._variantCharacterSet=[],e.addSetting({name:"variant",type:"enum",value:"ita2",elements:Wc.map((function(e){return e.name})),labels:Wc.map((function(e){return e.label})),randomizable:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Uc}}]),lt(t,[{key:"performEncode",value:function(e){for(var t,n,r=this.getSettingValue("variant"),i=this.getVariantCharacterSet(r),a=i.indexOf("FS")%32,o=i.indexOf("LS")%32,s=e.getCodePoints(),l=s.length,u=[],c=!1,h=0;h<l;h++)n=s[h],-1===(t=i.indexOf(n))&&n>=97&&n<=122&&(t=i.indexOf(n-32)),t>=0&&t<32?(c&&(u.push(o),c=!1),u.push(t)):t>=32&&(c||(u.push(a),c=!0),u.push(t-32));return Ss.resizeBitSizedArray(u,5,8)}},{key:"performDecode",value:function(e){for(var t,n,r=this.getSettingValue("variant"),i=this.getVariantCharacterSet(r),a=i.indexOf("FS")%32,o=i.indexOf("LS")%32,s=Ss.resizeBitSizedArray(e.getBytes(),8,5,!0),l=new Array(s.length),u=!1,c=0,h=0;h<s.length;h++)t=s[h],u||t!==a?u&&t===o?u=!1:null!==(n=i[t+(u?32:0)])&&(l[c++]=n):u=!0;return l.slice(0,c)}},{key:"getVariantCharacterSet",value:function(e){if(void 0!==this._variantCharacterSet[e])return this._variantCharacterSet[e];var t=Wc.find((function(t){return t.name===e}));if(void 0===t)return null;var n=(t.characterSet||[]).slice();if(t.extends){var r=this.getVariantCharacterSet(t.extends);null!==r&&(n=r.slice())}if(t.overrides)for(var i in t.overrides)n[i]=t.overrides[i];for(var a=0;a<n.length;a++){var o=n[a];"FS"!==o&&"LS"!==o&&null!==o&&(n[a]="string"==typeof o?rl.codePointsFromString(o)[0]:o)}return this._variantCharacterSet[e]=n,n}}]),t}(dc),Gc={name:"bifid-cipher",title:"Bifid cipher",category:"Polybius square ciphers",type:"encoder"},Kc="abcdefghiklmnopqrstuvwxyz",Zc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSetting({name:"key",type:"text",value:"",uniqueChars:!0,minLength:0,caseSensitivity:!1}),e._polybiusSquare=new mc,e._polybiusSquare.setSettingValues({alphabet:Kc,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Gc}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/j/gi,"i")));case 2:for(t=a.sent,n=t.getLength(),r=new Array(n),i=0;i<n/2;i++)r[i]=t.getCodePointAt(2*i),r[n/2+i]=t.getCodePointAt(2*i+1);return a.abrupt("return",this._polybiusSquare.decode(r));case 7:case"end":return a.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this._polybiusSquare.encode(e));case 2:for(t=a.sent,n=t.getLength(),r=new Array(n),i=0;i<n/2;i++)r[2*i]=t.getCodePointAt(i),r[2*i+1]=t.getCodePointAt(n/2+i);return a.abrupt("return",this._polybiusSquare.decode(r));case 7:case"end":return a.stop()}}),null,this)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"key":this._polybiusSquare.setSettingValue("alphabet",t.extend(Kc))}}}]),t}(dc),Xc={name:"bitwise-operation",title:"Bitwise operation",category:"Transform",type:"encoder"},Yc={NOT:"NOT",AND:"NAND",OR:"NOR",XOR:"NXOR",NAND:"AND",NOR:"OR",NXOR:"XOR"},Jc=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"operation",type:"enum",value:"NOT",elements:["NOT","AND","OR","XOR","NAND","NOR","NXOR"],labels:["NOT ~a","AND (a & b)","OR (a | b)","XOR (a ^ b)","NAND ~(a & b)","NOR ~(a | b)","NXOR ~(a ^ b)"],randomizable:!1,style:"radio"},{name:"operand",label:"Operand B (Repeating)",type:"bytes",value:new Uint8Array([15]),minSize:1,visible:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Xc}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=this,r=e.getBytes(),i=this.getSettingValue("operand"),a=this.getSettingValue("operation");return t||(a=Yc[a]),r.map((function(e,t){return n.performByteOperation(e,a,i[t%i.length])}))}},{key:"performByteOperation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(t){case"NOT":return~e;case"AND":return e&n;case"OR":return e|n;case"XOR":return e^n;case"NAND":return~(e&n);case"NOR":return~(e|n);case"NXOR":return~(e^n);default:return e}}},{key:"settingValueDidChange",value:function(e,t){"operation"===e.getName()&&this.getSetting("operand").setVisible("NOT"!==t)}}]),t}(dc),Qc=a((function(e,t){var n=r&&r.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){this.name=e,this.version=t,this.os=n};t.BrowserInfo=i;var a=function(e){this.version=e,this.name="node",this.os=process.platform};t.NodeInfo=a;var o=function(){this.bot=!0,this.name="bot",this.version=null,this.os=null};t.BotInfo=o;var s=3,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],u=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function c(e){var t=""!==e&&l.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var a=i.exec(e);return!!a&&[r,a]}),!1);if(!t)return null;var r=t[0],a=t[1];if("searchbot"===r)return new o;var u=a[1]&&a[1].split(/[._]/).slice(0,3);return u?u.length<s&&(u=n(u,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(s-u.length))):u=[],new i(r,u.join("."),h(e))}function h(e){for(var t=0,n=u.length;t<n;t++){var r=u[t],i=r[0];if(r[1].test(e))return i}return null}function d(){return"undefined"!=typeof process&&process.version?new a(process.version.slice(1)):null}t.detect=function(e){return e?c(e):"undefined"!=typeof navigator?c(navigator.userAgent):d()},t.parseUserAgent=c,t.detectOS=h,t.getNodeVersion=d}));(tc=Qc)&&tc.__esModule&&Object.prototype.hasOwnProperty.call(tc,"default")&&tc.default;Qc.BrowserInfo,Qc.NodeInfo,Qc.BotInfo;var eh=Qc.detect,th=(Qc.parseUserAgent,Qc.detectOS,Qc.getNodeVersion,null),nh=function(){function e(){ot(this,e)}return lt(e,null,[{key:"identify",value:function(){return null===th&&(th=eh()||!1),th}},{key:"match",value:function(){var t=this,n=e.identify();if(!1===n)return!1;for(var r=/([a-zA-Z0-9-]+)(?:([<>=]+)([0-9.]+))?/,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return void 0!==a.find((function(e){var i=yt(e.match(r),4),a=i[1],o=i[2],s=i[3];return a===n.name&&(void 0===s||t.matchVersion(n.version,o,s))}))}},{key:"matchVersion",value:function(e,t,n){for(var r=e.split("."),i=n.split("."),a=Math.min(r.length,i.length),o="=",s=-1;"="===o&&++s<a;)r[s]=parseInt(r[s],10),i[s]=parseInt(i[s],10),o=r[s]!==i[s]?r[s]<i[s]?"<":">":"=";return"="===o&&(o=r.length!==i.length?r.length<i.length?"<":">":"="),-1!==t.indexOf(o)}},{key:"isNode",value:function(){return this.match("node")}},{key:"isBrowser",value:function(){return"undefined"!=typeof window}},{key:"placeBrowserAttribute",value:function(){if(e.isBrowser()&&!1!==e.identify()){var t=e.identify(),n=t.name,r=t.version;document.documentElement.dataset.browser="".concat(n,"/").concat(r)}return this}}]),e}(),rh={name:"block-cipher",title:"Block Cipher",category:"Modern cryptography",type:"encoder"},ih=[{name:"aes-128",label:"AES-128",blockSize:16,keySize:16,browserAlgorithm:"aes",nodeAlgorithm:"aes-128"},{name:"aes-192",label:"AES-192",blockSize:16,keySize:24,browserAlgorithm:!1,nodeAlgorithm:"aes-192"},{name:"aes-256",label:"AES-256",blockSize:16,keySize:32,browserAlgorithm:"aes",nodeAlgorithm:"aes-256"}],ah=[{name:"ecb",label:"ECB (Electronic Code Book)",hasIV:!1,browserMode:!1,nodeMode:!0},{name:"cbc",label:"CBC (Cipher Block Chaining)",hasIV:!0,browserMode:!0,nodeMode:!0},{name:"ctr",label:"CTR (Counter)",hasIV:!0,browserMode:!0,nodeMode:!0}],oh=function(e){function n(){var e;ot(this,n),e=pt(this,ct(n).call(this));var t=n.getAlgorithms(),r=t[0],i=n.getModes(),a=n.isPaddingAvailable();return e.addSettings([{name:"algorithm",type:"enum",value:r.name,elements:t.map((function(e){return e.name})),labels:t.map((function(e){return e.label})),randomizable:!1,width:a?8:12},{name:"padding",type:"boolean",value:!1,randomizable:!1,width:a?4:12,visible:a},{name:"mode",type:"enum",value:"cbc",elements:i.map((function(e){return e.name})),labels:i.map((function(e){return e.label})),randomizable:!1},{name:"key",type:"bytes",value:new Uint8Array([43,126,21,22,40,174,210,166,171,247,21,136,9,207,79,60]),minSize:r.keySize,maxSize:r.keySize},{name:"iv",label:"IV",type:"bytes",value:new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),minSize:r.blockSize,maxSize:r.blockSize}]),e}return ut(n,e),lt(n,null,[{key:"getMeta",value:function(){return rh}}]),lt(n,[{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"algorithm":var r=n.getAlgorithm(t).keySize;this.getSetting("key").setMinSize(r).setMaxSize(r);break;case"mode":var i=this.getSettingValue("algorithm"),a=n.getAlgorithm(i).blockSize,o=n.getMode(t).hasIV;this.getSetting("iv").setVisible(o).setMinSize(a).setMaxSize(a)}}},{key:"performTranslate",value:function(e,t){var n,r,i,a,o,s,l;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=e.getBytes(),r=this.getSettingValues(),i=r.algorithm,a=r.mode,o=r.key,s=r.padding,l=r.iv,u.prev=2,u.next=5,regeneratorRuntime.awrap(this.createCipher(i,a,o,l,s,t,n));case 5:return u.abrupt("return",u.sent);case 8:if(u.prev=8,u.t0=u.catch(2),t){u.next=14;break}throw new Js("".concat(i," decryption failed, ")+"this may be due to malformed content");case 14:throw new Js("".concat(i," encryption failed"));case 15:case"end":return u.stop()}}),null,this,[[2,8]])}},{key:"createCipher",value:function(e,r,i,a,o,s,l){var u,c,h,d,f,g,p,v,y,m=this;return regeneratorRuntime.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(u=n.getAlgorithm(e),c=n.getMode(r),c.hasIV||(a=new Uint8Array([])),!nh.isNode()){b.next=10;break}return h=u.nodeAlgorithm+"-"+r,a=global.Buffer.from(a),l=global.Buffer.from(l),b.abrupt("return",new Promise((function(e,n){var r=s?t.createCipheriv(h,i,a):t.createDecipheriv(h,i,a);r.setAutoPadding(o);var u=Buffer.concat([r.update(l),r.final()]);e(new Uint8Array(u))})));case 10:return d=u.browserAlgorithm+"-"+r,f=window.crypto||window.msCrypto,g=f.subtle||f.webkitSubtle,b.next=15,regeneratorRuntime.awrap(g.importKey("raw",i,{name:d},!1,["encrypt","decrypt"]));case 15:return p=b.sent,v={name:d,iv:a,counter:a,length:u.blockSize},void 0!==(y=s?g.encrypt(v,p,l):g.decrypt(v,p,l)).oncomplete&&(y=new Promise((function(e,t){y.oncomplete=e.bind(m,y.result),y.onerror=t}))),b.abrupt("return",y.then((function(e){return new Uint8Array(e)})));case 20:case"end":return b.stop()}}))}}],[{key:"isPaddingAvailable",value:function(){return nh.isNode()}},{key:"getAlgorithm",value:function(e){return ih.find((function(t){return t.name===e}))}},{key:"getAlgorithms",value:function(){var e=nh.isNode();return ih.filter((function(t){return t.browserAlgorithm&&!e||t.nodeAlgorithm&&e}))}},{key:"getMode",value:function(e){return ah.find((function(t){return t.name===e}))}},{key:"getModes",value:function(){var e=nh.isNode();return ah.filter((function(t){return t.browserMode&&!e||t.nodeMode&&e}))}}]),n}(dc),sh={name:"punctuation-deletion",title:"Punctuation Deletion",category:"Transform",type:"encoder"},lh="<>|!\"£$%&/()=?^\\';:_,.-*[]@#°",uh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"illegals",type:"text",label:"To Remove,",value:lh,uniqueChars:!0,minLength:1,caseSensitivity:!0,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return sh}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=e.getString();for(illegals=this.getSettingValue("illegals")._string,cleanString="",i=0;i<n.length;i++){for(k=!0,j=0;j<illegals.length;j++)n[i]==illegals[j]&&(k=!1);k&&(cleanString+=n[i])}return new al(cleanString).getCodePoints()}},{key:"settingValueDidChange",value:function(e,t){}}]),t}(dc),ch={name:"space-deletion",title:"Space Deletion",category:"Transform",type:"encoder"},hh=function(e){function t(){return ot(this,t),pt(this,ct(t).call(this))}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return ch}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=e.getString();return cleanString=n.replace(/ /g,(function(e){return""})),new al(cleanString).getCodePoints()}},{key:"settingValueDidChange",value:function(e,t){}}]),t}(dc),dh={name:"book-cipher",title:"Book Cipher",category:"Ciphers",type:"encoder"},fh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"numbers",label:"Numbers (* for 1, 2, ...)",type:"text",value:"1 11 21 31 41",minLength:0,width:8},{name:"countIn",label:"Count In",type:"enum",value:"all",elements:["all","words","rows"],labels:["All text","Words","Rows"],width:4},{name:"removeSpaces",label:"Remove Spaces",type:"boolean",value:!0,trueLabel:"Yes",falseLabel:"No",width:5},{name:"removeSymbols",label:"Remove Punctuation",type:"boolean",value:!0,trueLabel:"Yes",falseLabel:"No",width:7},{name:"toCount",type:"enum",value:"letters",elements:["letters","words","rows"],labels:["Letters","Words","Rows"],width:4},{name:"toReturn",type:"enum",value:"letters",elements:["letters","words"],labels:["Letters","Words"],width:4},{name:"toTake",type:"enum",value:"all",elements:["all","first","last"],labels:["All","First","Last"],width:4},{name:"separator",label:"Separated by",type:"enum",value:" ",elements:[" ","\n",",",";","/"],labels:["Space","Newline","Comma","Semicolon","Slash"]}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return dh}}]),lt(t,[{key:"performTranslate",value:function(e,t){var r=this.getSettingValues(),i=r.toReturn,a=r.toCount,o=r.toTake,s=r.separator,l=r.countIn;if(this.getSettingValue("removeSymbols")&&(PunctuationDeletionEncoderInstance=new uh,e=new al(PunctuationDeletionEncoderInstance.performTranslate(e,!0))),this.getSettingValue("removeSpaces")){if("words"==i)throw Error("Cannot return words after having removed spaces...");if("words"==a)throw Error("Cannot count words after having removed spaces...");SpaceDeletionEncoderInstance=new hh,e=new al(SpaceDeletionEncoderInstance.performTranslate(e,!0))}string=e.getString(),"all"==l?inString=string:"words"==l?(string=string.replace("\n"," ").replace(" +"," "),countArray=string.split(" ")):"rows"==l&&(countArray=string.split("\n"));var u=this.getSettingValue("numbers")._string;"*"===u?("undefined"!=typeof countArray?len=countArray.length:len=inString.length,numbers=mt(Array(len).keys()).map((function(e){return e+1}))):(numbers=[],u.replace(/(\d+)/g,(function(e,t,n){(0===n||Xs.isWhitespace(u,n-1))&&(u.length===n+t.length||Xs.isWhitespace(u,n+t.length))&&numbers.push(parseInt(t))}))),console.log(numbers),outString="";for(var c=0;c<numbers.length;c++){if("all"!==l){if(c>=countArray.length)break;inString=countArray[c]}if("letters"==a?inArray=inString:"words"==a?(inString=inString.replace("\n"," ").replace(" +"," "),inArray=inString.split(" ")):"rows"==a&&(inArray=inString.split("\n")),n=numbers[c]-1,n>=inArray.length)break;piece=inArray[n],toSliceIndex={first:0,last:-1},"all"!==o?("letters"==i?pieceArray=piece:"words"==i&&(pieceArray=piece.split(" ")),outString+=pieceArray.slice(toSliceIndex[o])[0]+s):outString+=piece+s}return outChain=new al(outString),outChain.getCodePoints()}},{key:"settingValueDidChange",value:function(e,t){}}]),t}(dc);ze({target:"Array",proto:!0,forced:Eo!==[].lastIndexOf},{lastIndexOf:Eo});var gh=Se.f,ph=B.f,vh=R.f,yh=dn.trim,mh=c.Number,bh=mh.prototype,kh="Number"==b(Gn(bh)),wh=function(e){var t,n,r,i,a,o,s,l,u=I(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=yh(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=(a=u.slice(2)).length,s=0;s<o;s++)if((l=a.charCodeAt(s))<48||l>i)return NaN;return parseInt(a,r)}return+u};if(Pe("Number",!mh(" 0o1")||!mh("0b1")||mh("+0x1"))){for(var _h,Sh=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof Sh&&(kh?h((function(){bh.valueOf.call(n)})):"Number"!=b(n))?Ua(new mh(wh(t)),n,Sh):wh(t)},xh=d?gh(mh):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Ch=0;xh.length>Ch;Ch++)E(mh,_h=xh[Ch])&&!E(Sh,_h)&&vh(Sh,_h,ph(mh,_h));Sh.prototype=bh,bh.constructor=Sh,ae(c,"Number",Sh)}ze({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});var Ih={name:"bootstring",title:"Bootstring",category:"Encoding",type:"encoder"},Vh=2,Eh="Integer overflow: Input needs wider integers to process",Ah=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"basicRangeStart",label:"Basic Start",type:"number",value:0,integer:!0,rotate:!1,min:0,max:127-Vh,width:6,randomizable:!1},{name:"basicRangeEnd",label:"Basic End",type:"number",value:127,integer:!0,rotate:!1,min:Vh,max:1114111,width:6,randomizable:!1},{name:"digitMapping",type:"text",value:"abcdefghijklmnopqrstuvwxyz0123456789",uniqueChars:!0,minLength:2,caseSensitivity:!1,validateValue:e.validateDigitMappingValue.bind(gt(e)),randomizable:!1},{name:"delimiter",type:"text",value:"-",width:6,minLength:1,maxLength:1,caseSensitivity:!1,validateValue:e.validateDelimiterValue.bind(gt(e)),randomizable:!1},{name:"caseSensitivity",type:"boolean",value:!1,width:6,randomizable:!1},{name:"initialBias",type:"number",value:72,integer:!0,width:6,validateValue:e.validateInitialBiasValue.bind(gt(e)),randomizable:!1},{name:"initialN",type:"number",value:128,integer:!0,min:0,width:6,randomizable:!1},{name:"tmin",type:"number",value:1,integer:!0,rotate:!1,min:0,max:26,width:6,randomizable:!1},{name:"tmax",type:"number",value:26,integer:!0,rotate:!1,min:0,max:35,width:6,randomizable:!1},{name:"skew",type:"number",value:38,integer:!0,min:1,width:6,randomizable:!1},{name:"damp",type:"number",value:700,integer:!0,min:2,width:6,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Ih}}]),lt(t,[{key:"performEncode",value:function(e){var t=this.getSettingValues(),n=t.initialBias,r=t.initialN,i=t.tmin,a=t.tmax,o=t.caseSensitivity,s=this.getSettingValue("delimiter").getCodePointAt(0),l=this.getSettingValue("digitMapping").getLength();o||(e=e.toLowerCase());for(var u=e.getCodePoints(),c=u.length,h=r,d=n,f=0,g=[],p=0;p<u.length;p++)if(this._isBasic(u[p]))g.push(u[p]);else if(u[p]<h)throw new Js("Unexpected code point at index ".concat(p,", consider changing initial n ")+"to include this code point");var v,y,m,b,k,w=g.length,_=g.length;for(_>0&&g.push(s);w<c;){v=Number.MAX_SAFE_INTEGER;var S=!0,x=!1,C=void 0;try{for(var I,V=u[Symbol.iterator]();!(S=(I=V.next()).done);S=!0)(k=I.value)>=h&&k<v&&!this._isBasic(k)&&(v=k)}catch(e){x=!0,C=e}finally{try{S||null==V.return||V.return()}finally{if(x)throw C}}if(v-h>hc.div(Number.MAX_SAFE_INTEGER-f,w+1))throw new Js(Eh);f+=(v-h)*(w+1),h=v;var E=!0,A=!1,T=void 0;try{for(var M,L=u[Symbol.iterator]();!(E=(M=L.next()).done);E=!0){if(((k=M.value)<h||this._isBasic(k))&&++f>Number.MAX_SAFE_INTEGER)throw new Js(Eh);if(k===h){for(y=f,m=l;!(y<(b=this._calcT(m,d,i,a)));m+=l)g.push(this._basicCodePointFromDigit(b+hc.mod(y-b,l-b))),y=hc.div(y-b,l-b);g.push(this._basicCodePointFromDigit(y)),d=this._adaptBias(f,w+1,w===_),f=0,w++}}}catch(e){A=!0,T=e}finally{try{E||null==L.return||L.return()}finally{if(A)throw T}}f++,h++}return g}},{key:"performDecode",value:function(e){var t=this.getSettingValues(),n=t.initialBias,r=t.initialN,i=t.tmin,a=t.tmax,o=t.caseSensitivity,s=this.getSettingValue("delimiter").getCodePointAt(0),l=this.getSettingValue("digitMapping").getLength();o||(e=e.toLowerCase());for(var u=e.getCodePoints(),c=u.length,h=r,d=n,f=Math.max(u.lastIndexOf(s),0),g=[],p=0;p<f;p++){if(!this._isBasic(u[p]))throw new Js("Found unexpected non-basic code point at ".concat(p));g.push(u[p])}for(var v,y,m,b,k,w=0,_=f>0?f+1:0;_<c;){for(v=w,y=1,m=l;;m+=l){if(_>=c)throw new Js("The input ends unexpectedly");if(-1===(b=this._digitFromBasicCodePoint(u[_++])))throw new Js("Found unexpected non-basic code point at ".concat(_-1));if(b>hc.div(Number.MAX_SAFE_INTEGER-w,y))throw new Js(Eh);if(w+=b*y,b<(k=this._calcT(m,d,i,a)))break;if(y>hc.div(Number.MAX_SAFE_INTEGER,l-k))throw new Js(Eh);y*=l-k}if(d=this._adaptBias(w-v,g.length+1,0===v),hc.div(w,g.length+1)>Number.MAX_SAFE_INTEGER-h)throw new Js(Eh);if(h+=hc.div(w,g.length+1),w=hc.mod(w,g.length+1),this._isBasic(h))throw new Js("Unexpectedly unwrapped basic code point");g.splice(w,0,h),w++}return g}},{key:"_adaptBias",value:function(e,t,n){var r=this.getSettingValues(),i=r.digitMapping,a=r.tmin,o=r.tmax,s=r.skew,l=i.getLength();if(n){var u=this.getSettingValue("damp");e=hc.div(e,u)}else e=hc.div(e,2);e+=hc.div(e,t);for(var c=0;e>hc.div((l-a)*o,2);)e=hc.div(e,l-a),c+=l;return c+hc.div((l-a+1)*e,e+s)}},{key:"_calcT",value:function(e,t,n,r){return e<=t+n?n:e>=t+r?r:e-t}},{key:"_isBasic",value:function(e){var t=this.getSettingValues(),n=t.basicRangeStart,r=t.basicRangeEnd;return e>=n&&e<=r}},{key:"_digitFromBasicCodePoint",value:function(e){return this.getSettingValue("digitMapping").indexOfCodePoint(e)}},{key:"_basicCodePointFromDigit",value:function(e){return this.getSettingValue("digitMapping").getCodePointAt(e)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"basicRangeStart":this.getSetting("basicRangeEnd").setMin(e.getValue()+Vh),this.getSetting("digitMapping").revalidateValue(),this.getSetting("delimiter").revalidateValue();break;case"basicRangeEnd":this.getSetting("basicRangeStart").setMax(e.getValue()-Vh),this.getSetting("digitMapping").revalidateValue(),this.getSetting("delimiter").revalidateValue();break;case"digitMapping":var n=e.getValue().getLength();this.getSetting("tmax").setMax(n-1),this.getSetting("delimiter").revalidateValue(),this.getSetting("initialBias").revalidateValue();break;case"tmin":this.getSetting("initialBias").revalidateValue();break;case"tmax":this.getSetting("tmin").setMax(e.getValue());break;case"caseSensitivity":this.getSetting("digitMapping").setCaseSensitivity(t),this.getSetting("delimiter").setCaseSensitivity(t)}}},{key:"validateDigitMappingValue",value:function(e,t){if(!this.isSettingValid("basicRangeStart","basicRangeEnd"))return!1;var n=this.getSettingValue("basicRangeStart"),r=this.getSettingValue("basicRangeEnd"),i=e.getCodePoints().findIndex((function(e){return e<n||e>r}));return-1===i||{key:"bootstringDigitMappingInvalid",message:"Character at index ".concat(i," needs to be part of the given ")+"basic code point range"}}},{key:"validateDelimiterValue",value:function(e,t){if(!this.isSettingValid("basicRangeStart","basicRangeEnd","digitMapping"))return!1;var n=this.getSettingValues(),r=n.basicRangeStart,i=n.basicRangeEnd,a=n.digitMapping,o=e.getCodePointAt(0);return!(o<r||o>i||-1!==a.indexOfCodePoint(o))||{key:"bootstringDelimiterInvalid",message:"The value must be part of the basic code point range while not having a digit mapped to it"}}},{key:"validateInitialBiasValue",value:function(e,t){if(!this.isSettingValid("digitMapping","tmin"))return!1;var n=this.getSettingValue("digitMapping").getLength(),r=this.getSettingValue("tmin");return!(hc.mod(e,n)>n-r)||{key:"bootstringInitialBiasInvalid",message:"The value must be chosen such that initial_bias mod base <= base - tmin"}}}]),t}(dc),Th=function(e){function t(){return ot(this,t),pt(this,ct(t).apply(this,arguments))}return ut(t,e),lt(t,[{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("viewer"),e}},{key:"renderHeader",value:function(){var e=Jt.createElement("ul",{className:"brick__actions"},[Jt.createElement("li",{className:"brick__action-item"},[Jt.createElement("span",{className:"brick__action brick__action--active"},"View")])]),n=vt(ct(t.prototype),"renderHeader",this).call(this);return n.insertBefore(e,n.firstChild),n}}]),t}(Nu),Mh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._text="",e._disabled=!1,e._$textarea=null,e}return ut(t,e),lt(t,[{key:"getText",value:function(){return this._text}},{key:"setText",value:function(e){return this._text!==e&&(this._text=e,null!==this._$textarea&&(this._$textarea.value=e,this.layoutTextarea())),this}},{key:"isDisabled",value:function(){return this._disabled}},{key:"setDisabled",value:function(e){return this._disabled=e,null!==this._$textarea&&(e?this._$textarea.disabled="disabled":this._$textarea.removeAttribute("disabled")),this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("viewer-text"),e}},{key:"renderContent",value:function(){var e=this;this._$textarea=Jt.createElement("textarea",{className:"viewer-text__textarea",ariaLabel:"Content",spellcheck:!1,value:this._text,onInput:this.textareaValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}}),this.isDisabled()&&(this._$textarea.disabled="disabled");var n=vt(ct(t.prototype),"renderContent",this).call(this);return n.appendChild(this._$textarea),n}},{key:"textareaValueDidChange",value:function(e){if(this.isDisabled())return e.preventDefault(),!1;var t=this._$textarea.value;this._text!==t&&(this._text=t,this.getModel().viewTextDidChange(this,this._text),this.layoutTextarea())}},{key:"layout",value:function(){return this.layoutTextarea(),vt(ct(t.prototype),"layout",this).call(this)}},{key:"layoutTextarea",value:function(){return this._$textarea.style.height="",this._$textarea.style.height="".concat(this._$textarea.scrollHeight,"px"),this}},{key:"update",value:function(){var e=this.getModel().getError();return null!==e?this.updateStatus("error","Binary content can't be interpreted as text. Try switching to the bytes view. "+e.message):this.updateStatus(null)}}]),t}(Th),Lh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._queuedContent=null,e._error=null,e}return ut(t,e),lt(t,[{key:"view",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!((t=this.getSettingsForm().getInvalidFields()).length>0)){n.next=4;break}throw new Js("Can't view content with invalid settings: "+t.map((function(e){return e.getLabel()})).join(", "));case 4:if(this.hasView()){n.next=7;break}return this._queuedContent=e,n.abrupt("return");case 7:return n.next=9,regeneratorRuntime.awrap(this.willView(e));case 9:return e=n.sent,n.next=12,regeneratorRuntime.awrap(this.performView(e));case 12:return n.next=14,regeneratorRuntime.awrap(this.didView(e));case 14:null!==this._error&&(this._error=null,this.updateView()),n.next=22;break;case 17:throw n.prev=17,n.t0=n.catch(0),this._error=n.t0,this.updateView(),n.t0;case 22:case"end":return n.stop()}}),null,this,[[0,17]])}},{key:"willView",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}))}},{key:"performView",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"didView",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"dare",value:function(e){var t,n=arguments;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=n.length>1&&void 0!==n[1]&&n[1],r.prev=1,r.next=4,regeneratorRuntime.awrap(e());case 4:null!==this._error&&(this._error=null,this.updateView()),r.next=13;break;case 7:if(r.prev=7,r.t0=r.catch(1),this._error=r.t0,this.updateView(),!t&&r.t0 instanceof Js){r.next=13;break}throw r.t0;case 13:return r.abrupt("return",this);case 14:case"end":return r.stop()}}),null,this,[[1,7]])}},{key:"getError",value:function(){return this._error}},{key:"didCreateView",value:function(e){vt(ct(t.prototype),"didCreateView",this).call(this,e),null!==this._queuedContent&&(this.view(this._queuedContent),this._queuedContent=null)}},{key:"contentDidChange",value:function(e){this.hasPipe()&&this.getPipe().viewerContentDidChange(this,e)}}]),t}(uc),Ph={name:"bytes",title:"Bytes",category:"View",type:"viewer"},Bh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=Mh,e.addSettings([{name:"format",type:"enum",width:6,value:"hexadecimal",elements:["hexadecimal","binary"],labels:["Hexadecimal","Binary"],randomizable:!1},{name:"groupBits",label:"Group by",type:"enum",width:6,value:8,elements:[null,4,5,6,8,16,24,32],labels:["None","4 Bits","5 Bits","6 Bits","Byte","2 Bytes","3 Bytes","4 Bytes"],randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Ph}}]),lt(t,[{key:"performView",value:function(e){var t,n,r,i,a,o;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:t=e.getBytes(),n=this.getSettingValue("format"),s.t0=n,s.next="hexadecimal"===s.t0?5:"binary"===s.t0?8:10;break;case 5:return r=tl.hexStringFromBytes(t),i=4,s.abrupt("break",10);case 8:r=tl.binaryStringFromBytes(t),i=1;case 10:null!==(a=this.getSettingValue("groupBits"))&&(o=a/i,r=Xs.chunk(r,o).join(" ")),this.getView().setText(r);case 13:case"end":return s.stop()}}),null,this)}},{key:"viewTextDidChange",value:function(e,t){var n=this;this.dare((function(){var e,r=n.getSettingValue("format"),i=t;switch(i=i.replace(/\s/g,""),r){case"hexadecimal":e=tl.bytesFromHexString(i);break;case"binary":e=tl.bytesFromBinaryString(i)}n.contentDidChange(al.wrap(e))}))}},{key:"settingValueDidChange",value:function(e,t){if("groupBits"===e.getName()){var n=this.getSetting("format"),r=["binary"],i=["Binary"];null!==t&&t%4!=0||(r.push("hexadecimal"),i.push("Hexadecimal")),-1===r.indexOf(n.getValue())&&n.setValue(r[0]),n.setElements(r,i)}}}]),t}(Lh),zh=1..toFixed,Nh=Math.floor,Rh=function(e,t,n){return 0===t?n:t%2==1?Rh(e,t-1,n*e):Rh(e*e,t/2,n)},Oh=zh&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!h((function(){zh.call({})}));function Fh(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}function Dh(e,t,n){for(var r=0;r<n.length;r++)e[r]=Fh(e[r]);var i=function(e,t,n){for(var r=[],i=0;i<n.length;i++)r.push([i,$h(e[i],t)]);return r}(e,t,n);i.sort((function(e,t){return e[1]!=t[1]?e[1]-t[1]:e[0]-t[0]})),div=document.getElementById("crack-results"),div.innerHTML='\n\t<table>\n\t<thead>\n\t\t<tr>\n\t\t\t<th>Shift</th>\n\t\t\t<th colspan="2">Entropy per letter (bits) <span style="font-weight:normal">(lower is better)</span></th>\n\t\t\t<th colspan="2">Beginning of deciphered text </th>\n\t\t</tr>\n\t</thead>\n\t<tbody id="guesses"></tbody>\n\t</table>\n\t<table><tbody style="text-align: center"><tr><td>To change the shift, say \'No\' to Need Crack</td></tr></tbody></table>\n\t';var a=document.getElementById("guesses");return i.forEach((function(t,n){maxEntropy=i[i.length-1][1],minEntropy=i[0][1];var r=a.appendChild(document.createElement("tr"));0==n&&r.classList.add("active");var o=r.appendChild(document.createElement("td"));o.textContent=t[0].toString(),(o=r.appendChild(document.createElement("td"))).textContent=t[1].toFixed(3);var s=(o=r.appendChild(document.createElement("td"))).appendChild(document.createElement("div"));s.classList.add("bar"),s.style.width=(t[1]/maxEntropy*10+1).toFixed(6)+"em",(o=r.appendChild(document.createElement("td"))).textContent=e[t[0]]})),i[0][0]}ze({target:"Number",proto:!0,forced:Oh},{toFixed:function(e){var t,n,r,i,a=function(e){if("number"!=typeof e&&"Number"!=b(e))throw TypeError("Incorrect invocation");return+e}(this),o=he(e),s=[0,0,0,0,0,0],l="",u="0",c=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*s[n],s[n]=r%1e7,r=Nh(r/1e7)},h=function(e){for(var t=6,n=0;--t>=0;)n+=s[t],s[t]=Nh(n/e),n=n%e*1e7},d=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);t=""===t?n:t+Is.call("0",7-n.length)+n}return t};if(o<0||o>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(l="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*Rh(2,69,1))-69)<0?a*Rh(2,-t,1):a/Rh(2,t,1),n*=4503599627370496,(t=52-t)>0){for(c(0,n),r=o;r>=7;)c(1e7,0),r-=7;for(c(Rh(10,r,1),0),r=t-1;r>=23;)h(1<<23),r-=23;h(1<<r),c(1,1),h(2),u=d()}else c(0,n),c(1<<-t,0),u=d()+Is.call("0",o);return u=o>0?l+((i=u.length)<=o?"0."+Is.call("0",o-i)+u:u.slice(0,i-o)+"."+u.slice(i-o)):l+u}});var jh={a:.08167,b:.01492,c:.02782,d:.04253,e:.12702,f:.02228,g:.02015,h:.06094,i:.06966,j:.00153,k:.00772,l:.04025,m:.02406,n:.06749,o:.07507,p:.01929,q:95e-5,r:.05987,s:.06327,t:.09056,u:.02758,v:.00978,w:.0236,x:.0015,y:.01974,z:74e-5},qh={a:.1174,b:.0092,c:.045,d:.0373,e:.1179,f:.0095,g:.0164,h:.0154,i:.1128,l:.0651,m:.0251,n:.0688,o:.0983,p:.0305,q:.0051,r:.0637,s:.0498,t:.0562,u:.0301,v:.021,z:.0049};function $h(e,t,n){var r=0,i=0;if("english"==t)var a=jh;else if("italian"==t)a=qh;for(var o=0;o<e.length;o++){var s=a[e[o].toLowerCase()];void 0!==s?r+=Math.log(s):i++}return-r/Math.log(2)/(e.length-i)}var Uh={name:"crackSetting",label:"Crack",type:"enum",value:"no",elements:["no","english","italian"],labels:["No","from english","from italian"],width:8,randomizable:!1},Wh={name:"caesar-cipher",title:"Caesar cipher",category:"Ciphers",type:"encoder"},Hh="abcdefghijklmnopqrstuvwxyz",Gh=7,Kh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"shift",type:"number",label:"Shift",priority:10,value:Gh,integer:!0,describeValue:e.describeShiftValue.bind(gt(e)),randomizeValue:e.randomizeShiftValue.bind(gt(e))},{name:"language",label:"Ciphertext Alphabet",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],blackChoiceList:[],width:8,randomizable:!1},{name:"alphabet",type:"text",value:Hh,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!0,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}].concat(Uh)),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Wh}}]),lt(t,[{key:"_performTranslate",value:function(e,t,n){var r,i,a=this.getSettingValues(),o=a.caseStrategy,s=a.includeForeignChars,l=this.getSettingValue("alphabet");"strict"!==o&&(r=(l=l.toLowerCase()).toUpperCase()),i=null==n?this.getSettingValue("shift"):n;for(var u,c,h,d,f=l.getLength(),g=e.getLength(),p=new Array(g),v=0,y=0;y<g;y++)u=e.getCodePointAt(y),d=!1,-1===(c=l.indexOfCodePoint(u))&&"strict"!==o&&(c=r.indexOfCodePoint(u),d=!0),-1===c?s&&(p[v++]=u):(h=hc.mod(c+i*(t?1:-1),f),p[v++]="maintain"===o&&d?r.getCodePointAt(h):l.getCodePointAt(h));return p.slice(0,v)}},{key:"performTranslate",value:function(e,t){var n=this.getSetting(Uh.name);if(!t&null==n?this.addSetting(Uh):t&null!==n&&this.removeSetting(n),t){if("undefined"!=typeof document){document.getElementById("crack-results").innerHTML="";var r=document.getElementById("bouncing-arrow");null!==r&&(r.style.visibility="hidden")}}else{var i=this.getSettingValue(Uh.name);if("no"!=i){for(var a=i,o={},s=this.getSettingValue("alphabet")._string,l=0;l<s.length;l++)o[l]=this._performTranslate(e,t,l).slice(0,40);bestShift=Dh(o,a,s),this.setSettingValue("shift",bestShift)}}return this._performTranslate(e,t)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t);break;case"alphabet":this.getSetting("shift").setNeedsValueDescriptionUpdate(),t!=Hh&&"abcdefghilmnopqrstuvz"!=t&&this.setSettingValue("language","other");break;case"language":"english"==t?this.setSettingValue("alphabet",Hh):"italian"==t&&this.setSettingValue("alphabet","abcdefghilmnopqrstuvz"),this.getSetting("shift").setNeedsValueDescriptionUpdate();break;case Uh.name:if("no"!=t){var n=document.getElementById("bouncing-arrow");if(null==n){var r=document.getElementsByClassName("pipe__scrollable")[0];(n=document.createElement("div")).classList.add("arrow","bounce"),n.id="bouncing-arrow",n.style.visibility="visible",r.appendChild(n)}else n.style.visibility="visible"}else{document.getElementById("crack-results").innerHTML="";var i=document.getElementById("bouncing-arrow");null!==i&&(i.style.visibility="hidden")}}}},{key:"randomizeShiftValue",value:function(e,t){var n=this.getSetting("alphabet");return n.isValid()?e.nextInteger(1,n.getValue().getLength()-1):null}},{key:"describeShiftValue",value:function(e,t){if(!this.getSetting("alphabet").isValid())return null;var n=this.getSettingValues(),r=n.alphabet,i=n.shift,a=r.getCharAt(0),o=hc.mod(i,r.getLength()),s=r.getCharAt(o);return"".concat(a,"→").concat(s)}}]),t}(dc),Zh={name:"case-transform",title:"Case transform",category:"Transform",type:"encoder"},Xh=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSetting({name:"case",type:"enum",value:"lower",elements:["lower","upper","capitalize","alternating","inverse"],labels:["Lower case","Upper case","Capitalize","Alternating case","Inverse case"],randomizable:!1,style:"radio"}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Zh}}]),lt(t,[{key:"performEncode",value:function(e){switch(this.getSettingValue("case")){case"lower":return e.toLowerCase();case"upper":return e.toUpperCase();case"capitalize":return al.wrap(e.getString().replace(/[0-9A-Z_a-z](?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})));case"alternating":return al.wrap(e.getChars().map((function(e,t){return t%2==0?e.toLowerCase():e.toUpperCase()})).join(""));case"inverse":return this._inverseCase(e);default:return e}}},{key:"performDecode",value:function(e){switch(this.getSettingValue("case")){case"inverse":return this._inverseCase(e);default:return e}}},{key:"_inverseCase",value:function(e){return al.wrap(e.getChars().map((function(e){var t=e.toLowerCase();return e!==t?t:e.toUpperCase()})).join(""))}}]),t}(dc),Yh={name:"chemical-elements",title:"Chemical elements",category:"Encoding",type:"encoder"},Jh=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts","Og"],Qh=["Hydrogen","Helium","Lithium","Beryllium","Boron","Carbon","Nitrogen","Oxygen","Fluorine","Neon","Sodium","Magnesium","Aluminium","Silicon","Phosphorus","Sulfur","Chlorine","Argon","Potassium","Calcium","Scandium","Titanium","Vanadium","Chromium","Manganese","Iron","Cobalt","Nickel","Copper","Zinc","Gallium","Germanium","Arsenic","Selenium","Bromine","Krypton","Rubidium","Strontium","Yttrium","Zirconium","Niobium","Molybdenum","Technetium","Ruthenium","Rhodium","Palladium","Silver","Cadmium","Indium","Tin","Antimony","Tellurium","Iodine","Xenon","Caesium","Barium","Lanthanum","Cerium","Praseodymium","Neodymium","Promethium","Samarium","Europium","Gadolinium","Terbium","Dysprosium","Holmium","Erbium","Thulium","Ytterbium","Lutetium","Hafnium","Tantalum","Tungsten","Rhenium","Osmium","Iridium","Platinum","Gold","Mercury","Thallium","Lead","Bismuth","Polonium","Astatine","Radon","Francium","Radium","Actinium","Thorium","Protactinium","Uranium","Neptunium","Plutonium","Americium","Curium","Berkelium","Californium","Einsteinium","Fermium","Mendelevium","Nobelium","Lawrencium","Rutherfordium","Dubnium","Seaborgium","Bohrium","Hassium","Meitnerium","Darmstadtium","Roentgenium","Copernicium","Nihonium","Flerovium","Moscovium","Livermorium","Tennessine","Oganesson"],ed=["Idrogeno","Elio","Litio","Berillio","Boro","Carbonio","Azoto","Ossigeno","Fluoro","Neon","Sodio","Magnesio","Alluminio","Silicio","Fosforo","Zolfo","Cloro","Argon","Potassio","Calcio","Scandio","Titanio","Vanadio","Cromo","Manganese","Ferro","Cobalto","Nichel","Rame","Zinco","Gallio","Germanio","Arsenico","Selenio","Bromo","Kripton","Rubidio","Stronzio","Ittrio","Zirconio","Niobio","Molibdeno","Tecnezio","Rutenio","Rodio","Palladio","Argento","Cadmio","Indio","Stagno","Antimonio","Tellurio","Iodio","Xeno","Cesio","Bario","Lantanio","Cerio","Praseodimio","Neodimio","Promezio","Samario","Europio","Gadolinio","Terbio","Disprosio","Olmio","Erbio","Tulio","Itterbio","Lutezio","Afnio","Tantalio","Tungsteno","Renio","Osmio","Iridio","Platino","Oro","Mercurio","Tallio","Piombo","Bismuto","Polonio","Astato","Radon","Francio","Radio","Attinio","Torio","Protoattinio","Uranio","Nettunio","Plutonio","Americio","Curio","Berkelio","Californio","Einsteinio","Fermio","Mendelevio","Nobelio","Laurenzio","Rutherfordio","Dubnio","Seaborgio","Bohrio","Hassio","Meitnerio","Darmstadtio","Roentgenio","Copernicio","Nihonio","Flerovio","Moscovio","Livermorio","Tennesso","Oganesson"],td=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"toReturn",label:"return",type:"enum",value:"symbols",elements:["symbols","englishNames","italianNames"],labels:["Symbols","English names","Italian names"],width:8,randomizable:!1},{name:"separator",label:"separator",type:"enum",value:"",elements:[""," ",",","/"],labels:["Nothing","Space","Comma","Slash"],width:8,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Yh}}]),lt(t,[{key:"performTranslate",value:function(e,t){contentString=e.getString(),numbers=[],outString="";var n=this.getSettingValues(),r=n.toReturn,i=n.separator;return contentString.replace(/(\d+|[a-zA-Z]+)/g,(function(e){e.replace(/\d+/g,(function(e){number=parseInt(e),0!=number&&("symbols"===r?chemElement=Jh[number-1]:"englishNames"===r?chemElement=Qh[number]:"italianNames"===r&&(chemElement=ed[number]),outString+=chemElement+i)})),e.replace(/[a-zA-Z]+/g,(function(e){outString+=e+i}))})),outChain=new al(outString),outChain.getCodePoints()}}]),t}(dc),nd=Bo.left;ze({target:"Array",proto:!0,forced:Ze("reduce")},{reduce:function(e){return nd(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var rd=dn.trim;ze({target:"String",proto:!0,forced:function(e){return h((function(){return!!sn[e]()||"​᠎"!="​᠎"[e]()||sn[e].name!==e}))}("trim")},{trim:function(){return rd(this)}});var id={name:"enigma",title:"Enigma machine",category:"Ciphers",type:"encoder"},ad="abcdefghijklmnopqrstuvwxyz",od=[{name:"I",label:"Enigma I",description:"German Army & Air Force",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-A","UKW-B","UKW-C"],reflectorThumbwheel:!1,slots:[{rotors:["I","II","III","IV","V"]},{rotors:["I","II","III","IV","V"]},{rotors:["I","II","III","IV","V"]}]},{name:"N",label:'Enigma I "Norenigma"',description:"Norwegian Police Security Service",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-N"],reflectorThumbwheel:!1,slots:[{rotors:["I-N","II-N","III-N","IV-N","V-N"]},{rotors:["I-N","II-N","III-N","IV-N","V-N"]},{rotors:["I-N","II-N","III-N","IV-N","V-N"]}]},{name:"S",label:'Enigma I "Sondermaschine"',description:"German Intelligence",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-S"],reflectorThumbwheel:!1,slots:[{rotors:["I-S","II-S","III-S"]},{rotors:["I-S","II-S","III-S"]},{rotors:["I-S","II-S","III-S"]}]},{name:"M3",label:"Enigma M3",description:"German Army & Navy",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-B","UKW-C"],reflectorThumbwheel:!1,slots:[{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]}]},{name:"M4",label:'Enigma M4 "Shark"',description:"German Submarines",characterGroupSize:4,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-B-thin","UKW-C-thin"],reflectorThumbwheel:!1,slots:[{rotors:["beta","gamma"],rotating:!1},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]}]},{name:"D",label:"Enigma D / K",description:"Commercial Enigma",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,slots:[{rotors:["I-D","II-D","III-D"]},{rotors:["I-D","II-D","III-D"]},{rotors:["I-D","II-D","III-D"]}]},{name:"T",label:'Enigma T "Tirpitz"',description:"Japanese Army",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-T",reflectorRotors:["UKW-T"],reflectorThumbwheel:!0,slots:[{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]},{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]},{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]}]},{name:"KS",label:"Swiss-K",description:"Swiss Army & Air Force",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,slots:[{rotors:["I-KS","II-KS","III-KS"]},{rotors:["I-KS","II-KS","III-KS"]},{rotors:["I-KS","II-KS","III-KS"]}]},{name:"KR",label:'Railway Enigma "Rocket I"',description:"German Railway",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-KR"],reflectorThumbwheel:!0,slots:[{rotors:["I-KR","II-KR","III-KR"]},{rotors:["I-KR","II-KR","III-KR"]},{rotors:["I-KR","II-KR","III-KR"]}]},{name:"Z",label:"Zählwerk Enigma A-865",description:null,characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-Z","II-Z","III-Z"]},{rotors:["I-Z","II-Z","III-Z"]},{rotors:["I-Z","II-Z","III-Z"]}]},{name:"G111",label:"Abwehr Enigma G-111",description:null,characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G111","II-G111","V-G111"]},{rotors:["I-G111","II-G111","V-G111"]},{rotors:["I-G111","II-G111","V-G111"]}]},{name:"G312",label:"Abwehr Enigma G-312",description:"German Seret Service",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-G312"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G312","II-G312","III-G312"]},{rotors:["I-G312","II-G312","III-G312"]},{rotors:["I-G312","II-G312","III-G312"]}]},{name:"G260",label:"Abwehr Enigma G-260",description:"German Seret Service in Argentina",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G260","II-G260","III-G260"]},{rotors:["I-G260","II-G260","III-G260"]},{rotors:["I-G260","II-G260","III-G260"]}]}],sd=["name","label","wiring","turnovers"],ld=["ETW-ABCDEF","Alphabet","abcdefghijklmnopqrstuvwxyz","","ETW-QWERTZ","Keyboard","jwulcmnohpqzyxiradkegvbtsf","","I","I","ekmflgdqvzntowyhxuspaibrcj","q","II","II","ajdksiruxblhwtmcqgznpyfvoe","e","III","III","bdfhjlcprtxvznyeiwgakmusqo","v","IV","IV","esovpzjayquirhxlnftgkdcmwb","j","V","V","vzbrgityupsdnhlxawmjqofeck","z","VI","VI","jpgvoumfyqbenhzrdkasxlictw","zm","VII","VII","nzjhgrcxmyswboufaivlpekqdt","zm","VIII","VIII","fkqhtlxocbjspdzramewniuygv","zm","beta","Beta","leyjvcnixwpbqmdrtakzgfuhos","","gamma","Gamma","fsokanuerhmbtiycwlqpzxvgjd","","UKW-A","UKW A","ejmzalyxvbwfcrquontspikhgd","","UKW-B","UKW B","yruhqsldpxngokmiebfzcwvjat","","UKW-C","UKW C","fvpjiaoyedrzxwgctkuqsbnmhl","","UKW-B-thin","UKW B thin","enkqauywjicopblmdxzvfthrgs","","UKW-C-thin","UKW C thin","rdobjntkvehmlfcwzaxgyipsuq","","I-N","I","wtokasuyvrbxjhqcpzefmdinlg","q","II-N","II","gjlpubswemctqvhxaofzdrkyni","e","III-N","III","jwfmhnbpusdytixvzgrqlaoekc","v","IV-N","IV","esovpzjayquirhxlnftgkdcmwb","j","V-N","V","hejxqotzbvfdascilwpgynmurk","z","UKW-N","UKW","mowjypuxndsraibfvlkzgqchet","","I-S","I","veosirzujdqckgwypnxaflthmb","q","II-S","II","uemoatqlshpkcyfwjzbgvxindr","e","III-S","III","tzhxmbsipnurjfdkeqvcwglaoy","v","UKW-S","UKW","ciagsndrbytpzfulvhekoqxwjm","","I-D","I","lpgszmhaeoqkvxrfybutnicjdw","y","II-D","II","slvgbtfxjqohewirzyamkpcndu","e","III-D","III","cjgdpshkturawzxfmynqobvlie","n","UKW-COM","UKW","imetcgfraysqbzxwlhkdvupojn","","ETW-T","ETW","ilxrztkgjyamwvdufcpqeonshb","","I-T","I","kptyuelocvgrfqdanjmbswhzxi","wzekq","II-T","II","uphzlweqmtdjxcaksoigvbyfnr","wzflr","III-T","III","qudlyrfekonvzaxwhmgpjbsict","wzekq","IV-T","IV","ciwtbkxnrespflydagvhquojzm","wzflr","V-T","V","uaxgisnjbverdylfzwtpckohmq","ycfkr","VI-T","VI","xfuzgalvhcnysewqtdmrbkpioj","xeimq","VII-T","VII","bjvftxplnayozikwgdqeruchsm","ycfkr","VIII-T","VIII","ymtpnzhwkodajxeluqvgcbisfr","xeimq","UKW-T","UKW","gekpbtaumocniljdxzyfhwvqsr","","I-KS","I","pezuohxscvfmtbglrinqjwaydk","y","II-KS","II","zouesydkfwpciqxhmvblgnjrat","e","III-KS","III","ehrvxgaobqusimzflynwktpdjc","n","I-KR","I","jgdqoxuscamifrvtpnewkblzyh","n","II-KR","II","ntzpsfbokmwrcjdivlaeyuxhgq","e","III-KR","III","jviubhtcdyakeqzposgxnrmwfl","y","UKW-KR","UKW","qyhognecvpuztfdjaxwmkisrbl","","I-Z","I","lpgszmhaeoqkvxrfybutnicjdw","suvwzabcefgiklopq","II-Z","II","slvgbtfxjqohewirzyamkpcndu","stvyzacdfghkmnq","III-Z","III","cjgdpshkturawzxfmynqobvlie","uwxaefhkmnr","I-G111","I","wlrhbqundkjczsexotmagyfpvi","suvwzabcefgiklopq","II-G111","II","tfjqazwmhlcuixrdygoevbnskp","stvyzacdfghkmnq","V-G111","V","qtpixwvdfrmusljohcanezkybg","swzfhmq","I-G312","I","dmtwsilruyqnkfejcazbpgxohv","suvwzabcefgiklopq","II-G312","II","hqzgpjtmoblncifdyawveusrkx","stvyzacdfghkmnq","III-G312","III","uqntlszfmrehdpxkibvygjcwoa","uwxaefhkmnr","UKW-G312","UKW","rulqmzjsygocetkwdahnbxpvif","","I-G260","I","rcspblkqaumhwytifzvgojnexd","suvwzabcefgiklopq","II-G260","II","wcmibvpjxarosgndlzkeyhufqt","stvyzacdfghkmnq","III-G260","III","fvdhzelsqmaxokyiwpgcbujtnr","uwxaefhkmnr"],ud=null,cd=null,hd=function(e){function t(){var e;ot(this,t),e=pt(this,ct(t).call(this));var n=t.getModel("M3"),r=t.getRotors(n.slots[0].rotors),i=r.map((function(e){return e.name})),a=r.map((function(e){return e.label})),o=t.getRotors(n.reflectorRotors);e.addSetting({name:"model",type:"enum",value:n.name,elements:od.map((function(e){return e.name})),labels:od.map((function(e){return e.label})),descriptions:od.map((function(e){return e.description})),randomizable:!1}),e.addSetting({name:"reflector",type:"enum",value:o[0].name,elements:o.map((function(e){return e.name})),labels:o.map((function(e){return e.label})),width:4}),e.addSetting({name:"positionReflector",label:"Position",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(gt(e)),width:4}),e.addSetting({name:"ringReflector",label:"Ring",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(gt(e)),width:4});for(var s=0;s<t.getMaxSlotCount();s++)e.addSetting({name:"rotor".concat(s+1),label:"Rotor ".concat(s+1),type:"enum",value:i[0],elements:i,labels:a,randomizable:!1,width:4}),e.addSetting({name:"position".concat(s+1),label:"Position",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(gt(e)),width:4}),e.addSetting({name:"ring".concat(s+1),label:"Ring",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(gt(e)),width:4});return e.addSetting({name:"plugboard",type:"text",value:"",caseSensitivity:!1,validateValue:e.validatePlugboardValue.bind(gt(e)),filterValue:function(e){return e.getString().trim().toLowerCase()},randomizeValue:e.randomizePlugboardValue.bind(gt(e))}),e.addSetting({name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!1,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}),e.applyModel(n.name),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return id}}]),lt(t,[{key:"settingValueDidChange",value:function(e,n){vt(ct(t.prototype),"settingValueDidChange",this).call(this,e,n),"model"===e.getName()&&this.applyModel(n)}},{key:"applyModel",value:function(e){for(var n=t.getModel(e),r=t.getMaxSlotCount(),i=0;i<r;i++){var a=i<n.slots.length?n.slots[i]:null,o=null!==a,s=this.getSetting("rotor".concat(i+1)),l=this.getSetting("ring".concat(i+1)),u=this.getSetting("position".concat(i+1));if(s.setVisible(o),l.setVisible(o),u.setVisible(o),o){var c=t.getRotors(a.rotors);s.setElements(c.map((function(e){return e.name})),c.map((function(e){return e.label})),null,!1),!0!==s.validateValue(s.getValue())&&s.setValue(c[0].name)}}var h=t.getRotors(n.reflectorRotors),d=this.getSetting("reflector");d.setElements(h.map((function(e){return e.name})),h.map((function(e){return e.label})),null,!1),!0!==d.validateValue(d.getValue())&&d.setValue(h[0].name),d.setWidth(n.reflectorThumbwheel?4:12),d.setVisible(n.reflectorThumbwheel||h.length>1),this.getSetting("positionReflector").setVisible(n.reflectorThumbwheel),this.getSetting("ringReflector").setVisible(n.reflectorThumbwheel),this.getSetting("plugboard").setVisible(n.plugboard)}},{key:"performTranslate",value:function(e,n){var r=this.getSettingValue("includeForeignChars"),i=t.getModel(this.getSettingValue("model")),a=0,o=i.slots,s=[],l=[],u=[];for(a=0;a<o.length;a++){var c=this.getSettingValue("rotor".concat(a+1));s.push(t.getRotor(c)),l.push(this.getSettingValue("position".concat(a+1))-1),u.push(this.getSettingValue("ring".concat(a+1))-1)}var h=t.getRotor(i.entryRotor),d=t.getRotor(this.getSettingValue("reflector")),f=i.reflectorThumbwheel?this.getSettingValue("positionReflector"):0,g=i.reflectorThumbwheel?this.getSettingValue("ringReflector"):0,p=null;if(i.plugboard){var v=this.getSettingValue("plugboard");p=this.wiringFromPlugboardValue(v.toString())}var y=t.rotorMapChar,m=e.getCodePoints().map((function(e,n){var c=null;if(e>=65&&e<=90)c=e-65;else{if(!(e>=97&&e<=122))return!!r&&e;c=e-97}if("cog"===i.turnoverMechanism){var v=!0;for(a=o.length-1;v&&a>=0;)!1!==o[a].rotating?(v=t.rotorAtTurnover(s[a],l[a]),l[a]++):v=!1,a--;v&&!0===i.reflectorRotating&&f++}else{var m=!1;for(a=1;!m&&a<o.length;)(m=t.rotorAtTurnover(s[a],l[a]))&&(a!==o.length-1&&l[a]++,!1!==o[a-1].rotating&&l[a-1]++),a++;l[l.length-1]++}for(null!==p&&(c=y(c,p,0,0,!1)),c=y(c,h,0,0,!1),a=s.length-1;a>=0;a--)c=y(c,s[a],l[a],u[a],!1);for(c=y(c,d,f,g,!1),a=0;a<s.length;a++)c=y(c,s[a],l[a],u[a],!0);return c=y(c,h,0,0,!0),null!==p&&(c=y(c,p,0,0,!0)),c+97}));if(!r){var b=[];m.forEach((function(e){!1!==e&&((b.length+1)%(i.characterGroupSize+1)==0&&b.push(32),b.push(e))})),m=b}return m}},{key:"describePositionValue",value:function(e,t){return ad[e-1].toUpperCase()}},{key:"validatePlugboardValue",value:function(e,t){var n=e.getString();return""===n||(null===n.match(/^([a-z]{2}\s)*([a-z]{2})$/)?{key:"enigmaPlugboardInvalidFormat",message:"Invalid plugboard format: pairs of letters to be swapped expected (e.g. 'ab cd ef')"}:!!Ss.isUnique(n.replace(/\s/g,"").split(""))||{key:"enigmaPlugboardPairsNotUnique",message:"Pairs of letters to be swapped need to be unique"})}},{key:"wiringFromPlugboardValue",value:function(e){var t=ad.split("");return e.split(" ").forEach((function(e){t[e.charCodeAt(0)-97]=e[1],t[e.charCodeAt(1)-97]=e[0]})),t.join("")}},{key:"isRandomizable",value:function(){return!0}},{key:"randomize",value:function(){var e,n,r,i=t.getModel(this.getSettingValue("model")),a=i.reflectorRotors;for(e=0;e<i.slots.length;e++)a=a.concat(i.slots[e].rotors);for(a=Ss.unique(a),-1!==(n=(a=Ss.shuffle(a)).findIndex((function(e){return-1!==i.reflectorRotors.indexOf(e)})))&&(r=a.splice(n,1)[0],this.setSettingValue("reflector",r)),e=0;e<i.slots.length;e++)-1!==(n=a.findIndex((function(t){return-1!==i.slots[e].rotors.indexOf(t)})))&&(r=a.splice(n,1)[0],this.setSettingValue("rotor".concat(e+1),r));return vt(ct(t.prototype),"randomize",this).call(this),this}},{key:"randomizePlugboardValue",value:function(e,t){var n=Ss.shuffle(ad.split(""),e).join("").substr(0,20);return Xs.chunk(n,2).join(" ")}}],[{key:"rotorAtTurnover",value:function(e,t){if(void 0===e.turnovers)return!1;var n=String.fromCharCode(97+hc.mod(t,26));return-1!==e.turnovers.indexOf(n)}},{key:"rotorMapChar",value:function(e,t,n,r,i){var a="string"==typeof t?t:t.wiring;return n=hc.mod(n-r,26),e=hc.mod(e+n,26),e=i?a.indexOf(String.fromCharCode(97+e)):a.charCodeAt(e)-97,e=hc.mod(e-n,26)}},{key:"getModel",value:function(e){return null===ud&&(ud={},od.forEach((function(e){ud[e.name]=e}))),ud[e]||null}},{key:"getMaxSlotCount",value:function(){return od.reduce((function(e,t){return Math.max(e,t.slots.length)}),0)}},{key:"getRotor",value:function(e){var t,n,r;if(null===cd)for(cd={},t=0;t<ld.length;t+=sd.length){for(r={},n=0;n<sd.length;n++)r[sd[n]]=ld[t+n];cd[r.name]=r}return cd[e]||null}},{key:"getRotors",value:function(e){return e.map((function(e){return t.getRotor(e)}))}}]),t}(dc),dd=1732584193,fd=4023233417,gd=2562383102,pd=271733878,vd=7,yd=12,md=17,bd=22,kd=5,wd=9,_d=14,Sd=20,xd=4,Cd=11,Id=16,Vd=23,Ed=6,Ad=10,Td=15,Md=21;function Ld(e,t){var n=yt(e,4),r=n[0],i=n[1],a=n[2],o=n[3];r=zd(r,i,a,o,t[0],vd,3614090360),o=zd(o,r,i,a,t[1],yd,3905402710),a=zd(a,o,r,i,t[2],md,606105819),i=zd(i,a,o,r,t[3],bd,3250441966),r=zd(r,i,a,o,t[4],vd,4118548399),o=zd(o,r,i,a,t[5],yd,1200080426),a=zd(a,o,r,i,t[6],md,2821735955),i=zd(i,a,o,r,t[7],bd,4249261313),r=zd(r,i,a,o,t[8],vd,1770035416),o=zd(o,r,i,a,t[9],yd,2336552879),a=zd(a,o,r,i,t[10],md,4294925233),i=zd(i,a,o,r,t[11],bd,2304563134),r=zd(r,i,a,o,t[12],vd,1804603682),o=zd(o,r,i,a,t[13],yd,4254626195),a=zd(a,o,r,i,t[14],md,2792965006),r=Nd(r,i=zd(i,a,o,r,t[15],bd,1236535329),a,o,t[1],kd,4129170786),o=Nd(o,r,i,a,t[6],wd,3225465664),a=Nd(a,o,r,i,t[11],_d,643717713),i=Nd(i,a,o,r,t[0],Sd,3921069994),r=Nd(r,i,a,o,t[5],kd,3593408605),o=Nd(o,r,i,a,t[10],wd,38016083),a=Nd(a,o,r,i,t[15],_d,3634488961),i=Nd(i,a,o,r,t[4],Sd,3889429448),r=Nd(r,i,a,o,t[9],kd,568446438),o=Nd(o,r,i,a,t[14],wd,3275163606),a=Nd(a,o,r,i,t[3],_d,4107603335),i=Nd(i,a,o,r,t[8],Sd,1163531501),r=Nd(r,i,a,o,t[13],kd,2850285829),o=Nd(o,r,i,a,t[2],wd,4243563512),a=Nd(a,o,r,i,t[7],_d,1735328473),r=Rd(r,i=Nd(i,a,o,r,t[12],Sd,2368359562),a,o,t[5],xd,4294588738),o=Rd(o,r,i,a,t[8],Cd,2272392833),a=Rd(a,o,r,i,t[11],Id,1839030562),i=Rd(i,a,o,r,t[14],Vd,4259657740),r=Rd(r,i,a,o,t[1],xd,2763975236),o=Rd(o,r,i,a,t[4],Cd,1272893353),a=Rd(a,o,r,i,t[7],Id,4139469664),i=Rd(i,a,o,r,t[10],Vd,3200236656),r=Rd(r,i,a,o,t[13],xd,681279174),o=Rd(o,r,i,a,t[0],Cd,3936430074),a=Rd(a,o,r,i,t[3],Id,3572445317),i=Rd(i,a,o,r,t[6],Vd,76029189),r=Rd(r,i,a,o,t[9],xd,3654602809),o=Rd(o,r,i,a,t[12],Cd,3873151461),a=Rd(a,o,r,i,t[15],Id,530742520),r=Od(r,i=Rd(i,a,o,r,t[2],Vd,3299628645),a,o,t[0],Ed,4096336452),o=Od(o,r,i,a,t[7],Ad,1126891415),a=Od(a,o,r,i,t[14],Td,2878612391),i=Od(i,a,o,r,t[5],Md,4237533241),r=Od(r,i,a,o,t[12],Ed,1700485571),o=Od(o,r,i,a,t[3],Ad,2399980690),a=Od(a,o,r,i,t[10],Td,4293915773),i=Od(i,a,o,r,t[1],Md,2240044497),r=Od(r,i,a,o,t[8],Ed,1873313359),o=Od(o,r,i,a,t[15],Ad,4264355552),a=Od(a,o,r,i,t[6],Td,2734768916),i=Od(i,a,o,r,t[13],Md,1309151649),r=Od(r,i,a,o,t[4],Ed,4149444226),o=Od(o,r,i,a,t[11],Ad,3174756917),a=Od(a,o,r,i,t[2],Td,718787259),i=Od(i,a,o,r,t[9],Md,3951481745),e[0]=Pd(r,e[0]),e[1]=Pd(i,e[1]),e[2]=Pd(a,e[2]),e[3]=Pd(o,e[3])}function Pd(e,t){return e+t&4294967295}function Bd(e,t,n,r,i,a){return t=Pd(Pd(t,e),Pd(r,a)),Pd(t<<i|t>>>32-i,n)}function zd(e,t,n,r,i,a,o){return Bd(t&n|~t&r,e,t,i,a,o)}function Nd(e,t,n,r,i,a,o){return Bd(t&r|n&~r,e,t,i,a,o)}function Rd(e,t,n,r,i,a,o){return Bd(t^n^r,e,t,i,a,o)}function Od(e,t,n,r,i,a,o){return Bd(n^(t|~r),e,t,i,a,o)}var Fd={name:"hash",title:"Hash function",category:"Modern cryptography",type:"encoder"},Dd=[{name:"md5",label:"MD5",blockSize:64,available:!0},{name:"sha1",label:"SHA-1",blockSize:64,browserAlgorithm:"SHA-1",browserExceptions:["ie=11","edge"],nodeAlgorithm:"sha1"},{name:"sha256",label:"SHA-256",blockSize:64,browserAlgorithm:"SHA-256",nodeAlgorithm:"sha256"},{name:"sha384",label:"SHA-384",blockSize:128,browserAlgorithm:"SHA-384",nodeAlgorithm:"sha384"},{name:"sha512",label:"SHA-512",blockSize:128,browserAlgorithm:"SHA-512",browserExceptions:["ie=11"],nodeAlgorithm:"sha512"}],jd=function(e){function n(){var e;ot(this,n),(e=pt(this,ct(n).call(this))).setEncodeOnly(!0);var t=n.filterAvailableAlgorithms();return e.addSetting({name:"algorithm",type:"enum",value:"sha256",elements:t.map((function(e){return e.name})),labels:t.map((function(e){return e.label})),randomizable:!1,style:"radio"}),e}return ut(n,e),lt(n,null,[{key:"getMeta",value:function(){return Fd}}]),lt(n,[{key:"performEncode",value:function(e){var t=this.getSettingValue("algorithm");return this.createDigest(t,e.getBytes())}},{key:"createDigest",value:function(e,n){var r=this,i=Dd.find((function(t){return t.name===e}));switch(e){case"md5":return new Promise((function(e){return e(function(e){var t,n=(e=Array.from(e)).length;for(e.push(128);e.length%64!=56;)e.push(0);for(var r=0;r<8;r++)0===r?e.push((31&n)<<3):(t=8*r-3,e.push(t<32?n>>t&255:0));for(var i=e.length/4,a=new Array(i),o=0;o<i;o++)a[o]=(e[4*o+3]<<24)+(e[4*o+2]<<16)+(e[4*o+1]<<8)+e[4*o];for(var s=[dd,fd,gd,pd],l=0;l<i;l+=16)Ld(s,a.slice(l,l+16));for(var u=new Array(16),c=0,h=0;h<16;c++,h+=4)u[h]=255&s[c],u[h+1]=s[c]>>8&255,u[h+2]=s[c]>>16&255,u[h+3]=s[c]>>24&255;return new Uint8Array(u)}(n))}))}if(nh.isNode())return new Promise((function(e,r){var a=t.createHash(i.nodeAlgorithm).update(global.Buffer.from(n)).digest();e(new Uint8Array(a))}));var a=window.crypto||window.msCrypto,o=(a.subtle||a.webkitSubtle).digest(i.browserAlgorithm,n);return void 0!==o.oncomplete&&(o=new Promise((function(e,t){o.oncomplete=e.bind(r,o.result),o.onerror=t}))),o.then((function(e){return new Uint8Array(e)}))}}],[{key:"filterAvailableAlgorithms",value:function(){var e=nh.isNode();return Dd.filter((function(t){return!0===t.available||(e||void 0===t.browserAlgorithm?!(!e||void 0===t.nodeAlgorithm):void 0===t.browserExceptions||!nh.match.apply(nh,t.browserExceptions))}))}},{key:"getAlgorithmBlockSize",value:function(e){var t=Dd.find((function(t){return t.name===e}));return void 0!==t?t.blockSize:null}}]),n}(dc),qd={name:"hmac",title:"HMAC",category:"Modern cryptography",type:"encoder"},$d=function(e){function t(){var e;ot(this,t),(e=pt(this,ct(t).call(this))).setEncodeOnly(!0),e._hashEncoder=new jd;var n=e._hashEncoder.getSetting("algorithm");return e.addSettings([{name:"key",type:"bytes",value:new Uint8Array([99,114,121,112,116,105,105])},{name:"algorithm",type:"enum",value:n.getValue(),elements:n.getElements(),labels:n.getElementLabels(),randomizable:!1,style:"radio"}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return qd}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.getBytes(),n=this.getSettingValue("algorithm"),r=jd.getAlgorithmBlockSize(n),!((i=this.getSettingValue("key")).length>r)){c.next=8;break}return c.next=7,regeneratorRuntime.awrap(this.createDigest(n,i));case 7:i=c.sent;case 8:for((a=new Uint8Array(r)).set(i,0),(o=new Uint8Array(r+t.length)).set(a,0),o.set(t,r),s=0;s<r;s++)o[s]^=54,a[s]^=92;return c.next=16,regeneratorRuntime.awrap(this.createDigest(n,o));case 16:return l=c.sent,(u=new Uint8Array(r+l.length)).set(a,0),u.set(l,r),c.abrupt("return",this.createDigest(n,u));case 21:case"end":return c.stop()}}),null,this)}},{key:"createDigest",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return null===this._hashEncoder&&(this._hashEncoder=new jd),this._hashEncoder.setSettingValue("algorithm",e),r.next=4,regeneratorRuntime.awrap(this._hashEncoder.encode(t));case 4:return n=r.sent,r.abrupt("return",n.getBytes());case 6:case"end":return r.stop()}}),null,this)}}]),t}(dc);Wa("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wa("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wa("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wa("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Ud={name:"integer",title:"Integer",category:"Encoding",type:"encoder"},Wd=["U8","I8","U16","I16","U32","I32"],Hd=[1,1,2,2,4,4],Gd=["8-bit unsigned integer (U8)","8-bit signed integer (I8)","16-bit unsigned integer (U16)","16-bit signed integer (I16)","32-bit unsigned integer (U32)","32-bit signed integer (I32)"],Kd=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"format",type:"enum",value:"decimal",elements:["binary","octal","decimal","hexadecimal"],labels:["Binary","Octal","Decimal","Hexadecimal"],randomizable:!1,priority:30},{name:"type",type:"enum",value:"U8",elements:Wd,labels:Gd,randomizable:!1,style:"radio",priority:20},{name:"byteOrder",type:"enum",value:"big-endian",elements:["little-endian","big-endian"],labels:["Little-endian","Big-endian"],randomizable:!1,visible:!1,priority:10}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Ud}}]),lt(t,[{key:"performEncode",value:function(e){var t=this.getSettingValue("type"),n=Wd.indexOf(t),r=Hd[n],i="big-endian"===this.getSettingValue("byteOrder"),a=e.getSize();a%r!=0&&(a+=r-a%r);var o=new Uint8Array(a);o.set(e.getBytes());for(var s=this.createIntegerTypeArray(a/r,t),l=0,u=0;u<o.length;)i?l=l<<8|o[u]:l|=o[u]<<u%r*8,++u%r==0&&(s[u/r-1]=l,l=0);var c=this.getSettingValue("format"),h=[];for(u=0;u<s.length;u++)switch(c){case"binary":h.push(s[u].toString(2));break;case"octal":h.push(s[u].toString(8));break;case"decimal":h.push(s[u].toString(10));break;default:h.push(s[u].toString(16))}return h.join(" ")}},{key:"performDecode",value:function(e){var t,n,r,i=this.getSettingValue("type"),a=Wd.indexOf(i),o=Hd[a],s="big-endian"===this.getSettingValue("byteOrder"),l=this.getSettingValue("format"),u=e.getString().split(/\s+/),c=this.createIntegerTypeArray(u.length,i);for(t=0;t<u.length;t++){switch(""===(r=u[t])&&(r="0"),l){case"binary":n=parseInt(r,2);break;case"octal":n=parseInt(r,8);break;case"decimal":n=parseInt(r,10);break;default:n=parseInt(r,16)}if(isNaN(n))throw new Js("Invalid integer '".concat(r,"' at index ").concat(t));c[t]=n}var h,d=new Uint8Array(c.length*o);for(t=0;t<d.length;t++)n=c[parseInt(t/o)],h=s?o-t%o-1:t%o,d[t]=n>>8*h&255;return d}},{key:"createIntegerTypeArray",value:function(e,t){switch(t){case"I8":return new Int8Array(e);case"U8":return new Uint8Array(e);case"I16":return new Int16Array(e);case"U16":return new Uint16Array(e);case"I32":return new Int32Array(e);default:return new Uint32Array(e)}}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"type":var n=Wd.indexOf(this.getSettingValue("type"));this.getSetting("byteOrder").setVisible(Hd[n]>1)}}}]),t}(dc),Zd={name:"letters-to-numbers",title:"Letters to numbers",category:"Encoding",type:"encoder"},Xd="abcdefghijklmnopqrstuvwxyz",Yd=1,Jd=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"shift",type:"number",label:"Shift",priority:10,value:Yd,integer:!0,describeValue:e.describeShiftValue.bind(gt(e)),randomizeValue:e.randomizeShiftValue.bind(gt(e))},{name:"language",label:"Ciphertext Alphabet",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],blackChoiceList:[],width:8,randomizable:!1},{name:"alphabet",type:"text",value:Xd,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Zd}}]),lt(t,[{key:"fromLettersToNumbers",value:function(e,t){for(var n=new al(e),r=n.toString(),i="",a=0;a<n.getLength();a++)num=t.indexOf(r[a]),-1!==num&&(i+=num.toString()+" ");return new al(i).getCodePoints()}},{key:"fromNumbersToLetters",value:function(e,t){var n=e.getString(),r=n.replace(/(\d+)/g,(function(e,r,i){return!((0===i||Xs.isWhitespace(n,i-1))&&(n.length===i+r.length||Xs.isWhitespace(n,i+r.length)))||r>=t.length?r:t.getCharAt(r)}));return new al(r)}},{key:"performTranslate",value:function(e,t){this.getSettingValues().caseStrategy;var n,r,i,a=this.getSettingValue("alphabet"),o=(a=a.toLowerCase()).toUpperCase(),s=this.getSettingValue("shift"),l=a.getLength(),u=e.getLength(),c=new Array(u),h=0;t||(e=this.fromNumbersToLetters(e,a));for(var d=0;d<u;d++)n=e.getCodePointAt(d),-1===(r=a.indexOfCodePoint(n))&&(r=o.indexOfCodePoint(n)),-1!==r&&(i=hc.mod(r+s*(t?1:-1),l),c[h++]=a.getCodePointAt(i));return c=c.slice(0,h),t&&(c=this.fromLettersToNumbers(c,a)),c}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.getSetting("shift").setNeedsValueDescriptionUpdate(),t!=Xd&&"abcdefghilmnopqrstuvz"!=t&&this.setSettingValue("language","other");break;case"language":"english"==t?this.setSettingValue("alphabet",Xd):"italian"==t&&this.setSettingValue("alphabet","abcdefghilmnopqrstuvz"),this.getSetting("shift").setNeedsValueDescriptionUpdate()}}},{key:"randomizeShiftValue",value:function(e,t){var n=this.getSetting("alphabet");return n.isValid()?e.nextInteger(1,n.getValue().getLength()-1):null}},{key:"describeShiftValue",value:function(e,t){if(!this.getSetting("alphabet").isValid())return null;var n=this.getSettingValues(),r=n.alphabet,i=n.shift,a=r.getCharAt(0),o=hc.mod(i,r.getLength());return"".concat(a,"→").concat(o)}}]),t}(dc);ze({target:"String",proto:!0},{repeat:Is});var Qd={name:"morse-code",title:"Morse code",category:"Alphabets",type:"encoder"},ef="abcdefghijklmnopqrstuvwxyz0123456789.,?'!/()&:;=+-_\"$@",tf=[".-","-...","-.-.","-..",".","..-.","--.","....","..",".---","-.-",".-..","--","-.","---",".--.","--.-",".-.","...","-","..-","...-",".--","-..-","-.--","--..","-----",".----","..---","...--","....-",".....","-....","--...","---..","----.",".-.-.-","--..--","..--..",".----.","-.-.--","-..-.","-.--.","-.--.-",".-...","---...","-.-.-.","-...-",".-.-.","-....-","..--.-",".-..-.","..._.._",".--.-."],nf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",value:"english",elements:["english"],labels:["English"],randomizable:!1},{name:"representation",type:"enum",value:"code",elements:["code","timing"],labels:["Code","Timing"],randomizable:!1},{name:"shortMark",label:"Short",type:"text",width:4,value:".",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(gt(e))},{name:"longerMark",label:"Long",type:"text",width:4,value:"-",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(gt(e))},{name:"spaceMark",label:"Space",type:"text",width:4,value:"/",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(gt(e))},{name:"signalOnMark",label:"Signal On",type:"text",width:6,visible:!1,value:"=",minLength:1,randomizable:!1,validateValue:e.validateTimingMarkSettingValue.bind(gt(e))},{name:"signalOffMark",label:"Signal Off",type:"text",width:6,visible:!1,value:".",minLength:1,randomizable:!1,validateValue:e.validateTimingMarkSettingValue.bind(gt(e))}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Qd}}]),lt(t,[{key:"performEncode",value:function(e){var n=this.getSettingValue("representation"),r=".",i="-",a="/";"code"===n&&(r=this.getSettingValue("shortMark").getString(),i=this.getSettingValue("longerMark").getString(),a=this.getSettingValue("spaceMark").getString());var o=e.toLowerCase().getChars().map((function(e){var n=t.encodeCharacter(e,r,i,a);if(null===n)throw new Js("Char '".concat(e,"' is not defined in morse code"));return n})).join(" ");if("timing"===n){var s=this.getSettingValue("signalOnMark").getString(),l=this.getSettingValue("signalOffMark").getString();o=o.split("").map((function(e){switch(e){case".":return s;case"-":return s.repeat(3);default:return l}})).join(l)}return o}},{key:"performDecode",value:function(e){var n=this.getSettingValue("representation"),r=e.getString(),i=".",a="-",o="/";if("code"===n&&(i=this.getSettingValue("shortMark").getString(),a=this.getSettingValue("longerMark").getString(),o=this.getSettingValue("spaceMark").getString()),"timing"===n){var s=[this.getSettingValue("signalOnMark").getString(),this.getSettingValue("signalOffMark").getString()];r=(r=t.translateMarks(r,s,["=","."])).replace(/===/g,"-").replace(/\.{7}/g," / ").replace(/\.{3}/g," ").replace(/\./g,"").replace(/=/g,".")}return r=r.split(" ").map((function(e){if(""===e)return null;var n=t.decodeCode(e,i,a,o);if(null===n)throw new Js("Code '".concat(e,"' is not defined in morse code"));return n})).filter((function(e){return null!==e})).join("")}},{key:"validateCodeMarkSettingValue",value:function(e,t){var n=this,r=t.filterValue(e);return null!==r.match(/\s/)?{key:"morseCodeMarkWhitespaceNotAllowed",message:"Whitespaces are not allowed inside morse code marks"}:void 0===["shortMark","longerMark","spaceMark"].filter((function(e){return e!==t.getName()})).find((function(e){return r.isEqualTo(n.getSettingValue(e))}))||{key:"morseCodeMarkNotUnique",message:"Morse code marks need to be different from each other"}}},{key:"validateTimingMarkSettingValue",value:function(e,t){var n=this,r=t.filterValue(e);return void 0===["signalOnMark","signalOffMark"].filter((function(e){return e!==t.getName()})).find((function(e){return 0===r.indexOf(n.getSettingValue(e))}))||{key:"morseCodeMarkNotUnique",message:"Timing marks need to be different from each other"}}},{key:"settingValueDidChange",value:function(e,t){var n=this;switch(e.getName()){case"shortMark":case"longerMark":case"spaceMark":["shortMark","longerMark","spaceMark"].filter((function(t){return t!==e.getName()})).forEach((function(e){return n.getSetting(e).revalidateValue()}));break;case"signalOnMark":case"signalOffMark":["signalOnMark","signalOffMark"].filter((function(t){return t!==e.getName()})).forEach((function(e){return n.getSetting(e).revalidateValue()}));break;case"representation":this.getSetting("shortMark").setVisible("code"===t),this.getSetting("longerMark").setVisible("code"===t),this.getSetting("spaceMark").setVisible("code"===t),this.getSetting("signalOnMark").setVisible("timing"===t),this.getSetting("signalOffMark").setVisible("timing"===t)}}}],[{key:"encodeCharacter",value:function(e,n,r,i){if(Xs.isWhitespace(e))return i;var a=ef.indexOf(e);if(-1===a)return null;var o=tf[a];return t.translateMarks(o,[".","-"],[n,r])}},{key:"decodeCode",value:function(e,n,r,i){if(e===i)return" ";var a=t.translateMarks(e,[n,r],[".","-"]),o=tf.indexOf(a);return-1!==o?ef[o]:null}},{key:"translateMarks",value:function(e,t,n){for(var r,i,a,o="",s=-1;++s<e.length;)for(a=!1,r=-1;!a&&++r<t.length;)i=t[r],(a=e.substr(s,i.length)===i)&&(o+=n[r],s+=i.length-1);return o}}]),t}(dc),rf={name:"nihilist-cipher",title:"Nihilist cipher",category:"Polybius square ciphers",type:"encoder"},af="cryptii",of="abcdefghiklmnopqrstuvwxyz",sf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"alphabet",type:"text",value:of,uniqueChars:!0,minLength:0,maxLength:25,caseSensitivity:!1},{name:"key",type:"text",value:af,whitelistChars:of,minLength:2,caseSensitivity:!1},{name:"separator",type:"text",value:" ",randomizable:!1,blacklistChars:"0123456789",minLength:1,caseSensitivity:!1}]),e._polybiusSquare=new mc,e._polybiusSquare.setSettingValues({alphabet:of,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return rf}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t=this.getSettingValue("key"),n=this.getSettingValue("separator"),d.next=4,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/j/gi,"i")));case 4:return r=d.sent,d.next=7,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 7:for(i=d.sent,a=r.getLength()/2,o=t.getLength(),s=new Array(a),h=0;h<a;h++)l=parseInt(r.getCharAt(2*h)+r.getCharAt(2*h+1)),u=2*hc.mod(h,o),c=parseInt(i.getCharAt(u)+i.getCharAt(u+1)),s[h]=l+c;return d.abrupt("return",al.join(s,n));case 13:case"end":return d.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return t=this.getSettingValue("key"),n=this.getSettingValue("separator"),r=e.getString().split(n),i=r.length,a=t.getLength(),f.next=7,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 7:o=f.sent,h="",d=0;case 10:if(!(d<i)){f.next=23;break}if(s=parseInt(r[d]),!isNaN(s)){f.next=14;break}throw new Js("Block at index ".concat(d+1," is not a number."));case 14:if(u=2*hc.mod(d,a),c=parseInt(o.getCharAt(u)+o.getCharAt(u+1)),(l=s-c).toString().match(/^[1-5]{2}$/)){f.next=19;break}throw new Js("Block at index ".concat(d+1," results in invalid ")+"Polybius square coordinates '".concat(l,"'."));case 19:h+=l.toString();case 20:d++,f.next=10;break;case 23:return f.abrupt("return",this._polybiusSquare.decode(h));case 24:case"end":return f.stop()}}),null,this)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":var n=t.extend(of);this._polybiusSquare.setSettingValue("alphabet",n),this.getSetting("key").setWhitelistChars(n)}}}]),t}(dc),lf=Math.floor,uf=function(e){return!C(e)&&isFinite(e)&&lf(e)===e};ze({target:"Number",stat:!0},{isInteger:uf});var cf=Math.abs;ze({target:"Number",stat:!0},{isSafeInteger:function(e){return uf(e)&&cf(e)<=9007199254740991}});var hf={name:"numeral-system",title:"Numeral system",category:"Transform",type:"encoder"},df=["binary","octal","decimal","hexadecimal","roman-numerals"],ff=["Binary (2)","Octal (8)","Decimal (10)","Hexadecimal (16)","Roman numerals"],gf=[/([01]+)/g,/([0-7]+)/g,/(\d+)/g,/([0-9a-f]+)/gi,/([IVXLCDM]+)/gi],pf=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],vf=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],yf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"from",label:"Read",type:"enum",value:"decimal",elements:df,labels:ff,randomizable:!1,style:"radio"},{name:"to",label:"Convert to",type:"enum",value:"hexadecimal",elements:df,labels:ff,randomizable:!1,style:"radio"}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return hf}}]),lt(t,[{key:"performTranslate",value:function(e,n){var r=e.toString(),i=this.getSettingValue(n?"from":"to"),a=this.getSettingValue(n?"to":"from"),o=gf[df.indexOf(i)];return r.replace(o,(function(e,n,o){if(!((0===o||Xs.isWhitespace(r,o-1))&&(r.length===o+n.length||Xs.isWhitespace(r,o+n.length))))return n;var s=t.decodeNumber(i,n);return(null!==s?t.encodeNumber(a,s):null)||n}))}}],[{key:"decodeNumber",value:function(e,n){if("undefined"!=typeof BigInt)switch(e){case"binary":return BigInt("0b".concat(n));case"octal":return BigInt("0o".concat(n));case"decimal":return BigInt(n);case"hexadecimal":return BigInt("0x".concat(n))}var r=null;switch(e){case"binary":r=parseInt(n,2);break;case"octal":r=parseInt(n,8);break;case"decimal":r=parseInt(n,10);break;case"hexadecimal":r=parseInt(n,16);break;case"roman-numerals":r=t.romanNumeralsToDecimal(n)}if(null===r||isNaN(r))return null;if(!t.isSafeInteger(r))throw new Js("Can't read '".concat(n,"' because the current environment does not ")+"support arbitrarily large integers.");return r}},{key:"encodeNumber",value:function(e,n){switch(e){case"binary":return n.toString(2);case"octal":return n.toString(8);case"decimal":return n.toString(10);case"hexadecimal":return n.toString(16);case"roman-numerals":return t.decimalToRomanNumerals(n);default:return null}}},{key:"isSafeInteger",value:function(e){if(void 0===Number.isSafeInteger){var t=Number.MAX_SAFE_INTEGER||9007199254740991;return Number.isInteger(e)&&Math.abs(e)<=t}return Number.isSafeInteger(e)}},{key:"decimalToRomanNumerals",value:function(e){if(e<=0||e>=4e3)return null;for(var t,n=Number(e),r="";n>0;)t=vf.findIndex((function(e){return n>=e})),r+=pf[t],n-=vf[t];return r}},{key:"romanNumeralsToDecimal",value:function(e){e=e.toString().toUpperCase();for(var t,n=0,r=0,i=!1,a=0;!i&&n<e.length;)-1!==(t=pf.findIndex((function(t){return e.substr(n,t.length)===t})))&&t>=a?(r+=vf[t],n+=pf[t].length,a=t):i=!0;return i?null:r}}]),t}(dc),mf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._tape=[],e._rows=8,e._$canvas=null,e._$tapes=null,e._$marks=null,e._$holes=null,e}return ut(t,e),lt(t,[{key:"setTape",value:function(e,t){return this._tape=e,this._rows=t,this.setNeedsUpdate()}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("viewer-paper-tape"),e}},{key:"renderContent",value:function(){this._$tapes=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$tapes.classList.add("viewer-punched-tape__tape"),this._$marks=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$marks.classList.add("viewer-punched-tape__mark"),this._$holes=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$holes.classList.add("viewer-punched-tape__hole"),this._$canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._$canvas.classList.add("viewer-punched-tape__canvas"),this._$canvas.appendChild(this._$tapes),this._$canvas.appendChild(this._$marks),this._$canvas.appendChild(this._$holes),this.setNeedsUpdate();var e=vt(ct(t.prototype),"renderContent",this).call(this);return e.appendChild(this._$canvas),e}},{key:"layout",value:function(){return this.setNeedsUpdate(),vt(ct(t.prototype),"layout",this).call(this)}},{key:"update",value:function(){var e=this._tape,t=this._tape.length,n=this._rows,r=Math.floor((n-1)/2);n++;var i,a,o,s,l,u=1.5,c=this._$canvas.getBoundingClientRect().width-32,h=Math.floor((c-22)/13)+1,d=(c-13*(h-1))/2,f=Math.ceil(t/h),g=13*(n-1)+22,p=g+16,v=f*(g+16)+16,m=[],b=[];for(s=0;s<t;s++){for(i=e[s],a=16+d+s%h*13,o=27+Math.floor(s/h)*p,l=0;l<n;l++)l===r?(b.push("M ".concat(a-u," ").concat(o+13*l)),b.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(3,",0")),b.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(-3,",0"))):(0!=(1&i)&&(b.push("M ".concat(a-3," ").concat(o+13*l)),b.push("a ".concat(3,",").concat(3," 0 1,0 ").concat(6,",0")),b.push("a ".concat(3,",").concat(3," 0 1,0 ").concat(-6,",0"))),i>>=1);s%n==0&&n>=5&&(m.push("M ".concat(a-u,",").concat(o-11+g+8)),m.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(3,",0")),m.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(-3,",0")))}var k,w,_=[];for(y=0;y<f;y++)16,k=16+y*p,w=y<f-1||t%h==0?c:t%h*13+2*d,_.push("M ".concat(16,",").concat(k+3)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(3,",").concat(-3)),_.push("L ".concat(16+w-3,",").concat(k)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(3,",").concat(3)),_.push("L ".concat(16+w,",").concat(k+g-3)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(-3,",").concat(3)),_.push("L ".concat(19,",").concat(k+g)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(-3,",").concat(-3)),_.push("Z");this._$canvas.style.height="".concat(v,"px"),this._$tapes.setAttribute("d",_.join(" ")),this._$marks.setAttribute("d",m.join(" ")),this._$holes.setAttribute("d",b.join(" "))}}]),t}(Th),bf={name:"punched-tape",title:"Punched tape",category:"View",type:"viewer"},kf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=mf,e.addSetting({name:"rows",type:"number",value:8,min:3,max:25,randomizable:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return bf}}]),lt(t,[{key:"performView",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:t=this.getSettingValue("rows"),n=e.getBytes(),r=Ss.resizeBitSizedArray(n,8,t,!0),this.getView().setTape(r,t);case 4:case"end":return i.stop()}}),null,this)}}]),t}(Lh),wf={name:"punycode",title:"Punycode",category:"Encoding",type:"encoder"},_f={basicRangeStart:0,basicRangeEnd:127,digitMapping:"abcdefghijklmnopqrstuvwxyz0123456789",delimiter:"-",caseSensitivity:!1,initialBias:72,initialN:128,tmin:1,tmax:26,skew:38,damp:700},Sf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._bootstringEncoder=new Ah,e._bootstringEncoder.setSettingValues(_f),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return wf}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:e=e.toLowerCase(),t=e.split("."),n=new Array(t.length),r=0;case 4:if(!(r<t.length)){a.next=16;break}if(-1!==this._nonBasicCodePointIndex(t[r].getCodePoints())){a.next=9;break}n[r]=t[r],a.next=13;break;case 9:return a.next=11,regeneratorRuntime.awrap(this._bootstringEncoder.encode(t[r]));case 11:i=a.sent,n[r]="xn--"+i.getString();case 13:r++,a.next=4;break;case 16:return a.abrupt("return",al.join(n,"."));case 17:case"end":return a.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(-1===(t=this._nonBasicCodePointIndex(e.getCodePoints()))){o.next=3;break}throw new Js("Invalid Punycode character at index ".concat(t));case 3:n=e.split("."),r=new Array(n.length),i=0;case 6:if(!(i<n.length)){o.next=18;break}if(0===n[i].indexOf("xn--")){o.next=11;break}r[i]=n[i],o.next=15;break;case 11:return a=n[i].substr("xn--".length),o.next=14,regeneratorRuntime.awrap(this._bootstringEncoder.decode(a));case 14:r[i]=o.sent;case 15:i++,o.next=6;break;case 18:return o.abrupt("return",al.join(r,"."));case 19:case"end":return o.stop()}}),null,this)}},{key:"_nonBasicCodePointIndex",value:function(e){return e.findIndex((function(e){return e>=128}))}}]),t}(dc),xf={name:"rail-fence-cipher",title:"Rail fence cipher",category:"Ciphers",type:"encoder"},Cf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"key",type:"number",value:2,integer:!0,min:2,randomizeValue:function(e){return e.nextInteger(2,8)}},{name:"offset",type:"number",value:0,integer:!0,min:0,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return xf}}]),lt(t,[{key:"performEncode",value:function(e){var t,n=this.getSettingValues(),r=n.key,i=n.offset,a=e.getLength(),o=2*r-2,s=new Array(r).fill("");for(t=0;t<a;t++)s[r-1-Math.abs(o/2-(t+i)%o)]+=e.getCharAt(t);return s.join("")}},{key:"performDecode",value:function(e){var t,n,r=this.getSettingValues(),i=r.key,a=r.offset,o=e.getLength(),s=2*i-2,l=new Array(o),u=-1;for(n=0;n<i;n++)for(t=0;t<o;t++)(n+t+a)%s!=0&&(n-t-a)%s!=0||(l[t]=e.getCodePointAt(++u));return l}}]),t}(dc),If={name:"rc4",title:"RC4",category:"Modern cryptography",type:"encoder"},Vf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"key",type:"bytes",value:new Uint8Array([99,114,121,112,116,105,105]),minSize:1,maxSize:32,randomizeSize:8},{name:"drop",type:"number",label:"Drop bytes",value:0,integer:!0,min:0,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return If}}]),lt(t,[{key:"performTranslate",value:function(e,t){for(var n=this.getSettingValue("key"),r=this.getSettingValue("drop"),i=n.length,a=e.getBytes(),o=a.length,s=new Uint8Array(o),l=new Uint8Array(256),u=0;u<256;u++)l[u]=u;for(var c=0,h=0;h<256;h++){var d=[l[c=(c+l[h]+n[h%i])%256],l[h]];l[h]=d[0],l[c]=d[1]}var f,g=0;c=0;for(var p=0;p<r+o;p++){var v=[l[c=(c+l[g=(g+1)%256])%256],l[g]];l[g]=v[0],l[c]=v[1],f=l[(l[g]+l[c])%256],p>=r&&(s[p-r]=a[p-r]^f)}return s}}]),t}(dc),Ef={name:"replace",title:"Replace",category:"Transform",type:"encoder"},Af=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"find",type:"text",value:"",randomizable:!1},{name:"replace",type:"text",value:"",randomizable:!1},{name:"caseSensitivity",type:"boolean",value:!1,randomizable:!1}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Ef}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=this.getSettingValue("caseSensitivity"),r=this.getSettingValues(),i=r.find,a=r.replace;if(!t){var o=[a,i];i=o[0],a=o[1]}var s=e;n||(s=s.toLowerCase(),i=i.toLowerCase()),s=s.getCodePoints(),e=e.getCodePoints(),i=i.getCodePoints(),a=a.getCodePoints();for(var l=0,u=-1,c=[];-1!==(u=Ss.indexOfSlice(s,i,u+1));)c=(c=c.concat(e.slice(l,u))).concat(a),l=u+i.length;return c.concat(e.slice(l))}}]),t}(dc),Tf={name:"reverse",title:"Reverse",category:"Transform",type:"encoder"},Mf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSetting({name:"type",label:"By",type:"enum",value:"character",elements:["byte","character","line"],labels:["Byte","Character","Line"],randomizable:!1,style:"radio"}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Tf}}]),lt(t,[{key:"performTranslate",value:function(e,t){switch(this.getSettingValue("type")){case"byte":return e.getBytes().reverse();case"character":return al.join(e.getChars().reverse(),"");case"line":return al.join(e.split(/\r?\n/).reverse(),"\n")}}}]),t}(dc),Lf={name:"rot13",title:"ROT13",category:"Ciphers",type:"encoder"},Pf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSetting({name:"variant",type:"enum",value:"rot13",elements:["rot5","rot13","rot18","rot47"],labels:["ROT5 (0-9)","ROT13 (A-Z, a-z)","ROT18 (0-9, A-Z, a-z)","ROT47 (!-~)"],randomizable:!1,style:"radio"}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Lf}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=this,r=this.getSettingValue("variant");return e.getCodePoints().map((function(e){return"rot5"!==r&&"rot18"!==r||(e=n._rotateCodePoint(e,48,57)),"rot13"!==r&&"rot18"!==r||(e=n._rotateCodePoint(e,97,122),e=n._rotateCodePoint(e,65,90)),"rot47"===r&&(e=n._rotateCodePoint(e,33,126)),e}))}},{key:"_rotateCodePoint",value:function(e,t,n){if(e>=t&&e<=n){var r=n-t+1;(e+=r/2)>n&&(e-=r)}return e}}]),t}(dc),Bf={name:"spelling-alphabet",title:"Spelling alphabet",category:"Alphabets",type:"encoder"},zf=[{name:"nato",label:"NATO/ICAO phonetic alphabet",characters:"abcdefghijklmnopqrstuvwxxyz0123456789.",words:["Alfa","Bravo","Charlie","Delta","Echo","Foxtrot","Golf","Hotel","India","Juliett","Kilo","Lima","Mike","November","Oscar","Papa","Quebec","Romeo","Sierra","Tango","Uniform","Victor","Whiskey","X-ray","Xray","Yankee","Zulu","Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Stop"],spaceWord:"(space)"},{name:"dutch",label:"Dutch spelling alphabet",characters:["a","b","c","d","e","f","g","h","ij","ij","i","j","j","k","l","l","m","n","o","p","q","q","r","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],words:["Anton","Bernhard","Cornelis","Dirk","Eduard","Ferdinand","Gerard","Hendrik","IJmuiden","IJsbrand","Izaak","Johan","Jacob","Karel","Lodewijk","Leo","Maria","Nico","Otto","Pieter","Quirinius","Quinten","Richard","Rudolf","Simon","Theodoor","Utrecht","Victor","Willem","Xantippe","Ypsilon","Zacharias","Nul","Een","Twee","Drie","Vier","Vijf","Zes","Zeven","Acht","Negen"],spaceWord:"(spatiebalk)"},{name:"german",label:"German spelling alphabet",characters:"abcdefghijkklmnopqrsstuvwxxyzzäööüüßß0123456789",words:["Anton","Berta","Cäsar","Dora","Emil","Friedrich","Gustav","Heinrich","Ida","Julius","Kaufmann","Konrad","Ludwig","Martha","Nordpol","Otto","Paula","Quelle","Richard","Samuel","Siegfried","Theodor","Ulrich","Viktor","Wilhelm","Xanthippe","Xaver","Ypsilon","Zacharias","Zürich","Ärger","Ökonom","Österreich","Übermut","Übel","Eszett","Scharfes S","Null","Eins","Zwei","Drei","Vier","Fünf","Sechs","Sieben","Acht","Neun"],spaceWord:"(Leertaste)"},{name:"swedish",label:"Swedish Armed Forces' radio alphabet",characters:"abcdefghijklmnopqrstuvwxyzåäö0123456789",words:["Adam","Bertil","Caesar","David","Erik","Filip","Gustav","Helge","Ivar","Johan","Kalle","Ludvig","Martin","Niklas","Olof","Petter","Qvintus","Rudolf","Sigurd","Tore","Urban","Viktor","Wilhelm","Xerxes","Yngve","Zäta","Åke","Ärlig","Östen","Nolla","Ett","Tvåa","Trea","Fyra","Femma","Sexa","Sju","Åtta","Nia"],spaceWord:"(mellanslag)"},{name:"russian",label:"Russian spelling alphabet (official, excludes Ё)",characters:"абвгдежзийклмнопрстуфхцчшщъыьэюя0123456789.",words:["Анна","Борис","Василий","Григорий","Дмитрий","Елена","Женя","Зинаида","Иван","Иван краткий","Константин","Леонид","Михаил","Николай","Ольга","Павел","Роман","Семён","Татьяна","Ульяна","Фёдор","Харитон","Цапля","Человек","Шура","Щука","Твёрдый знак","Еры","Мягкий знак","Эхо","Юрий","Яков","Ноль","Один","Два","Три","Четыре","Пять","Шесть","Семь","Восемь","Девять","Точка"],spaceWord:"(пробел)"},{name:"russian-unofficial",label:"Russian spelling alphabet (unofficial, includes Ё)",characters:"абвгдеёжзийклмнопрстуфхцчшщъыьэюя0123456789.",words:["Антон","Борис","Василий","Галина","Дмитрий","Елена","Ёлка","Жук","Зоя","Иван","Йот","Киловатт","Леонид","Мария","Николай","Ольга","Павел","Радио","Сергей","Тамара","Ульяна","Фёдор","Харитон","Центр","Человек","Шура","Щука","Твёрдый знак","Игрек","Мягкий знак","Эмма","Юрий","Яков","Ноль","Один","Два","Три","Четыре","Пять","Шесть","Семь","Восемь","Девять","Точка"],spaceWord:"(пробел)"}],Nf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._characterMap={},e._wordMap={},e.addSetting({name:"alphabet",type:"enum",elements:zf.map((function(e){return e.name})),labels:zf.map((function(e){return e.label})),randomizable:!1,style:"radio"}),e.buildTranslationMap(),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Bf}}]),lt(t,[{key:"performTranslate",value:function(e,t){for(var n=Xs.normalizeWhitespaces(e.getString()),r=t?this._characterMap:this._wordMap,i=Object.keys(r).sort((function(e,t){return t.length-e.length})),a=0,o=[];a<n.length;){var s=i.find((function(e){return n.substr(a,e.length).toLowerCase()===e.toLowerCase()}));if(void 0!==s)o.push(r[s]),a+=s.length;else{var l=n.substr(a,1);(t||" "!==l)&&o.push(l),a++}}return o.join(t?" ":"")}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.buildTranslationMap()}}},{key:"buildTranslationMap",value:function(){var e=this.getSettingValue("alphabet"),t=zf.find((function(t){return t.name===e}));if(void 0===t)throw new Error("Alphabet with name '".concat(e,"' is not defined"));var n="string"==typeof t.characters?t.characters.split(""):t.characters,r=t.words,i={};n.forEach((function(e,t){void 0===i[e]&&(i[e]=r[t])}));var a={};r.forEach((function(e,t){e=e.toLowerCase(),void 0===a[e]&&(a[e]=n[t])}));var o=t.spaceWord||"(space)";return i[" "]=o,a[o]=" ",this._characterMap=i,this._wordMap=a,this}}]),t}(dc),Rf={name:"stress-deletion",title:"Stress Deletion",category:"Transform",type:"encoder"},Of={"è":"e","é":"e","à":"a","á":"a","ò":"o","ó":"o","í":"i","ì":"i","ù":"u","ú":"u","Á":"A","À":"A","È":"E","É":"E","Í":"I","Ì":"I","Ò":"O","Ó":"O","Ú":"U","Ù":"U"},Ff=function(e){function t(){return ot(this,t),pt(this,ct(t).call(this))}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Rf}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n=e.getString();return cleanString=n.replace(/è|é|à|á|ò|ó|í|ì|ù|ú|Á|À|È|É|Í|Ì|Ò|Ó|Ú|Ù/g,(function(e){return Of[e]})),new al(cleanString).getCodePoints()}},{key:"settingValueDidChange",value:function(e,t){}}]),t}(dc),Df={name:"tap-code",title:"Tap code",category:"Polybius square ciphers",type:"encoder"},jf="abcdefghijlmnopqrstuvwxyz",qf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"tapMark",label:"Tap",type:"text",width:4,value:".",minLength:1,randomizable:!1},{name:"groupMark",label:"Group",type:"text",width:4,value:" ",minLength:1,randomizable:!1},{name:"letterMark",label:"Letter",type:"text",width:4,value:"  ",minLength:1,randomizable:!1}]),e._polybiusSquare=new mc,e._polybiusSquare.setSettingValues({alphabet:jf,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Df}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=this.getSettingValue("tapMark").getString(),n=this.getSettingValue("groupMark").getString(),r=this.getSettingValue("letterMark").getString(),c.next=5,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/k/gi,"c")));case 5:for(i=c.sent,a=i.getLength()/2,l="",u=0;u<a;u++)o=parseInt(i.getCharAt(2*u)),s=parseInt(i.getCharAt(2*u+1)),l+=(u>0?r:"")+t.repeat(o)+n+t.repeat(s);return c.abrupt("return",l);case 10:case"end":return c.stop()}}),null,this)}},{key:"performDecode",value:function(e){for(var t=this.getSettingValue("tapMark").getCodePoints(),n=t.length,r=e.getCodePoints(),i="",a=0,o=-1,s=0;-1!==(o=Ss.indexOfSlice(r,t,o+1));)0===a||o===a+n?s++:(i+=s.toString(),s=1),a=o;return i+=s.toString(),this._polybiusSquare.decode(i)}}]),t}(dc),$f={name:"text",title:"Text",category:"View",type:"viewer"},Uf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=Mh,e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return $f}}]),lt(t,[{key:"performView",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.getView().setText(e.getString());case 1:case"end":return t.stop()}}),null,this)}},{key:"viewTextDidChange",value:function(e,t){var n=this;this.dare((function(){n.contentDidChange(al.wrap(t))}))}}]),t}(Lh),Wf={name:"trifid-cipher",title:"Trifid cipher",category:"Polybius square ciphers",type:"encoder"},Hf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"key",type:"text",value:"",uniqueChars:!0,minLength:0,maxLength:27,caseSensitivity:!1},{name:"groupSize",type:"number",value:5,min:2}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Wf}}]),lt(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d,f,g;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:for(t=this.getSettingValues(),n=t.key,r=t.groupSize,i=al.wrap(n).extend("abcdefghijklmnopqrstuvwxyz+").getCodePoints(),a=e.toLowerCase().getCodePoints().map((function(e){return i.indexOf(e)})).filter((function(e){return-1!==e})),o=a.length,s=new Array(3*o),l=0;l<o;l++)for(h=Math.floor(l/r),d=l-h*r,f=Math.min(r,o-h*r),c=this.cartesianCoordinatesFromIndex(a[l]),u=0;u<3;u++)s[d+h*r*3+f*u]=c[u];for(g=new Array(o),l=0;l<o;l++)c=s.slice(3*l,3*(l+1)),d=this.indexFromCartesianCoordinates(c),g[l]=i[d];return p.abrupt("return",g);case 9:case"end":return p.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d,f,g;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:for(t=this.getSettingValues(),n=t.key,r=t.groupSize,i=al.wrap(n).extend("abcdefghijklmnopqrstuvwxyz+").getCodePoints(),a=e.toLowerCase().getCodePoints().map((function(e){return i.indexOf(e)})).filter((function(e){return-1!==e})),o=a.length,s=new Array(3*o),l=0;l<o;l++)for(c=this.cartesianCoordinatesFromIndex(a[l]),u=0;u<3;u++)s[3*l+u]=c[u];for(h=new Array(o),l=0;l<o;l++){for(d=Math.floor(l/r),f=l-d*r,g=Math.min(r,o-d*r),u=0;u<3;u++)c[u]=s[f+d*r*3+g*u];f=this.indexFromCartesianCoordinates(c),h[l]=i[f]}return p.abrupt("return",h);case 9:case"end":return p.stop()}}),null,this)}},{key:"cartesianCoordinatesFromIndex",value:function(e){var t=Math.floor(e/9),n=Math.floor((e-9*t)/3);return[t+1,n+1,e-9*t-3*n+1]}},{key:"indexFromCartesianCoordinates",value:function(e){var t=yt(e,3);return 9*(t[0]-1)+3*(t[1]-1)+(t[2]-1)}}]),t}(dc),Gf={name:"unicode-code-points",title:"Unicode code points",category:"Encoding",type:"encoder"},Kf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).setCharacterToBlockMode(),e.addSetting({name:"format",type:"enum",value:"unicode",elements:["unicode","decimal","hexadecimal","binary","octal","ncr-decimal","ncr-hexadecimal"],labels:["Unicode notation","Decimal","Hexadecimal","Binary","Octal","NCR (Decimal)","NCR (Hexadecimal)"],randomizable:!1,style:"radio"}),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Gf}}]),lt(t,[{key:"performCharEncodeToBlock",value:function(e,t,n){switch(this.getSettingValue("format")){case"unicode":return"U+"+e.toString(16).toUpperCase();case"decimal":return e.toString(10);case"hexadecimal":return e.toString(16);case"binary":return e.toString(2);case"octal":return e.toString(8);case"ncr-decimal":return"&#".concat(e.toString(10),";");case"ncr-hexadecimal":return"&#x".concat(e.toString(16),";")}}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){var i,a=0;switch(this.getSettingValue("format")){case"unicode":null!==(i=e.match(/^U\+([0-9A-F]+)$/i))&&(a=parseInt(i[1],16));break;case"decimal":a=parseInt(e,10);break;case"hexadecimal":a=parseInt(e,16);break;case"binary":a=parseInt(e,2);break;case"octal":a=parseInt(e,8);break;case"ncr-decimal":case"ncr-hexadecimal":null!==(i=e.match(/^&#x([0-9A-F]+);$/i))?a=parseInt(i[1],16):null!==(i=e.match(/^&#([0-9]+);$/))&&(a=parseInt(i[1],10))}if(!rl.validateCodePoint(a))throw new Js("Invalid code point at index ".concat(t));return a}}]),t}(gc),Zf={name:"url-encoding",title:"URL encoding",category:"Encoding",type:"encoder"},Xf=function(e){function t(){return ot(this,t),pt(this,ct(t).apply(this,arguments))}return ut(t,e),lt(t,[{key:"performEncode",value:function(e){try{for(var t,n=e.getChars(),r="",i=0;i<n.length;i++)t=n[i],r+=-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.~".indexOf(t)?this.encodeBytes(e.getCharBytesAt(i)):t;return r}catch(t){if(t instanceof nl)return this.encodeBytes(e.getBytes());throw t}}},{key:"encodeBytes",value:function(e){for(var t="",n=0;n<e.length;n++)t+="%"+("0"+e[n].toString(16)).slice(-2);return t}},{key:"performDecode",value:function(e){for(var t,n,r=e.getString(),i=[],a=0;a<r.length;)if("%"===(t=r[a])){if(null===(n=r.substr(a+1,2)).match(/[0-9a-f]{2}/i))throw new Js("Invalid percent-encoded byte '%".concat(n,"' at index ").concat(a));i.push(parseInt(n,16)),a+=3}else if("+"===t)i.push(32),a++;else{if(-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.~".indexOf(t))throw new Js("Invalid character '".concat(t,"' at index ").concat(a));i.push(t.charCodeAt(0)),a++}return new Uint8Array(i)}}],[{key:"getMeta",value:function(){return Zf}}]),t}(dc),Yf={name:"vigenere-cipher",title:"Vigenère cipher",category:"Ciphers",type:"encoder"},Jf="abcdefghijklmnopqrstuvwxyz",Qf=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this))).addSettings([{name:"variant",type:"enum",value:"standard",elements:["standard","beaufort-cipher","variant-beaufort-cipher","trithemius-cipher"],labels:["Standard Vigenère cipher","Beaufort cipher","Variant Beaufort cipher","Trithemius cipher"],randomizable:!1},{name:"key",type:"text",value:"cryptii",whitelistChars:Jf,minLength:2,caseSensitivity:!1},{name:"keyMode",type:"enum",value:"repeat",elements:["repeat","autokey"],labels:["Repeat","Autokey"],randomizable:!1},{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:Jf,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!0,randomizable:!1,trueLabel:"Include",falseLabel:"Ignore"}]),e}return ut(t,e),lt(t,null,[{key:"getMeta",value:function(){return Yf}}]),lt(t,[{key:"performTranslate",value:function(e,t){var n,r=this.getSettingValues(),i=r.variant,a=r.caseStrategy,o=r.includeForeignChars,s=this.getSettingValue("alphabet");"strict"!==a&&(n=(s=s.toLowerCase()).toUpperCase());var l=this.getSettingValues(),u=l.key,c=l.keyMode;"trithemius-cipher"===i&&(u=s,c="repeat");for(var h,d,f,g,p,v=e.getLength(),y=new Array(v),m=0,b=0,k=0;k<v;k++)if(d=e.getCodePointAt(k),f=!1,-1===(h=s.indexOfCodePoint(d))&&"strict"!==a&&(h=n.indexOfCodePoint(d),f=!0),-1!==h){switch(g=u.getCodePointAt(hc.mod(b,u.getLength())),p=s.indexOfCodePoint(g),i){case"beaufort-cipher":h=p-h;break;case"variant-beaufort-cipher":h=t?h-p:h+p;break;default:h=t?h+p:h-p}h=hc.mod(h,s.getLength()),y[m++]="maintain"===a&&f?n.getCodePointAt(h):s.getCodePointAt(h),"autokey"===c&&(g=t?d:s.getCodePointAt(h),u=al.join([u,al.wrap([g]).toLowerCase()],"")),b++}else o&&(y[m++]=d);return y.slice(0,m)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("key").setVisible("trithemius-cipher"!==t),this.getSetting("keyMode").setVisible("trithemius-cipher"!==t);break;case"alphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other"),this.getSetting("key").setWhitelistChars(t);break;case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t),this.getSetting("key").setCaseSensitivity("strict"===t);break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}}]),t}(dc),eg=null,tg=function(e){function t(){var e;return ot(this,t),e=pt(this,ct(t).call(this)),[Uf,Bh,kf,Af,Mf,Xh,yf,Jc,hh,uh,Ff,nf,Nf,hd,Kh,Ic,fh,Pf,vc,Qf,Nc,Tc,Cf,mc,Sc,Zc,sf,qf,Hf,Fc,$c,Pc,Hc,Kf,Xf,Sf,Ah,Kd,Jd,td,oh,Vf,jd,$d].forEach(e.register.bind(gt(e))),e}return ut(t,e),lt(t,[{key:"register",value:function(e){var n=e.getMeta().name;return vt(ct(t.prototype),"register",this).call(this,n,e)}},{key:"getMeta",value:function(e){return this.getInvokable(e).getMeta()}},{key:"getLibrary",value:function(){var e=this;return this.getIdentifiers().map((function(t){return e.getMeta(t)}))}}],[{key:"getInstance",value:function(){return null===eg&&(eg=new t),eg}}]),t}(on),ng=function(e){function t(e){var n;return ot(this,t),(n=pt(this,ct(t).call(this)))._title=e,n._$trigger=null,n._visible=!1,n._value=null,n._finishCallback=null,n._cancelCallback=null,n._keyUpHandler=n.keyDidPress.bind(gt(n)),n._$outer=null,n._$dialog=null,n}return ut(t,e),lt(t,[{key:"isVisible",value:function(){return this._visible}},{key:"setVisible",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._visible!==t){this._visible=t;var r=this.getElement();t&&(document.body.appendChild(r),this._$trigger=document.activeElement);var i=this._$dialog.getBoundingClientRect().height;t?this._$dialog.style.height="0px":(this._$dialog.style.height="".concat(i,"px"),this._$outer.style.height="".concat(i,"px")),r.getBoundingClientRect(),r.addEventListener("transitionend",(function(){setTimeout(e.visibilityDidChange.bind(e,t,n),100)}),{once:!0}),t?(document.body.classList.add("modal-visible"),r.classList.add("modal--visible"),this._$dialog.style.height="".concat(i,"px"),this._keyUpHandler&&document.addEventListener("keyup",this._keyUpHandler)):(document.body.classList.remove("modal-visible"),r.classList.remove("modal--visible"),this._$dialog.style.height="0px",this._keyUpHandler&&document.removeEventListener("keyup",this._keyUpHandler))}return this}},{key:"visibilityDidChange",value:function(e,t){var n=this;e?(this._$dialog.removeAttribute("style"),this.getElement().focus()):(setTimeout((function(){n._$dialog.removeAttribute("style"),n._$outer.removeAttribute("style");var e=n.getElement();null!==e.parentNode&&e.parentNode.removeChild(e)}),100),!1===t&&null!==this._finishCallback?this._finishCallback(this._value):!0===t&&null!==this._cancelCallback&&this._cancelCallback(),this._$trigger&&(this._$trigger.focus(),this._$trigger=null),this._finishCallback=null,this._cancelCallback=null)}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){return this._value!==e&&(this._value=e,this.valueDidChange(e)),this}},{key:"valueDidChange",value:function(e){}},{key:"prompt",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0!==t&&this.setValue(t),new Promise((function(t,n){e._finishCallback=t,e._cancelCallback=n,e.open()}))}},{key:"open",value:function(){return this.setVisible(!0)}},{key:"cancel",value:function(){return this.setVisible(!1,!0)}},{key:"finish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0!==e&&this.setValue(e),this.setVisible(!1,!1)}},{key:"render",value:function(){var e=this;return this._$dialog=this.renderDialog(),this._$outer=Jt.createElement("div",{className:"modal__outer"},[this._$dialog]),Jt.createElement("div",{className:"modal",role:"dialog",tabIndex:-1},[Jt.createElement("div",{className:"modal__backdrop"}),Jt.createElement("div",{className:"modal__scrollable",role:"document",onClick:function(t){t.target===t.currentTarget&&(t.preventDefault(),e.cancel())}},[this._$outer])])}},{key:"renderDialog",value:function(){return Jt.createElement("div",{className:"modal__dialog"},[this.renderHeader(),this.renderContent()])}},{key:"renderHeader",value:function(){var e=this,t=Jt.createElement("button",{className:"modal__btn-close",onClick:function(t){t.preventDefault(),e.cancel()}});return t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M15 2.41L13.59 1 8 6.59 2.41 1 1 2.41 6.59 8 1 13.59 2.41 15 8 9.41 13.59 15 15 13.59 9.41 8z"/></svg>',Jt.createElement("header",{className:"modal__header"},[Jt.createElement("span",{className:"modal__title"},this._title),t])}},{key:"renderContent",value:function(){}},{key:"keyDidPress",value:function(e){27===e.keyCode&&(e.preventDefault(),this.cancel())}}]),t}(Jt),rg=function(e){function t(e){var n;return ot(this,t),(n=pt(this,ct(t).call(this,"Library")))._library=e,n._filteredLibrary=e,n._categories={},n}return ut(t,e),lt(t,[{key:"clearFilter",value:function(){return this._filteredLibrary=this._library,this.refresh(),this}},{key:"applyFilter",value:function(e){return this._filteredLibrary=this._library.filter(e),this.refresh(),this}},{key:"render",value:function(){var e=vt(ct(t.prototype),"render",this).call(this);return e.classList.add("modal-library"),e}},{key:"renderContent",value:function(){return Jt.createElement("div",{className:"modal__content"},[this.renderBricks()])}},{key:"renderBricks",value:function(){var e=this,t=[],n=[];return this._filteredLibrary.forEach((function(e){var r=t.indexOf(e.category);-1===r?(t.push(e.category),n.push([e])):n[r].push(e)})),Jt.createElement("ul",{className:"modal-library__categories"},t.map((function(t,r){return Jt.createElement("li",{className:"modal-library__category"},[Jt.createElement("span",{className:"modal-library__category-title"},t),Jt.createElement("ul",{className:"modal-library__bricks"},n[r].map(e.renderBrick.bind(e)))])})))}},{key:"renderBrick",value:function(e){var t=this;return Jt.createElement("li",{},[Jt.createElement("button",{className:"modal-library__brick modal-library__brick--"+e.type,onClick:function(n){n.preventDefault(),t.finish(e.name)}},[Jt.createElement("span",{className:"modal-library__brick-title"},e.title)])])}}]),t}(ng),ig="pipe__scroll-handle--disabled",ag="application/vnd.cryptii.brick+json",og=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._$scrollable=null,e._$content=null,e._draggingBrickView=null,e._draggingTargetIndex=null,e._$pipeParts=[],e._pipePartPositions=[],e._pipePartIndex=[],e._scrollMax=0,e._scrollPosition=0,e._scrollHandleIndex=null,e._scrollHandleStartPosition=null,e._scrollHandleStartTime=null,e}return ut(t,e),lt(t,[{key:"render",value:function(){this._$content=Jt.createElement("div",{className:"pipe__content"}),this._$scrollHandleLeft=Jt.createElement("div",{className:"pipe__scroll-handle pipe__scroll-handle--left pipe__scroll-handle--disabled",onMouseEnter:this.scrollHandleDidStart.bind(this,0),onDragEnter:this.scrollHandleDidStart.bind(this,0),onMouseLeave:this.scrollHandleDidStop.bind(this),onDragLeave:this.scrollHandleDidStop.bind(this)}),this._$scrollHandleRight=Jt.createElement("div",{className:"pipe__scroll-handle pipe__scroll-handle--right",onMouseEnter:this.scrollHandleDidStart.bind(this,1),onDragEnter:this.scrollHandleDidStart.bind(this,1),onMouseLeave:this.scrollHandleDidStop.bind(this),onDragLeave:this.scrollHandleDidStop.bind(this)});var e=document.querySelector(".pipe");return null===e&&(e=Jt.createElement("div")).classList.add("pipe"),e.ondrop=this.dragDidDrop.bind(this),e.ondragenter=this.dragDidEnterPipe.bind(this),e.ondragover=this.dragDidOverPipe.bind(this),this._$scrollable=e.querySelector(".pipe__scrollable"),null===this._$scrollable&&(this._$scrollable=Jt.createElement("div",{className:"pipe__scrollable"})),this._$scrollable.appendChild(this._$content),this._$scrollable.appendChild(this._$scrollHandleLeft),this._$scrollable.appendChild(this._$scrollHandleRight),e.appendChild(this._$scrollable),e.addEventListener("wheel",this.mouseDidWheel.bind(this)),e}},{key:"appendSubviewElement",value:function(e){return e instanceof Nu?(this.update(),this):vt(ct(t.prototype),"appendSubviewElement",this).call(this,e)}},{key:"removeSubviewElement",value:function(e){return vt(ct(t.prototype),"removeSubviewElement",this).call(this,e),e instanceof Nu&&this.update(),this}},{key:"update",value:function(){var e=this.getModel().getBricks(),t=e.map((function(e){return e.getView()}));this.getElement();var n,r=this._$content;t.forEach((function(e){var t=e.getElement();t.parentNode&&t.parentNode.removeChild(t)})),r.innerHTML="",this._$pipeParts=[],this._pipePartIndex=[];for(var i=[],a=0;a<e.length;a++)if(e[a].isHidden()){if(i.push(e[a]),a+1===e.length||!e[a+1].isHidden()){var o=a-i.length+1;n=this._createPipePart(o),this._$pipeParts.push(n),this._pipePartIndex.push(o),r.appendChild(n),r.appendChild(this._createCollapsedPart(i)),i=[]}}else n=this._createPipePart(a),this._$pipeParts.push(n),this._pipePartIndex.push(a),r.appendChild(n),r.appendChild(this._createBrickPart(t[a]));return n=this._createPipePart(t.length),this._$pipeParts.push(n),this._pipePartIndex.push(t.length),r.appendChild(n),this.layout(),this}},{key:"_createPipePart",value:function(e){var t=this;return Jt.createElement("button",{className:"pipe__part-pipe",onClick:function(n){t.getModel().viewAddButtonDidClick(t,e),n.preventDefault()}},[Jt.createElement("div",{className:"pipe__btn-add"},"Add encoder or viewer"),Jt.createElement("div",{className:"pipe__drop-handle"})])}},{key:"_createBrickPart",value:function(e){var t=e.getModel()instanceof dc?"encoder":"viewer";return Jt.createElement("div",{className:"pipe__part-brick pipe__part-brick--".concat(t),draggable:!0,onMouseDown:this.brickDragWillStart.bind(this,e),onDragStart:this.brickDragDidStart.bind(this,e),onDragEnd:this.brickDragDidEnd.bind(this,e)},e.getElement())}},{key:"_createCollapsedPart",value:function(e){var t=this;return Jt.createElement("button",{className:"pipe__part-collapsed",onClick:function(n){t.getModel().viewHiddenBrickGroupDidClick(t,e),n.preventDefault()}},e.map((function(){return Jt.createElement("div",{className:"pipe__part-collapsed-fold"})})))}},{key:"isBrickDragEvent",value:function(e){var t=e.dataTransfer.types;return void 0!==t.contains?t.contains(ag):-1!==t.indexOf(ag)}},{key:"isFieldMouseEvent",value:function(e){var t=e.target.nodeName.toLowerCase();return-1!==["textarea","input"].indexOf(t)}},{key:"brickDragWillStart",value:function(e,t){if(this.isFieldMouseEvent(t)||!e.getModel().isValid()){var n=e.getElement().parentNode;n&&(n.draggable=!1,setTimeout((function(){n.draggable=!0}),500))}}},{key:"brickDragDidStart",value:function(e,t){if(!this.isFieldMouseEvent(t)&&e.getModel().isValid()){this._draggingBrickView=e;var n=JSON.stringify(e.getModel().serialize());t.dataTransfer.setData(ag,n),t.dataTransfer.setData("application/json",n),t.dataTransfer.effectAllowed="copyMove"}}},{key:"brickDragDidEnd",value:function(e,t){this._draggingBrickView=null,this.setDraggingPipePartIndex(null)}},{key:"dragDidEnterPipe",value:function(e){this.isBrickDragEvent(e)&&e.preventDefault()}},{key:"dragDidOverPipe",value:function(e){if(this.isBrickDragEvent(e)){e.preventDefault();var t=e.pageX+this._scrollPosition,n=e.pageY,r=null,i=0;this._pipePartPositions.forEach((function(e,a){var o=Math.sqrt(Math.pow(t-e.x,2)+Math.pow(n-e.y,2));(null===r||o<r)&&(r=o,i=a)})),this.setDraggingPipePartIndex(i)}}},{key:"dragDidDrop",value:function(e){if(this.isBrickDragEvent(e)){e.preventDefault();var t="copy"===e.dataTransfer.effectAllowed,n=this._pipePartIndex[this._draggingTargetIndex];if(this.setDraggingPipePartIndex(null),null!==this._draggingBrickView){var r=this._draggingBrickView.getModel();this.getModel().viewBrickDidDrop(this,n,r,t)}else{var i=JSON.parse(e.dataTransfer.getData(ag));this.getModel().viewBrickDidDrop(this,n,i,t)}}}},{key:"setDraggingPipePartIndex",value:function(e){this._draggingTargetIndex!==e&&(null!==this._draggingTargetIndex&&this._$pipeParts[this._draggingTargetIndex].classList.remove("pipe__part-pipe--dragging"),this._draggingTargetIndex=e,null!==e?(this._$pipeParts[this._draggingTargetIndex].classList.add("pipe__part-pipe--dragging"),this.getElement().classList.add("pipe--dragging")):this.getElement().classList.remove("pipe--dragging"))}},{key:"mouseDidWheel",value:function(e){var t=e.deltaX,n=e.deltaY;Math.abs(t)<=Math.abs(n)||(e.preventDefault(),this.scrollTo(this._scrollPosition+t))}},{key:"scrollHandleDidStart",value:function(e){this._scrollHandleIndex=e,this._scrollHandleStartPosition=this._scrollPosition,this._scrollHandleStartTime=(new Date).getTime(),window.requestAnimationFrame(this.scrollHandleDidScroll.bind(this))}},{key:"scrollHandleDidScroll",value:function(){if(null!==this._scrollHandleIndex){var e=0===this._scrollHandleIndex?-1:1,t=((new Date).getTime()-this._scrollHandleStartTime)/1e3,n=e*Math.pow(t,2)*1e3;this.scrollTo(this._scrollHandleStartPosition+n),window.requestAnimationFrame(this.scrollHandleDidScroll.bind(this))}}},{key:"scrollHandleDidStop",value:function(){this._scrollHandleIndex=null,this._scrollHandleStartPosition=null,this._scrollHandleStartTime=null}},{key:"layout",value:function(){var e=this;vt(ct(t.prototype),"layout",this).call(this),this._scrollMax=this._$content.offsetWidth-this._$scrollable.offsetWidth,this.scrollTo(this._scrollPosition),0===this._scrollPosition?this._$scrollHandleLeft.classList.add(ig):this._$scrollHandleLeft.classList.remove(ig),this._scrollPosition===this._scrollMax?this._$scrollHandleRight.classList.add(ig):this._$scrollHandleRight.classList.remove(ig);var n=window.scrollY;this._pipePartPositions=this._$pipeParts.map((function(t){var r=t.getBoundingClientRect();return{x:r.left+.5*r.width+e._scrollPosition,y:r.top+.5*r.height+n}}))}},{key:"scrollTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=parseInt(e),e=Math.max(Math.min(e,this._scrollMax),0),this._scrollPosition!==e&&(0===e?(this._$scrollHandleLeft.classList.add(ig),this.scrollHandleDidStop()):0===this._scrollPosition&&this._$scrollHandleLeft.classList.remove(ig),e===this._scrollMax?(this._$scrollHandleRight.classList.add(ig),this.scrollHandleDidStop()):this._scrollPosition===this._scrollMax&&this._$scrollHandleRight.classList.remove(ig),this._$content.style.transform=e>0?"translate(".concat(-e,"px, 0)"):"",this._scrollPosition=e),this}}]),t}(Jt),sg=function(e){function t(){var e;return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=og,e._brickFactory=null,e._service=null,e._id=null,e._url=null,e._title=null,e._description=null,e._bricks=[],e._brickState=[],e._bucketContent=[al.empty()],e._bucketListeners=[[]],e._selectedBucket=0,e._libraryModalView=null,e}return ut(t,e),lt(t,[{key:"getId",value:function(){return this._id}},{key:"setId",value:function(e){return this._id=e,this}},{key:"getUrl",value:function(){return this._url}},{key:"setUrl",value:function(e){return this._url=e,this}},{key:"getTitle",value:function(){return this._title}},{key:"setTitle",value:function(e){return this._title=e,this}},{key:"getDescription",value:function(){return this._description}},{key:"setDescription",value:function(e){return this._description=e,this}},{key:"getBrickFactory",value:function(){return this._brickFactory}},{key:"setBrickFactory",value:function(e){return this._brickFactory=e,this}},{key:"getService",value:function(){return this._service}},{key:"setService",value:function(e){return this._service=e,this}},{key:"getLibraryModalView",value:function(){if(null===this._libraryModalView){var e=this.getBrickFactory().getLibrary();this._libraryModalView=new rg(e)}return this._libraryModalView}},{key:"getLength",value:function(){return this._bricks.length}},{key:"getBricks",value:function(){return this._bricks.slice()}},{key:"getBrick",value:function(e){if(e<0||e>this._bricks.length)throw new Error("Brick index is out of bounds.");return this._bricks[e]}},{key:"containsBrick",value:function(e){return-1!==this._bricks.indexOf(e)}},{key:"addBrick",value:function(e){return this.spliceBricks(-1,0,[e]),this}},{key:"addBricks",value:function(e){return this.spliceBricks(-1,0,e),this}},{key:"duplicateBrick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.containsBrick(e))throw new Error("Brick is not part of the pipe.");return null===t&&(t=this._bricks.indexOf(e)),this.spliceBricks(t,0,[e.copy()]),this}},{key:"moveBrick",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Brick is not part of the pipe.");return t>n&&t--,this.spliceBricks(n,1),this.spliceBricks(t,0,[e]),this}},{key:"removeBrick",value:function(e){var t=e;if(e instanceof uc&&-1===(t=this._bricks.indexOf(e)))throw new Error("Brick is not part of the pipe and thus can't be removed.");return this.spliceBricks(t,1),this}},{key:"removeBricks",value:function(e){var t=this;return e.map((function(e){var n=e;if(e instanceof uc&&-1===(n=t._bricks.indexOf(e)))throw new Error("Brick is not part of the pipe and thus can't be removed.");return n})).sort((function(e,t){return t-e})).forEach((function(e){return t.spliceBricks(e,1)})),this}},{key:"replaceBrick",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Can't replace a brick not being part of the pipe.");return this.spliceBricks(n,1,[t]),this}},{key:"spliceBricks",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e=e>=0?e:Math.max(this._bricks.length+e+1,0),this._bucketListeners.map((function(e){return e.forEach((function(e){return e.reject("Pipe bricks have been changed.")})),[]})),r=r.map((function(e){return e instanceof uc?e:uc.extract(e,n.getBrickFactory())}));var i=this._bricks.splice.apply(this._bricks,[e,t].concat(r));this._brickState.splice.apply(this._brickState,[e,t].concat(r.map((function(){return{settingsVersion:1,busy:!1}}))));var a=0,o=0;if(r.forEach((function(e){e.setPipe(n),n.hasView()&&n.getView().addSubview(e.getView()),e instanceof dc&&a++,Ou.trigger("pipeAddBrick",{pipe:n,brick:e})})),i.forEach((function(e){n.hasView()&&n.getView().removeSubview(e.getView()),e.setPipe(null),e instanceof dc&&o++,Ou.trigger("pipeRemoveBrick",{pipe:n,brick:e})})),a>0||o>0){var s=this._bricks.reduce((function(t,n,r){return t+(n instanceof dc&&r<=e?1:0)}),0);0===s&&(s=1);var l=new Array(a).fill().map((function(){return al.empty()})),u=this._bucketContent.splice.apply(this._bucketContent,[s,o].concat(l));if(this._bucketListeners.splice.apply(this._bucketListeners,[s,o].concat(l.map((function(e){return[]})))),this._selectedBucket<=s-1)this._propagateContent(s-1,!0);else if(this._selectedBucket===s&&1===o&&1===a)this._bucketContent[this._selectedBucket]=u[0],this._propagateContent(this._selectedBucket,!1);else if(this._selectedBucket<=s-1+o)this._selectedBucket=s-1,this._propagateContent(this._selectedBucket,!0);else{var c=a-o;this._selectedBucket+=c,this._propagateContent(s+a,!1)}}else r.forEach((function(e){return n._triggerViewerView(e)}));return this.hasView()&&this.getView().layout(),i}},{key:"getBucketLength",value:function(){return this._bucketContent.length}},{key:"getContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t>=this._bucketContent.length)throw new Error("Bucket index ".concat(t," is out of bounds."));return n&&this.isBusy()?new Promise((function(n,r){e._bucketListeners[t].push({resolve:n,reject:r})})):this._bucketContent[t]}},{key:"setContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e=al.wrap(e),this.getContent(t,!1).isEqualTo(e)?this:(this._bucketContent[t]=e,(null===n||n instanceof Lh)&&(this._selectedBucket=t),this._propagateContent(t,n),this)}},{key:"_propagateContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBricksAttachedToBucket(e),r=n.lowerEncoder,i=n.upperEncoder,a=n.viewers;return a.filter((function(e){return e!==t})).forEach(this._triggerViewerView.bind(this)),null!==r&&!0!==t&&r!==t&&this._triggerEncoderTranslation(r,!1),null!==i&&!1!==t&&i!==t&&this._triggerEncoderTranslation(i,!0),this}},{key:"_triggerViewerView",value:function(e){var t,n,r,i,a,o;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._getBrickState(e,"busy")){s.next=2;break}return s.abrupt("return",this);case 2:return this._setBrickState(e,"busy",!0),t=this.getBucketIndexForBrick(e),n=this.getContent(t,!1),r=this._getBrickState(e,"settingsVersion"),s.prev=6,s.next=9,regeneratorRuntime.awrap(e.view(n));case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(6),i=s.t0;case 14:if(this.containsBrick(e)){s.next=16;break}return s.abrupt("return");case 16:if(this._setBrickState(e,"busy",!1),a=this._getBrickState(e,"settingsVersion"),o=this.getBucketIndexForBrick(e),this.getContent(o,!1).isEqualTo(n)&&r===a||this._triggerViewerView(e),this.brickDidFinish(e,i),!i||i instanceof Js){s.next=23;break}throw i;case 23:case"end":return s.stop()}}),null,this,[[6,11]])}},{key:"_triggerEncoderTranslation",value:function(e,t){var n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(!this._getBrickState(e,"busy")){d.next=2;break}return d.abrupt("return",this);case 2:return this._setBrickState(e,"busy",!0),n=this.getBucketIndexForBrick(e),r=this.getContent(n+(t?0:1),!1),i=this._getBrickState(e,"settingsVersion"),d.prev=6,d.next=9,regeneratorRuntime.awrap(e.translate(r,t));case 9:a=d.sent,d.next=15;break;case 12:d.prev=12,d.t0=d.catch(6),o=d.t0;case 15:if(this.containsBrick(e)){d.next=17;break}return d.abrupt("return");case 17:if(this._setBrickState(e,"busy",!1),s=this._getBrickState(e,"settingsVersion"),l=this.getBucketIndexForBrick(e),u=l+(t?0:1),c=this.getContent(u,!1),h=l+(t?1:0),!(t&&this._selectedBucket>=h||!t&&this._selectedBucket<=h)){d.next=26;break}return this._triggerEncoderTranslation(e,!t),d.abrupt("return");case 26:if(o||this.setContent(a,h,e),c.isEqualTo(r)&&i===s||this._triggerEncoderTranslation(e,t),this.brickDidFinish(e,o),!o||o instanceof Js){d.next=31;break}throw o;case 31:case"end":return d.stop()}}),null,this,[[6,12]])}},{key:"_getBrickState",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Brick is not part of the pipe and thus has no state.");return this._brickState[n][t]}},{key:"_setBrickState",value:function(e,t,n){var r=this._bricks.indexOf(e);if(-1===r)throw new Error("Brick is not part of the pipe and thus has no state.");return this._brickState[r][t]=n,this}},{key:"isBusy",value:function(){var e=this;return this._bricks.reduce((function(t,n){return t||e._getBrickState(n,"busy")}),!1)}},{key:"getBucketIndexForBrick",value:function(e){for(var t=!1,n=0,r=-1;!t&&++r<this._bricks.length;)this._bricks[r]===e?t=!0:this._bricks[r]instanceof dc&&n++;if(!t)throw new Error("Can't find bucket for brick. Brick is not part of Pipe.");return n}},{key:"getBricksAttachedToBucket",value:function(e){for(var t,n=null,r=null,i=[],a=0,o=-1;++o<this._bricks.length&&a<=e;)(t=this._bricks[o])instanceof dc?(a===e-1?n=t:a===e&&(r=t),a++):a===e&&i.push(t);return{lowerEncoder:n,upperEncoder:r,viewers:i}}},{key:"viewerContentDidChange",value:function(e,t){if(this.containsBrick(e)){var n=this.getBucketIndexForBrick(e);this.setContent(t,n,e)}}},{key:"brickVisibilityDidChange",value:function(e,t){this.updateView()}},{key:"brickSettingDidChange",value:function(e){if(this.containsBrick(e))if(this._setBrickState(e,"settingsVersion",this._getBrickState(e,"settingsVersion")+1),e instanceof dc){var t=this.getBucketIndexForBrick(e),n=this._selectedBucket<=t;this._triggerEncoderTranslation(e,n)}else this._triggerViewerView(e)}},{key:"encoderDidReverse",value:function(e,t){if(3===this._bricks.length&&"viewer"===this._bricks[0].getMeta().type&&"encoder"===this._bricks[1].getMeta().type&&"viewer"===this._bricks[2].getMeta().type){var n=this.getContent(1,!1),r=this.spliceBricks(0,3);r.reverse(),this.setContent(n,0),this.spliceBricks(0,0,r)}else this.brickSettingDidChange(e)}},{key:"brickDidFinish",value:function(e,t){var n=this;this.isBusy()||this._bucketListeners.map((function(e,r){return e.forEach((function(e){return null!==t?e.resolve(n.getContent(r,!1)):e.reject(t)})),[]}))}},{key:"brickReplaceButtonDidClick",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if((t=this.getLibraryModalView()).applyFilter((function(t){return t.type===e.getMeta().type})),!t.isVisible()){i.next=4;break}return i.abrupt("return");case 4:return n=e.getMeta().name,i.prev=5,i.next=8,regeneratorRuntime.awrap(t.prompt(n));case 8:n=i.sent,i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(5),i.abrupt("return");case 14:n!==e.getMeta().name&&(r=this.getBrickFactory().create(n),e instanceof dc&&r instanceof dc&&r.setReverse(e.isReverse()),this.replaceBrick(e,r));case 15:case"end":return i.stop()}}),null,this,[[5,11]])}},{key:"viewAddButtonDidClick",value:function(e,t){var n,r,i;return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return Ou.trigger("pipeAddButtonClick",{pipe:this,index:t}),(n=this.getLibraryModalView()).clearFilter(),e.prev=3,e.next=6,regeneratorRuntime.awrap(n.prompt());case 6:r=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return");case 12:i=this.getBrickFactory().create(r),this.spliceBricks(t,0,[i]);case 14:case"end":return e.stop()}}),null,this,[[3,9]])}},{key:"viewBrickDidDrop",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n instanceof uc?r?this.duplicateBrick(n,t):this.moveBrick(n,t):this.spliceBricks(t,0,[n]),Ou.trigger("pipeBrickDrop",{pipe:this,index:t,brick:n,copy:r})}},{key:"viewHiddenBrickGroupDidClick",value:function(e,t){t.forEach((function(e){return e.setHidden(!1)})),Ou.trigger("pipeHiddenBrickGroupClick",{pipe:this,bricks:t})}},{key:"didCreateView",value:function(e){this._bricks.forEach((function(t){return e.addSubview(t.getView())}))}},{key:"store",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.getService().storePipe(this));case 2:return e=t.sent,t.abrupt("return",e.url);case 4:case"end":return t.stop()}}),null,this)}},{key:"serialize",value:function(){var e={};null!==this._id&&(e.id=this._id),null!==this._url&&(e.url=this._url),null!==this._title&&(e.title=this._title),null!==this._description&&(e.description=this._description),e.items=this._bricks.map((function(e){return e.serialize()}));var t=this._selectedBucket,n=this._bucketContent[t];if(!n.isEmpty()||t>0){e.content={},n.needsTextEncoding()?(e.content.data=tl.base64StringFromBytes(n.getBytes()),e.content.encoding="base64"):e.content.data=n.getString();var r=this.getBricksAttachedToBucket(t).lowerEncoder;null!==r&&(e.content.index=this._bricks.indexOf(r)+1)}return e}}],[{key:"extract",value:function(e,n){if(!Array.isArray(e.items)||0===e.items.length)throw new Error("Pipe property 'items' is expected to be of type 'array' and must not be empty");var r=new t;if(r.setBrickFactory(n),r.addBricks(e.items),void 0!==e.id&&null!==e.id){if("number"!=typeof e.id)throw new Error("Optional pipe property 'id' is expected to be of type 'number'");r.setId(e.id)}if(void 0!==e.url&&null!==e.url){if("string"!=typeof e.url)throw new Error("Optional pipe property 'url' is expected to be of type 'string'");r.setUrl(e.url)}if(void 0!==e.title&&null!==e.title){if("string"!=typeof e.title)throw new Error("Optional pipe property 'title' is expected to be of type 'string'");r.setTitle(e.title)}if(void 0!==e.description&&null!==e.description){if("string"!=typeof e.description)throw new Error("Optional pipe property 'description' is expected to be of type 'string'");r.setDescription(e.description)}var i="",a=0;if(void 0!==e.content&&null!==e.content){if("object"!==at(e.content))throw new Error("Optional pipe property 'content' is expected to be of type 'object'");if(void 0===e.content.data||"string"!=typeof e.content.data)throw new Error("Pipe property 'content.data' is expected to be of type 'string'");if(void 0!==e.content.encoding&&"string"!=typeof e.content.encoding)throw new Error("Optional pipe property 'content.encoding' is expected to be of type 'string'");if(void 0!==e.content.index&&"number"!=typeof e.content.index)throw new Error("Optional pipe property 'content.index' is expected to be of type 'number'");var o=e.content.encoding||"text";switch(o){case"text":i=e.content.data;break;case"base64":i=tl.bytesFromBase64String(e.content.data);break;default:throw new Error("Optional pipe property 'content.encoding' is set to an unsupported "+"encoding '".concat(o,"'; Supported values: text, base64"))}var s=e.content.index||0;if(s===r.getLength())a=r.getBucketLength()-1;else{if(!(s>=0&&s<r.getLength()))throw new Error("Optional pipe property 'content.index' is expected to be a number "+"ranging from 0 to ".concat(r.getBucketLength()-1));a=r.getBucketIndexForBrick(r.getBrick(s))}}return r.setContent(i,a),r}}]),t}(Fu),lg="v1",ug=function(){function e(t){ot(this,e),this._rootEndpoint="".concat(t,"/").concat(lg)}return lt(e,[{key:"createSession",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(window.fetch("".concat(this._rootEndpoint,"/session")));case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Unable to create a session");case 5:return t.abrupt("return",e.json());case 6:case"end":return t.stop()}}),null,this)}},{key:"storePipe",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.createSession());case 2:return t=i.sent,i.next=5,regeneratorRuntime.awrap(window.fetch("".concat(this._rootEndpoint,"/pipes"),{method:"POST",headers:{"Content-type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify(e.serialize())}));case 5:if((n=i.sent).ok){i.next=8;break}throw new Error("Unable to store this pipe");case 8:return i.next=10,regeneratorRuntime.awrap(n.json());case 10:if(void 0===(r=i.sent).error){i.next=13;break}throw new Error("Unable to store this pipe: "+r.error.message);case 13:return i.abrupt("return",r);case 14:case"end":return i.stop()}}),null,this)}}]),e}(),cg={version:"4.0.8+master.008b8a3",scope:"/",serviceEndpoint:"https://cryptii.com/api",serviceWorkerUrl:null},hg=null,dg=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ot(this,t),(e=pt(this,ct(t).call(this)))._viewPrototype=Qt,e._pipe=null,e._config=Object.assign(cg,n),e._service=new ug(e._config.serviceEndpoint),hg=gt(e),e}return ut(t,e),lt(t,[{key:"run",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;nh.placeBrowserAttribute(),null!==t?this._pipe=sg.extract(t,tg.getInstance()):(this._pipe=new sg,this._pipe.setBrickFactory(tg.getInstance())),this._pipe.setService(this._service);var n=this.getView();return n.layout(),setTimeout(n.layout.bind(n),100),"undefined"!=typeof navigator&&"serviceWorker"in navigator&&(this._config.serviceWorkerUrl?navigator.serviceWorker.register(this._config.serviceWorkerUrl,{scope:this._config.scope}):navigator.serviceWorker.getRegistrations().then((function(e){return e.forEach((function(e){return e.unregister()}))}))),nh.isBrowser()&&document.addEventListener("keydown",(function(t){t.ctrlKey&&"i"===t.key&&(t.preventDefault(),alert(e.debug()))})),this}},{key:"debug",value:function(){return JSON.stringify({version:this._config.version,env:nh.identify(),pipe:this.getPipe().serialize()})}},{key:"getPipe",value:function(){return this._pipe}},{key:"didCreateView",value:function(e){e.addSubview(this._pipe.getView())}}],[{key:"getInstance",value:function(){return hg}}]),t}(Fu);if(nh.isBrowser()&&null!==document.querySelector("script[data-cryptii-init]")){var fg=function(){var e=document.querySelector("script[data-cryptii-pipe]"),t=null!==e?JSON.parse(e.innerHTML):null,n=document.querySelector("script[data-cryptii-config]"),r=null!==n?JSON.parse(n.innerHTML):{};new dg(r).run(t)};"loading"!==document.readyState?fg():window.addEventListener("DOMContentLoaded",fg)}e.App=dg,e.ArrayUtil=Ss,e.Brick=uc,e.BrickFactory=tg,e.ByteEncoder=tl,e.ByteEncodingError=Qs,e.Chain=al,e.Encoder=dc,e.EnvUtil=nh,e.EventManager=Ou,e.Factory=on,e.Field=Du,e.FieldFactory=sc,e.Form=lc,e.GenericError=Ys,e.InvalidInputError=Js,e.LibraryModalView=rg,e.MathUtil=hc,e.ModalView=ng,e.Pipe=sg,e.Random=_s,e.StringUtil=Xs,e.TextEncoder=rl,e.TextEncodingError=nl,e.View=Jt,e.Viewable=Fu,e.Viewer=Lh,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=cryptii.js.map
