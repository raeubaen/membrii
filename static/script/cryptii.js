/*! cryptii v4.0.8+master.8c1558b - (c) Fränz Friederes 2020 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("crypto")):"function"==typeof define&&define.amd?define("cryptii",["exports","crypto"],t):t((e=e||self).cryptii={},e.crypto)}(this,(function(e,t){t=t&&t.hasOwnProperty("default")?t.default:t;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}var i,a,o,s=function(e){return e&&e.Math==Math&&e},l=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof n&&n)||Function("return this")(),u=function(e){try{return!!e()}catch(e){return!0}},c=!u((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),h={}.propertyIsEnumerable,d=Object.getOwnPropertyDescriptor,f={f:d&&!h.call({1:2},1)?function(e){var t=d(this,e);return!!t&&t.enumerable}:h},g=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},p={}.toString,v=function(e){return p.call(e).slice(8,-1)},m="".split,b=u((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==v(e)?m.call(e,""):Object(e)}:Object,k=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},w=function(e){return b(k(e))},_=function(e){return"object"==typeof e?null!==e:"function"==typeof e},S=function(e,t){if(!_(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!_(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!_(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!_(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},x={}.hasOwnProperty,V=function(e,t){return x.call(e,t)},I=l.document,C=_(I)&&_(I.createElement),E=function(e){return C?I.createElement(e):{}},A=!c&&!u((function(){return 7!=Object.defineProperty(E("div"),"a",{get:function(){return 7}}).a})),M=Object.getOwnPropertyDescriptor,T={f:c?M:function(e,t){if(e=w(e),t=S(t,!0),A)try{return M(e,t)}catch(e){}if(V(e,t))return g(!f.f.call(e,t),e[t])}},L=function(e){if(!_(e))throw TypeError(String(e)+" is not an object");return e},P=Object.defineProperty,B={f:c?P:function(e,t,n){if(L(e),t=S(t,!0),L(n),A)try{return P(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},z=c?function(e,t,n){return B.f(e,t,g(1,n))}:function(e,t,n){return e[t]=n,e},O=function(e,t){try{z(l,e,t)}catch(n){l[e]=t}return t},F=l["__core-js_shared__"]||O("__core-js_shared__",{}),N=r((function(e){(e.exports=function(e,t){return F[e]||(F[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.4.1",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),R=N("native-function-to-string",Function.toString),D=l.WeakMap,j="function"==typeof D&&/native code/.test(R.call(D)),q=0,$=Math.random(),U=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++q+$).toString(36)},W=N("keys"),G=function(e){return W[e]||(W[e]=U(e))},H={},K=l.WeakMap;if(j){var Z=new K,X=Z.get,Y=Z.has,J=Z.set;i=function(e,t){return J.call(Z,e,t),t},a=function(e){return X.call(Z,e)||{}},o=function(e){return Y.call(Z,e)}}else{var Q=G("state");H[Q]=!0,i=function(e,t){return z(e,Q,t),t},a=function(e){return V(e,Q)?e[Q]:{}},o=function(e){return V(e,Q)}}var ee={set:i,get:a,has:o,enforce:function(e){return o(e)?a(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!_(t)||(n=a(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},te=r((function(e){var t=ee.get,n=ee.enforce,r=String(R).split("toString");N("inspectSource",(function(e){return R.call(e)})),(e.exports=function(e,t,i,a){var o=!!a&&!!a.unsafe,s=!!a&&!!a.enumerable,u=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||V(i,"name")||z(i,"name",t),n(i).source=r.join("string"==typeof t?t:"")),e!==l?(o?!u&&e[t]&&(s=!0):delete e[t],s?e[t]=i:z(e,t,i)):s?e[t]=i:O(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||R.call(this)}))})),ne=l,re=function(e){return"function"==typeof e?e:void 0},ie=function(e,t){return arguments.length<2?re(ne[e])||re(l[e]):ne[e]&&ne[e][t]||l[e]&&l[e][t]},ae=Math.ceil,oe=Math.floor,se=function(e){return isNaN(e=+e)?0:(e>0?oe:ae)(e)},le=Math.min,ue=function(e){return e>0?le(se(e),9007199254740991):0},ce=Math.max,he=Math.min,de=function(e,t){var n=se(e);return n<0?ce(n+t,0):he(n,t)},fe=function(e){return function(t,n,r){var i,a=w(t),o=ue(a.length),s=de(r,o);if(e&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},ge={includes:fe(!0),indexOf:fe(!1)},pe=ge.indexOf,ve=function(e,t){var n,r=w(e),i=0,a=[];for(n in r)!V(H,n)&&V(r,n)&&a.push(n);for(;t.length>i;)V(r,n=t[i++])&&(~pe(a,n)||a.push(n));return a},ye=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],me=ye.concat("length","prototype"),be={f:Object.getOwnPropertyNames||function(e){return ve(e,me)}},ke={f:Object.getOwnPropertySymbols},we=ie("Reflect","ownKeys")||function(e){var t=be.f(L(e)),n=ke.f;return n?t.concat(n(e)):t},_e=function(e,t){for(var n=we(t),r=B.f,i=T.f,a=0;a<n.length;a++){var o=n[a];V(e,o)||r(e,o,i(t,o))}},Se=/#|\.prototype\./,xe=function(e,t){var n=Ie[Ve(e)];return n==Ee||n!=Ce&&("function"==typeof t?u(t):!!t)},Ve=xe.normalize=function(e){return String(e).replace(Se,".").toLowerCase()},Ie=xe.data={},Ce=xe.NATIVE="N",Ee=xe.POLYFILL="P",Ae=xe,Me=T.f,Te=function(e,t){var n,r,i,a,o,s=e.target,u=e.global,c=e.stat;if(n=u?l:c?l[s]||O(s,{}):(l[s]||{}).prototype)for(r in t){if(a=t[r],i=e.noTargetGet?(o=Me(n,r))&&o.value:n[r],!Ae(u?r:s+(c?".":"#")+r,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;_e(a,i)}(e.sham||i&&i.sham)&&z(a,"sham",!0),te(n,r,a,e)}},Le=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Pe=function(e,t,n){if(Le(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},Be=function(e){return Object(k(e))},ze=Array.isArray||function(e){return"Array"==v(e)},Oe=!!Object.getOwnPropertySymbols&&!u((function(){return!String(Symbol())})),Fe=l.Symbol,Ne=N("wks"),Re=function(e){return Ne[e]||(Ne[e]=Oe&&Fe[e]||(Oe?Fe:U)("Symbol."+e))},De=Re("species"),je=function(e,t){var n;return ze(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!ze(n.prototype)?_(n)&&null===(n=n[De])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},qe=[].push,$e=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,a=6==e,o=5==e||a;return function(s,l,u,c){for(var h,d,f=Be(s),g=b(f),p=Pe(l,u,3),v=ue(g.length),y=0,m=c||je,k=t?m(s,v):n?m(s,0):void 0;v>y;y++)if((o||y in g)&&(d=p(h=g[y],y,f),e))if(t)k[y]=d;else if(d)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:qe.call(k,h)}else if(i)return!1;return a?-1:r||i?i:k}},Ue={forEach:$e(0),map:$e(1),filter:$e(2),some:$e(3),every:$e(4),find:$e(5),findIndex:$e(6)},We=function(e,t){var n=[][e];return!n||!u((function(){n.call(null,t||function(){throw 1},1)}))},Ge=Ue.forEach,He=We("forEach")?function(e){return Ge(this,e,arguments.length>1?arguments[1]:void 0)}:[].forEach;Te({target:"Array",proto:!0,forced:[].forEach!=He},{forEach:He});var Ke=Object.keys||function(e){return ve(e,ye)},Ze=Object.assign,Xe=!Ze||u((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=Ze({},e)[n]||"abcdefghijklmnopqrst"!=Ke(Ze({},t)).join("")}))?function(e,t){for(var n=Be(e),r=arguments.length,i=1,a=ke.f,o=f.f;r>i;)for(var s,l=b(arguments[i++]),u=a?Ke(l).concat(a(l)):Ke(l),h=u.length,d=0;h>d;)s=u[d++],c&&!o.call(l,s)||(n[s]=l[s]);return n}:Ze;Te({target:"Object",stat:!0,forced:Object.assign!==Xe},{assign:Xe});var Ye={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var Je in Ye){var Qe=l[Je],et=Qe&&Qe.prototype;if(et&&et.forEach!==He)try{z(et,"forEach",He)}catch(e){et.forEach=He}}function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),e}function at(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e,t,n){return(lt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&st(i,n.prototype),i}).apply(null,arguments)}function ut(e){var t="function"==typeof Map?new Map:void 0;return(ut=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return lt(e,arguments,ot(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),st(r,e)})(e)}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ht(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?ct(e):t}function dt(e,t,n){return(dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ot(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var gt,pt,vt=ie("navigator","userAgent")||"",yt=l.process,mt=yt&&yt.versions,bt=mt&&mt.v8;bt?pt=(gt=bt.split("."))[0]+gt[1]:vt&&(!(gt=vt.match(/Edge\/(\d+)/))||gt[1]>=74)&&(gt=vt.match(/Chrome\/(\d+)/))&&(pt=gt[1]);var kt=pt&&+pt,wt=Re("species"),_t=function(e){return kt>=51||!u((function(){var t=[];return(t.constructor={})[wt]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},St=Ue.filter;Te({target:"Array",proto:!0,forced:!_t("filter")},{filter:function(e){return St(this,e,arguments.length>1?arguments[1]:void 0)}});var xt=ge.indexOf,Vt=[].indexOf,It=!!Vt&&1/[1].indexOf(1,-0)<0,Ct=We("indexOf");Te({target:"Array",proto:!0,forced:It||Ct},{indexOf:function(e){return It?Vt.apply(this,arguments)||0:xt(this,e,arguments.length>1?arguments[1]:void 0)}});var Et=function(e,t,n){var r=S(t);r in e?B.f(e,r,g(0,n)):e[r]=n},At=Math.max,Mt=Math.min;Te({target:"Array",proto:!0,forced:!_t("splice")},{splice:function(e,t){var n,r,i,a,o,s,l=Be(this),u=ue(l.length),c=de(e,u),h=arguments.length;if(0===h?n=r=0:1===h?(n=0,r=u-c):(n=h-2,r=Mt(At(se(t),0),u-c)),u+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(i=je(l,r),a=0;a<r;a++)(o=c+a)in l&&Et(i,a,l[o]);if(i.length=r,n<r){for(a=c;a<u-r;a++)s=a+n,(o=a+r)in l?l[s]=l[o]:delete l[s];for(a=u;a>u-r+n;a--)delete l[a-1]}else if(n>r)for(a=u-r;a>c;a--)s=a+n-1,(o=a+r-1)in l?l[s]=l[o]:delete l[s];for(a=0;a<n;a++)l[a+c]=arguments[a+2];return l.length=u-r+n,i}});var Tt=Date.prototype,Lt=Tt.toString,Pt=Tt.getTime;new Date(NaN)+""!="Invalid Date"&&te(Tt,"toString",(function(){var e=Pt.call(this);return e==e?Lt.call(this):"Invalid Date"}));var Bt=u((function(){Ke(1)}));Te({target:"Object",stat:!0,forced:Bt},{keys:function(e){return Ke(Be(e))}});var zt=Re("toStringTag"),Ot="Arguments"==v(function(){return arguments}()),Ft=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),zt))?n:Ot?v(t):"Object"==(r=v(t))&&"function"==typeof t.callee?"Arguments":r},Nt={};Nt[Re("toStringTag")]="z";var Rt="[object z]"!==String(Nt)?function(){return"[object "+Ft(this)+"]"}:Nt.toString,Dt=Object.prototype;Rt!==Dt.toString&&te(Dt,"toString",Rt,{unsafe:!0});var jt=function(){var e=L(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},qt=RegExp.prototype,$t=qt.toString,Ut=u((function(){return"/a/b"!=$t.call({source:"a",flags:"b"})})),Wt="toString"!=$t.name;(Ut||Wt)&&te(RegExp.prototype,"toString",(function(){var e=L(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in qt)?jt.call(e):n)}),{unsafe:!0});var Gt={role:"role",ariaHidden:"aria-hidden",ariaLabel:"aria-label"},Ht=function(){function e(){nt(this,e),this._$root=null,this._superview=null,this._subviews=[],this._model=null,this._focus=!1,this._needsUpdate=!1}return it(e,null,[{key:"createElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=document.createElement(e);if(Object.keys(t).forEach((function(e){var n=t[e];if(void 0===Gt[e]){var i=0===e.indexOf("on")?e.toLowerCase():e;r[i]=n}else r.setAttribute(Gt[e],n)})),null!==n)switch(Object.prototype.toString.call(n)){case"[object String]":r.innerText=n;break;case"[object Array]":n.forEach((function(e){return e&&r.appendChild(e)}));break;default:r.appendChild(n)}return r}}]),it(e,[{key:"getElement",value:function(){return null===this._$root&&(this.willRender(),this._$root=this.render(),this.didRender()),this._$root}},{key:"refresh",value:function(){var e=this._$root;return null===e?this:(this._$root=null,this.willRender(),this._$root=this.render(),this.didRender(),this.getSubviews().forEach(this.appendSubviewElement),e&&e.parentNode&&e.parentNode.replaceChild(this._$root,e),this)}},{key:"render",value:function(){return e.createElement("div")}},{key:"setNeedsUpdate",value:function(){var e=this;return this._needsUpdate||(this._needsUpdate=!0,window.requestAnimationFrame((function(){e._needsUpdate=!1,e.update()}))),this}},{key:"update",value:function(){}},{key:"willRender",value:function(){}},{key:"didRender",value:function(){this.update()}},{key:"layout",value:function(){return this._subviews.forEach((function(e){return e.layout()})),this}},{key:"addSubview",value:function(e){e.removeFromSuperview(),this.appendSubviewElement(e),e.setSuperview(this),this._subviews.push(e)}},{key:"getSubviews",value:function(){return this._subviews}},{key:"appendSubviewElement",value:function(e){return e.getElement().parentNode!==this.getElement()&&this.getElement().appendChild(e.getElement()),this}},{key:"removeSubview",value:function(e){var t=this._subviews.indexOf(e);-1!==t&&(this._subviews.splice(t,1),e.setSuperview(null),this.removeSubviewElement(e))}},{key:"removeSubviewElement",value:function(e){var t=e.getElement();return null!==t.parentNode&&t.parentNode.removeChild(e.getElement()),this}},{key:"removeFromSuperview",value:function(){return null!==this._superview&&this._superview.removeSubview(this),this}},{key:"getSuperview",value:function(){return this._superview}},{key:"setSuperview",value:function(e){return this._superview=e,this}},{key:"focus",value:function(){return this.setFocus(!0)}},{key:"blur",value:function(){return this.setFocus(!1)}},{key:"setFocus",value:function(e){return e!==this._focus&&(this._focus=e,e?(null!==this._superview&&this._superview.subviewDidFocus(this),this.didFocus()):(this._subviews.forEach((function(e){return e.blur()})),this.didBlur())),this}},{key:"hasFocus",value:function(){return this._focus}},{key:"subviewDidFocus",value:function(e){this.hasFocus()?this._subviews.filter((function(t){return t!==e})).forEach((function(e){return e.blur()})):this.focus()}},{key:"didFocus",value:function(){}},{key:"didBlur",value:function(){}},{key:"getModel",value:function(){return this._model}},{key:"hasModel",value:function(){return null!==this._model}},{key:"setModel",value:function(e){return this._model=e,this}}]),e}(),Kt=function(e){function t(){return nt(this,t),ht(this,ot(t).apply(this,arguments))}return at(t,e),it(t,[{key:"render",value:function(){var e=document.querySelector(".app");return window.addEventListener("resize",this.windowDidResize.bind(this),!1),e}},{key:"windowDidResize",value:function(e){this.layout()}}]),t}(Ht),Zt=Ue.map;Te({target:"Array",proto:!0,forced:!_t("map")},{map:function(e){return Zt(this,e,arguments.length>1?arguments[1]:void 0)}});var Xt=B.f,Yt=Function.prototype,Jt=Yt.toString,Qt=/^\s*function ([^ (]*)/;!c||"name"in Yt||Xt(Yt,"name",{configurable:!0,get:function(){try{return Jt.call(this).match(Qt)[1]}catch(e){return""}}});var en=function(){function e(){nt(this,e),this._identifiers=[],this._invokables=[]}return it(e,[{key:"getIdentifiers",value:function(){return this._identifiers}},{key:"getInvokable",value:function(e){var t=this._identifiers.indexOf(e);if(-1===t)throw new Error("Invokable for '".concat(e,"' has not been registered yet."));return this._invokables[t]}},{key:"register",value:function(e,t){if(this.exists(e))throw new Error("Invokable can't be registered. "+"Identifier ".concat(e," already exists."));return this._identifiers.push(e),this._invokables.push(t),this}},{key:"exists",value:function(e){return-1!==this._identifiers.indexOf(e)}},{key:"create",value:function(e){if(!this.exists(e))throw new Error("Can't create '".concat(e,"', invokable has not been registered."));for(var t=this._identifiers.indexOf(e),n=this._invokables[t],r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i.splice(0,0,n),new(Function.prototype.bind.apply(n,i))}}],[{key:"getInstance",value:function(){}}]),e}(),tn="\t\n\v\f\r                　\u2028\u2029\ufeff",nn="["+tn+"]",rn=RegExp("^"+nn+nn+"*"),an=RegExp(nn+nn+"*$"),on=function(e){return function(t){var n=String(k(t));return 1&e&&(n=n.replace(rn,"")),2&e&&(n=n.replace(an,"")),n}},sn={start:on(1),end:on(2),trim:on(3)},ln=sn.trim,un=l.parseInt,cn=/^[+-]?0[Xx]/,hn=8!==un(tn+"08")||22!==un(tn+"0x16")?function(e,t){var n=ln(String(e));return un(n,t>>>0||(cn.test(n)?16:10))}:un;Te({global:!0,forced:parseInt!=hn},{parseInt:hn});var dn=[].join,fn=b!=Object,gn=We("join",",");Te({target:"Array",proto:!0,forced:fn||gn},{join:function(e){return dn.call(w(this),void 0===e?",":e)}});var pn=RegExp.prototype.exec,vn=String.prototype.replace,yn=pn,mn=function(){var e=/a/,t=/b*/g;return pn.call(e,"a"),pn.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),bn=void 0!==/()??/.exec("")[1];(mn||bn)&&(yn=function(e){var t,n,r,i,a=this;return bn&&(n=new RegExp("^"+a.source+"$(?!\\s)",jt.call(a))),mn&&(t=a.lastIndex),r=pn.call(a,e),mn&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),bn&&r&&r.length>1&&vn.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var kn=yn;Te({target:"RegExp",proto:!0,forced:/./.exec!==kn},{exec:kn});var wn=Re("species"),_n=!u((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),Sn=!u((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),xn=function(e,t,n,r){var i=Re(e),a=!u((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),o=a&&!u((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[wn]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!a||!o||"replace"===e&&!_n||"split"===e&&!Sn){var s=/./[i],l=n(i,""[e],(function(e,t,n,r,i){return t.exec===kn?a&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),c=l[0],h=l[1];te(String.prototype,e,c),te(RegExp.prototype,i,2==t?function(e,t){return h.call(e,this,t)}:function(e){return h.call(e,this)}),r&&z(RegExp.prototype[i],"sham",!0)}},Vn=Re("match"),In=function(e){var t;return _(e)&&(void 0!==(t=e[Vn])?!!t:"RegExp"==v(e))},Cn=Re("species"),En=function(e,t){var n,r=L(e).constructor;return void 0===r||null==(n=L(r)[Cn])?t:Le(n)},An=function(e){return function(t,n){var r,i,a=String(k(t)),o=se(n),s=a.length;return o<0||o>=s?e?"":void 0:(r=a.charCodeAt(o))<55296||r>56319||o+1===s||(i=a.charCodeAt(o+1))<56320||i>57343?e?a.charAt(o):r:e?a.slice(o,o+2):i-56320+(r-55296<<10)+65536}},Mn={codeAt:An(!1),charAt:An(!0)},Tn=Mn.charAt,Ln=function(e,t,n){return t+(n?Tn(e,t).length:1)},Pn=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==v(e))throw TypeError("RegExp#exec called on incompatible receiver");return kn.call(e,t)},Bn=[].push,zn=Math.min,On=!u((function(){return!RegExp(4294967295,"y")}));xn("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(k(this)),i=void 0===n?4294967295:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!In(e))return t.call(r,e,i);for(var a,o,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,h=new RegExp(e.source,u+"g");(a=kn.call(h,r))&&!((o=h.lastIndex)>c&&(l.push(r.slice(c,a.index)),a.length>1&&a.index<r.length&&Bn.apply(l,a.slice(1)),s=a[0].length,c=o,l.length>=i));)h.lastIndex===a.index&&h.lastIndex++;return c===r.length?!s&&h.test("")||l.push(""):l.push(r.slice(c)),l.length>i?l.slice(0,i):l}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=k(this),a=null==t?void 0:t[e];return void 0!==a?a.call(t,i,n):r.call(String(i),t,n)},function(e,i){var a=n(r,e,this,i,r!==t);if(a.done)return a.value;var o=L(e),s=String(this),l=En(o,RegExp),u=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(On?"y":"g"),h=new l(On?o:"^(?:"+o.source+")",c),d=void 0===i?4294967295:i>>>0;if(0===d)return[];if(0===s.length)return null===Pn(h,s)?[s]:[];for(var f=0,g=0,p=[];g<s.length;){h.lastIndex=On?g:0;var v,y=Pn(h,On?s:s.slice(g));if(null===y||(v=zn(ue(h.lastIndex+(On?0:g)),s.length))===f)g=Ln(s,g,u);else{if(p.push(s.slice(f,g)),p.length===d)return p;for(var m=1;m<=y.length-1;m++)if(p.push(y[m]),p.length===d)return p;g=f=v}}return p.push(s.slice(f)),p}]}),!On);var Fn=c?Object.defineProperties:function(e,t){L(e);for(var n,r=Ke(t),i=r.length,a=0;i>a;)B.f(e,n=r[a++],t[n]);return e},Nn=ie("document","documentElement"),Rn=G("IE_PROTO"),Dn=function(){},jn=function(){var e,t=E("iframe"),n=ye.length;for(t.style.display="none",Nn.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),jn=e.F;n--;)delete jn.prototype[ye[n]];return jn()},qn=Object.create||function(e,t){var n;return null!==e?(Dn.prototype=L(e),n=new Dn,Dn.prototype=null,n[Rn]=e):n=jn(),void 0===t?n:Fn(n,t)};H[Rn]=!0;var $n=be.f,Un={}.toString,Wn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Gn={f:function(e){return Wn&&"[object Window]"==Un.call(e)?function(e){try{return $n(e)}catch(e){return Wn.slice()}}(e):$n(w(e))}},Hn={f:Re},Kn=B.f,Zn=function(e){var t=ne.Symbol||(ne.Symbol={});V(t,e)||Kn(t,e,{value:Hn.f(e)})},Xn=B.f,Yn=Re("toStringTag"),Jn=function(e,t,n){e&&!V(e=n?e:e.prototype,Yn)&&Xn(e,Yn,{configurable:!0,value:t})},Qn=Ue.forEach,er=G("hidden"),tr=Re("toPrimitive"),nr=ee.set,rr=ee.getterFor("Symbol"),ir=Object.prototype,ar=l.Symbol,or=ie("JSON","stringify"),sr=T.f,lr=B.f,ur=Gn.f,cr=f.f,hr=N("symbols"),dr=N("op-symbols"),fr=N("string-to-symbol-registry"),gr=N("symbol-to-string-registry"),pr=N("wks"),vr=l.QObject,yr=!vr||!vr.prototype||!vr.prototype.findChild,mr=c&&u((function(){return 7!=qn(lr({},"a",{get:function(){return lr(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=sr(ir,t);r&&delete ir[t],lr(e,t,n),r&&e!==ir&&lr(ir,t,r)}:lr,br=function(e,t){var n=hr[e]=qn(ar.prototype);return nr(n,{type:"Symbol",tag:e,description:t}),c||(n.description=t),n},kr=Oe&&"symbol"==typeof ar.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof ar},wr=function(e,t,n){e===ir&&wr(dr,t,n),L(e);var r=S(t,!0);return L(n),V(hr,r)?(n.enumerable?(V(e,er)&&e[er][r]&&(e[er][r]=!1),n=qn(n,{enumerable:g(0,!1)})):(V(e,er)||lr(e,er,g(1,{})),e[er][r]=!0),mr(e,r,n)):lr(e,r,n)},_r=function(e,t){L(e);var n=w(t),r=Ke(n).concat(Ir(n));return Qn(r,(function(t){c&&!Sr.call(n,t)||wr(e,t,n[t])})),e},Sr=function(e){var t=S(e,!0),n=cr.call(this,t);return!(this===ir&&V(hr,t)&&!V(dr,t))&&(!(n||!V(this,t)||!V(hr,t)||V(this,er)&&this[er][t])||n)},xr=function(e,t){var n=w(e),r=S(t,!0);if(n!==ir||!V(hr,r)||V(dr,r)){var i=sr(n,r);return!i||!V(hr,r)||V(n,er)&&n[er][r]||(i.enumerable=!0),i}},Vr=function(e){var t=ur(w(e)),n=[];return Qn(t,(function(e){V(hr,e)||V(H,e)||n.push(e)})),n},Ir=function(e){var t=e===ir,n=ur(t?dr:w(e)),r=[];return Qn(n,(function(e){!V(hr,e)||t&&!V(ir,e)||r.push(hr[e])})),r};if(Oe||(te((ar=function(){if(this instanceof ar)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=U(e),n=function(e){this===ir&&n.call(dr,e),V(this,er)&&V(this[er],t)&&(this[er][t]=!1),mr(this,t,g(1,e))};return c&&yr&&mr(ir,t,{configurable:!0,set:n}),br(t,e)}).prototype,"toString",(function(){return rr(this).tag})),f.f=Sr,B.f=wr,T.f=xr,be.f=Gn.f=Vr,ke.f=Ir,c&&(lr(ar.prototype,"description",{configurable:!0,get:function(){return rr(this).description}}),te(ir,"propertyIsEnumerable",Sr,{unsafe:!0})),Hn.f=function(e){return br(Re(e),e)}),Te({global:!0,wrap:!0,forced:!Oe,sham:!Oe},{Symbol:ar}),Qn(Ke(pr),(function(e){Zn(e)})),Te({target:"Symbol",stat:!0,forced:!Oe},{for:function(e){var t=String(e);if(V(fr,t))return fr[t];var n=ar(t);return fr[t]=n,gr[n]=t,n},keyFor:function(e){if(!kr(e))throw TypeError(e+" is not a symbol");if(V(gr,e))return gr[e]},useSetter:function(){yr=!0},useSimple:function(){yr=!1}}),Te({target:"Object",stat:!0,forced:!Oe,sham:!c},{create:function(e,t){return void 0===t?qn(e):_r(qn(e),t)},defineProperty:wr,defineProperties:_r,getOwnPropertyDescriptor:xr}),Te({target:"Object",stat:!0,forced:!Oe},{getOwnPropertyNames:Vr,getOwnPropertySymbols:Ir}),Te({target:"Object",stat:!0,forced:u((function(){ke.f(1)}))},{getOwnPropertySymbols:function(e){return ke.f(Be(e))}}),or){var Cr=!Oe||u((function(){var e=ar();return"[null]"!=or([e])||"{}"!=or({a:e})||"{}"!=or(Object(e))}));Te({target:"JSON",stat:!0,forced:Cr},{stringify:function(e,t,n){for(var r,i=[e],a=1;arguments.length>a;)i.push(arguments[a++]);if(r=t,(_(t)||void 0!==e)&&!kr(e))return ze(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!kr(t))return t}),i[1]=t,or.apply(null,i)}})}ar.prototype[tr]||z(ar.prototype,tr,ar.prototype.valueOf),Jn(ar,"Symbol"),H[er]=!0;var Er=B.f,Ar=l.Symbol;if(c&&"function"==typeof Ar&&(!("description"in Ar.prototype)||void 0!==Ar().description)){var Mr={},Tr=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Tr?new Ar(e):void 0===e?Ar():Ar(e);return""===e&&(Mr[t]=!0),t};_e(Tr,Ar);var Lr=Tr.prototype=Ar.prototype;Lr.constructor=Tr;var Pr=Lr.toString,Br="Symbol(test)"==String(Ar("test")),zr=/^Symbol\((.*)\)[^)]+$/;Er(Lr,"description",{configurable:!0,get:function(){var e=_(this)?this.valueOf():this,t=Pr.call(e);if(V(Mr,e))return"";var n=Br?t.slice(7,-1):t.replace(zr,"$1");return""===n?void 0:n}}),Te({global:!0,forced:!0},{Symbol:Tr})}Zn("iterator");var Or=Re("unscopables"),Fr=Array.prototype;null==Fr[Or]&&z(Fr,Or,qn(null));var Nr,Rr,Dr,jr=function(e){Fr[Or][e]=!0},qr={},$r=!u((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ur=G("IE_PROTO"),Wr=Object.prototype,Gr=$r?Object.getPrototypeOf:function(e){return e=Be(e),V(e,Ur)?e[Ur]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Wr:null},Hr=Re("iterator"),Kr=!1;[].keys&&("next"in(Dr=[].keys())?(Rr=Gr(Gr(Dr)))!==Object.prototype&&(Nr=Rr):Kr=!0),null==Nr&&(Nr={}),V(Nr,Hr)||z(Nr,Hr,(function(){return this}));var Zr={IteratorPrototype:Nr,BUGGY_SAFARI_ITERATORS:Kr},Xr=Zr.IteratorPrototype,Yr=function(){return this},Jr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return L(n),function(e){if(!_(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Qr=Zr.IteratorPrototype,ei=Zr.BUGGY_SAFARI_ITERATORS,ti=Re("iterator"),ni=function(){return this},ri=function(e,t,n,r,i,a,o){!function(e,t,n){var r=t+" Iterator";e.prototype=qn(Xr,{next:g(1,n)}),Jn(e,r,!1),qr[r]=Yr}(n,t,r);var s,l,u,c=function(e){if(e===i&&v)return v;if(!ei&&e in f)return f[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},h=t+" Iterator",d=!1,f=e.prototype,p=f[ti]||f["@@iterator"]||i&&f[i],v=!ei&&p||c(i),y="Array"==t&&f.entries||p;if(y&&(s=Gr(y.call(new e)),Qr!==Object.prototype&&s.next&&(Gr(s)!==Qr&&(Jr?Jr(s,Qr):"function"!=typeof s[ti]&&z(s,ti,ni)),Jn(s,h,!0))),"values"==i&&p&&"values"!==p.name&&(d=!0,v=function(){return p.call(this)}),f[ti]!==v&&z(f,ti,v),qr[t]=v,i)if(l={values:c("values"),keys:a?v:c("keys"),entries:c("entries")},o)for(u in l)!ei&&!d&&u in f||te(f,u,l[u]);else Te({target:t,proto:!0,forced:ei||d},l);return l},ii=ee.set,ai=ee.getterFor("Array Iterator"),oi=ri(Array,"Array",(function(e,t){ii(this,{type:"Array Iterator",target:w(e),index:0,kind:t})}),(function(){var e=ai(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");qr.Arguments=qr.Array,jr("keys"),jr("values"),jr("entries");var si=Re("species"),li=[].slice,ui=Math.max;Te({target:"Array",proto:!0,forced:!_t("slice")},{slice:function(e,t){var n,r,i,a=w(this),o=ue(a.length),s=de(e,o),l=de(void 0===t?o:t,o);if(ze(a)&&("function"!=typeof(n=a.constructor)||n!==Array&&!ze(n.prototype)?_(n)&&null===(n=n[si])&&(n=void 0):n=void 0,n===Array||void 0===n))return li.call(a,s,l);for(r=new(void 0===n?Array:n)(ui(l-s,0)),i=0;s<l;s++,i++)s in a&&Et(r,i,a[s]);return r.length=i,r}});var ci,hi=B.f,di=l.DataView,fi=di&&di.prototype,gi=l.Int8Array,pi=gi&&gi.prototype,vi=l.Uint8ClampedArray,yi=vi&&vi.prototype,mi=gi&&Gr(gi),bi=pi&&Gr(pi),ki=Object.prototype,wi=ki.isPrototypeOf,_i=Re("toStringTag"),Si=U("TYPED_ARRAY_TAG"),xi=!(!l.ArrayBuffer||!di),Vi=xi&&!!Jr&&"Opera"!==Ft(l.opera),Ii=!1,Ci={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ei=function(e){return _(e)&&V(Ci,Ft(e))};for(ci in Ci)l[ci]||(Vi=!1);if((!Vi||"function"!=typeof mi||mi===Function.prototype)&&(mi=function(){throw TypeError("Incorrect invocation")},Vi))for(ci in Ci)l[ci]&&Jr(l[ci],mi);if((!Vi||!bi||bi===ki)&&(bi=mi.prototype,Vi))for(ci in Ci)l[ci]&&Jr(l[ci].prototype,bi);if(Vi&&Gr(yi)!==bi&&Jr(yi,bi),c&&!V(bi,_i))for(ci in Ii=!0,hi(bi,_i,{get:function(){return _(this)?this[Si]:void 0}}),Ci)l[ci]&&z(l[ci],Si,ci);xi&&Jr&&Gr(fi)!==ki&&Jr(fi,ki);var Ai={NATIVE_ARRAY_BUFFER:xi,NATIVE_ARRAY_BUFFER_VIEWS:Vi,TYPED_ARRAY_TAG:Ii&&Si,aTypedArray:function(e){if(Ei(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(Jr){if(wi.call(mi,e))return e}else for(var t in Ci)if(V(Ci,ci)){var n=l[t];if(n&&(e===n||wi.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportProto:function(e,t,n){if(c){if(n)for(var r in Ci){var i=l[r];i&&V(i.prototype,e)&&delete i.prototype[e]}bi[e]&&!n||te(bi,e,n?t:Vi&&pi[e]||t)}},exportStatic:function(e,t,n){var r,i;if(c){if(Jr){if(n)for(r in Ci)(i=l[r])&&V(i,e)&&delete i[e];if(mi[e]&&!n)return;try{return te(mi,e,n?t:Vi&&gi[e]||t)}catch(e){}}for(r in Ci)!(i=l[r])||i[e]&&!n||te(i,e,t)}},isView:function(e){var t=Ft(e);return"DataView"===t||V(Ci,t)},isTypedArray:Ei,TypedArray:mi,TypedArrayPrototype:bi},Mi=function(e,t,n){for(var r in t)te(e,r,t[r],n);return e},Ti=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Li=function(e){if(void 0===e)return 0;var t=se(e),n=ue(t);if(t!==n)throw RangeError("Wrong length or index");return n},Pi=function(e){for(var t=Be(this),n=ue(t.length),r=arguments.length,i=de(r>1?arguments[1]:void 0,n),a=r>2?arguments[2]:void 0,o=void 0===a?n:de(a,n);o>i;)t[i++]=e;return t},Bi=Ai.NATIVE_ARRAY_BUFFER,zi=be.f,Oi=B.f,Fi=ee.get,Ni=ee.set,Ri=l.ArrayBuffer,Di=Ri,ji=l.DataView,qi=l.Math,$i=l.RangeError,Ui=qi.abs,Wi=qi.pow,Gi=qi.floor,Hi=qi.log,Ki=qi.LN2,Zi=function(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,c=23===t?Wi(2,-24)-Wi(2,-77):0,h=e<0||0===e&&1/e<0?1:0,d=0;for((e=Ui(e))!=e||e===1/0?(i=e!=e?1:0,r=l):(r=Gi(Hi(e)/Ki),e*(a=Wi(2,-r))<1&&(r--,a*=2),(e+=r+u>=1?c/a:c*Wi(2,1-u))*a>=2&&(r++,a/=2),r+u>=l?(i=0,r=l):r+u>=1?(i=(e*a-1)*Wi(2,t),r+=u):(i=e*Wi(2,u-1)*Wi(2,t),r=0));t>=8;o[d++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[d++]=255&r,r/=256,s-=8);return o[--d]|=128*h,o},Xi=function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,o=a>>1,s=i-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;s>0;c=256*c+e[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=t;s>0;n=256*n+e[l],l--,s-=8);if(0===c)c=1-o;else{if(c===a)return n?NaN:u?-1/0:1/0;n+=Wi(2,t),c-=o}return(u?-1:1)*n*Wi(2,c-t)},Yi=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Ji=function(e){return[255&e]},Qi=function(e){return[255&e,e>>8&255]},ea=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},ta=function(e){return Zi(e,23,4)},na=function(e){return Zi(e,52,8)},ra=function(e,t){Oi(e.prototype,t,{get:function(){return Fi(this)[t]}})},ia=function(e,t,n,r){var i=Li(+n),a=Fi(e);if(i+t>a.byteLength)throw $i("Wrong index");var o=Fi(a.buffer).bytes,s=i+a.byteOffset,l=o.slice(s,s+t);return r?l:l.reverse()},aa=function(e,t,n,r,i,a){var o=Li(+n),s=Fi(e);if(o+t>s.byteLength)throw $i("Wrong index");for(var l=Fi(s.buffer).bytes,u=o+s.byteOffset,c=r(+i),h=0;h<t;h++)l[u+h]=c[a?h:t-h-1]};if(Bi){if(!u((function(){Ri(1)}))||!u((function(){new Ri(-1)}))||u((function(){return new Ri,new Ri(1.5),new Ri(NaN),"ArrayBuffer"!=Ri.name}))){for(var oa,sa=(Di=function(e){return Ti(this,Di),new Ri(Li(e))}).prototype=Ri.prototype,la=zi(Ri),ua=0;la.length>ua;)(oa=la[ua++])in Di||z(Di,oa,Ri[oa]);sa.constructor=Di}var ca=new ji(new Di(2)),ha=ji.prototype.setInt8;ca.setInt8(0,2147483648),ca.setInt8(1,2147483649),!ca.getInt8(0)&&ca.getInt8(1)||Mi(ji.prototype,{setInt8:function(e,t){ha.call(this,e,t<<24>>24)},setUint8:function(e,t){ha.call(this,e,t<<24>>24)}},{unsafe:!0})}else Di=function(e){Ti(this,Di,"ArrayBuffer");var t=Li(e);Ni(this,{bytes:Pi.call(new Array(t),0),byteLength:t}),c||(this.byteLength=t)},ji=function(e,t,n){Ti(this,ji,"DataView"),Ti(e,Di,"DataView");var r=Fi(e).byteLength,i=se(t);if(i<0||i>r)throw $i("Wrong offset");if(i+(n=void 0===n?r-i:ue(n))>r)throw $i("Wrong length");Ni(this,{buffer:e,byteLength:n,byteOffset:i}),c||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},c&&(ra(Di,"byteLength"),ra(ji,"buffer"),ra(ji,"byteLength"),ra(ji,"byteOffset")),Mi(ji.prototype,{getInt8:function(e){return ia(this,1,e)[0]<<24>>24},getUint8:function(e){return ia(this,1,e)[0]},getInt16:function(e){var t=ia(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=ia(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Yi(ia(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Yi(ia(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Xi(ia(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Xi(ia(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){aa(this,1,e,Ji,t)},setUint8:function(e,t){aa(this,1,e,Ji,t)},setInt16:function(e,t){aa(this,2,e,Qi,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){aa(this,2,e,Qi,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){aa(this,4,e,ea,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){aa(this,4,e,ea,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){aa(this,4,e,ta,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){aa(this,8,e,na,t,arguments.length>2?arguments[2]:void 0)}});Jn(Di,"ArrayBuffer"),Jn(ji,"DataView");var da={ArrayBuffer:Di,DataView:ji},fa=da.ArrayBuffer,ga=da.DataView,pa=fa.prototype.slice,va=u((function(){return!new fa(2).slice(1,void 0).byteLength}));Te({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:va},{slice:function(e,t){if(void 0!==pa&&void 0===t)return pa.call(L(this),e);for(var n=L(this).byteLength,r=de(e,n),i=de(void 0===t?n:t,n),a=new(En(this,fa))(ue(i-r)),o=new ga(this),s=new ga(a),l=0;r<i;)s.setUint8(l++,o.getUint8(r++));return a}});var ya=Mn.charAt,ma=ee.set,ba=ee.getterFor("String Iterator");ri(String,"String",(function(e){ma(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=ba(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=ya(n,r),t.index+=e.length,{value:e,done:!1})})),xn("match",1,(function(e,t,n){return[function(t){var n=k(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=L(e),a=String(this);if(!i.global)return Pn(i,a);var o=i.unicode;i.lastIndex=0;for(var s,l=[],u=0;null!==(s=Pn(i,a));){var c=String(s[0]);l[u]=c,""===c&&(i.lastIndex=Ln(a,ue(i.lastIndex),o)),u++}return 0===u?null:l}]}));var ka=Re("iterator"),wa=!1;try{var _a=0,Sa={next:function(){return{done:!!_a++}},return:function(){wa=!0}};Sa[ka]=function(){return this},Array.from(Sa,(function(){throw 2}))}catch(e){}var xa=function(e,t){if(!t&&!wa)return!1;var n=!1;try{var r={};r[ka]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Va=Ai.NATIVE_ARRAY_BUFFER_VIEWS,Ia=l.ArrayBuffer,Ca=l.Int8Array,Ea=!Va||!u((function(){Ca(1)}))||!u((function(){new Ca(-1)}))||!xa((function(e){new Ca,new Ca(null),new Ca(1.5),new Ca(e)}),!0)||u((function(){return 1!==new Ca(new Ia(2),1,void 0).length})),Aa=function(e,t){var n=function(e){var t=se(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}(e);if(n%t)throw RangeError("Wrong offset");return n},Ma=Re("iterator"),Ta=function(e){if(null!=e)return e[Ma]||e["@@iterator"]||qr[Ft(e)]},La=Re("iterator"),Pa=Array.prototype,Ba=function(e){return void 0!==e&&(qr.Array===e||Pa[La]===e)},za=Ai.aTypedArrayConstructor,Oa=function(e){var t,n,r,i,a,o,s=Be(e),l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,h=Ta(s);if(null!=h&&!Ba(h))for(o=(a=h.call(s)).next,s=[];!(i=o.call(a)).done;)s.push(i.value);for(c&&l>2&&(u=Pe(u,arguments[2],2)),n=ue(s.length),r=new(za(this))(n),t=0;n>t;t++)r[t]=c?u(s[t],t):s[t];return r},Fa=Re("species"),Na=function(e){var t=ie(e),n=B.f;c&&t&&!t[Fa]&&n(t,Fa,{configurable:!0,get:function(){return this}})},Ra=function(e,t,n){var r,i;return Jr&&"function"==typeof(r=t.constructor)&&r!==n&&_(i=r.prototype)&&i!==n.prototype&&Jr(e,i),e},Da=r((function(e){var t=be.f,n=Ue.forEach,r=ee.get,i=ee.set,a=B.f,o=T.f,s=Math.round,u=l.RangeError,h=da.ArrayBuffer,d=da.DataView,f=Ai.NATIVE_ARRAY_BUFFER_VIEWS,p=Ai.TYPED_ARRAY_TAG,v=Ai.TypedArray,y=Ai.TypedArrayPrototype,m=Ai.aTypedArrayConstructor,b=Ai.isTypedArray,k=function(e,t){for(var n=0,r=t.length,i=new(m(e))(r);r>n;)i[n]=t[n++];return i},w=function(e,t){a(e,t,{get:function(){return r(this)[t]}})},x=function(e){var t;return e instanceof h||"ArrayBuffer"==(t=Ft(e))||"SharedArrayBuffer"==t},I=function(e,t){return b(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},C=function(e,t){return I(e,t=S(t,!0))?g(2,e[t]):o(e,t)},E=function(e,t,n){return!(I(e,t=S(t,!0))&&_(n)&&V(n,"value"))||V(n,"get")||V(n,"set")||n.configurable||V(n,"writable")&&!n.writable||V(n,"enumerable")&&!n.enumerable?a(e,t,n):(e[t]=n.value,e)};c?(f||(T.f=C,B.f=E,w(y,"buffer"),w(y,"byteOffset"),w(y,"byteLength"),w(y,"length")),Te({target:"Object",stat:!0,forced:!f},{getOwnPropertyDescriptor:C,defineProperty:E}),e.exports=function(e,o,c,g){var m=e+(g?"Clamped":"")+"Array",w="get"+e,S="set"+e,V=l[m],I=V,C=I&&I.prototype,E={},A=function(e,t){a(e,t,{get:function(){return function(e,t){var n=r(e);return n.view[w](t*o+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=r(e);g&&(n=(n=s(n))<0?0:n>255?255:255&n),i.view[S](t*o+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};f?Ea&&(I=c((function(e,t,n,r){return Ti(e,I,m),Ra(_(t)?x(t)?void 0!==r?new V(t,Aa(n,o),r):void 0!==n?new V(t,Aa(n,o)):new V(t):b(t)?k(I,t):Oa.call(I,t):new V(Li(t)),e,I)})),Jr&&Jr(I,v),n(t(V),(function(e){e in I||z(I,e,V[e])})),I.prototype=C):(I=c((function(e,t,n,r){Ti(e,I,m);var a,s,l,c=0,f=0;if(_(t)){if(!x(t))return b(t)?k(I,t):Oa.call(I,t);a=t,f=Aa(n,o);var g=t.byteLength;if(void 0===r){if(g%o)throw u("Wrong length");if((s=g-f)<0)throw u("Wrong length")}else if((s=ue(r)*o)+f>g)throw u("Wrong length");l=s/o}else l=Li(t),a=new h(s=l*o);for(i(e,{buffer:a,byteOffset:f,byteLength:s,length:l,view:new d(a)});c<l;)A(e,c++)})),Jr&&Jr(I,v),C=I.prototype=qn(y)),C.constructor!==I&&z(C,"constructor",I),p&&z(C,p,m),E[m]=I,Te({global:!0,forced:I!=V,sham:!f},E),"BYTES_PER_ELEMENT"in I||z(I,"BYTES_PER_ELEMENT",o),"BYTES_PER_ELEMENT"in C||z(C,"BYTES_PER_ELEMENT",o),Na(m)}):e.exports=function(){}}));Da("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var ja=Math.min,qa=[].copyWithin||function(e,t){var n=Be(this),r=ue(n.length),i=de(e,r),a=de(t,r),o=arguments.length>2?arguments[2]:void 0,s=ja((void 0===o?r:de(o,r))-a,r-i),l=1;for(a<i&&i<a+s&&(l=-1,a+=s-1,i+=s-1);s-- >0;)a in n?n[i]=n[a]:delete n[i],i+=l,a+=l;return n},$a=Ai.aTypedArray;Ai.exportProto("copyWithin",(function(e,t){return qa.call($a(this),e,t,arguments.length>2?arguments[2]:void 0)}));var Ua=Ue.every,Wa=Ai.aTypedArray;Ai.exportProto("every",(function(e){return Ua(Wa(this),e,arguments.length>1?arguments[1]:void 0)}));var Ga=Ai.aTypedArray;Ai.exportProto("fill",(function(e){return Pi.apply(Ga(this),arguments)}));var Ha=Ue.filter,Ka=Ai.aTypedArray,Za=Ai.aTypedArrayConstructor;Ai.exportProto("filter",(function(e){for(var t=Ha(Ka(this),e,arguments.length>1?arguments[1]:void 0),n=En(this,this.constructor),r=0,i=t.length,a=new(Za(n))(i);i>r;)a[r]=t[r++];return a}));var Xa=Ue.find,Ya=Ai.aTypedArray;Ai.exportProto("find",(function(e){return Xa(Ya(this),e,arguments.length>1?arguments[1]:void 0)}));var Ja=Ue.findIndex,Qa=Ai.aTypedArray;Ai.exportProto("findIndex",(function(e){return Ja(Qa(this),e,arguments.length>1?arguments[1]:void 0)}));var eo=Ue.forEach,to=Ai.aTypedArray;Ai.exportProto("forEach",(function(e){eo(to(this),e,arguments.length>1?arguments[1]:void 0)}));var no=ge.includes,ro=Ai.aTypedArray;Ai.exportProto("includes",(function(e){return no(ro(this),e,arguments.length>1?arguments[1]:void 0)}));var io=ge.indexOf,ao=Ai.aTypedArray;Ai.exportProto("indexOf",(function(e){return io(ao(this),e,arguments.length>1?arguments[1]:void 0)}));var oo=Re("iterator"),so=l.Uint8Array,lo=oi.values,uo=oi.keys,co=oi.entries,ho=Ai.aTypedArray,fo=Ai.exportProto,go=so&&so.prototype[oo],po=!!go&&("values"==go.name||null==go.name),vo=function(){return lo.call(ho(this))};fo("entries",(function(){return co.call(ho(this))})),fo("keys",(function(){return uo.call(ho(this))})),fo("values",vo,!po),fo(oo,vo,!po);var yo=Ai.aTypedArray,mo=[].join;Ai.exportProto("join",(function(e){return mo.apply(yo(this),arguments)}));var bo=Math.min,ko=[].lastIndexOf,wo=!!ko&&1/[1].lastIndexOf(1,-0)<0,_o=We("lastIndexOf"),So=wo||_o?function(e){if(wo)return ko.apply(this,arguments)||0;var t=w(this),n=ue(t.length),r=n-1;for(arguments.length>1&&(r=bo(r,se(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:ko,xo=Ai.aTypedArray;Ai.exportProto("lastIndexOf",(function(e){return So.apply(xo(this),arguments)}));var Vo=Ue.map,Io=Ai.aTypedArray,Co=Ai.aTypedArrayConstructor;Ai.exportProto("map",(function(e){return Vo(Io(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(Co(En(e,e.constructor)))(t)}))}));var Eo=function(e){return function(t,n,r,i){Le(n);var a=Be(t),o=b(a),s=ue(a.length),l=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(l in o){i=o[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in o&&(i=n(i,o[l],l,a));return i}},Ao={left:Eo(!1),right:Eo(!0)},Mo=Ao.left,To=Ai.aTypedArray;Ai.exportProto("reduce",(function(e){return Mo(To(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var Lo=Ao.right,Po=Ai.aTypedArray;Ai.exportProto("reduceRight",(function(e){return Lo(Po(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var Bo=Ai.aTypedArray,zo=Math.floor;Ai.exportProto("reverse",(function(){for(var e,t=Bo(this).length,n=zo(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}));var Oo=Ai.aTypedArray,Fo=u((function(){new Int8Array(1).set({})}));Ai.exportProto("set",(function(e){Oo(this);var t=Aa(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=Be(e),i=ue(r.length),a=0;if(i+t>n)throw RangeError("Wrong length");for(;a<i;)this[t+a]=r[a++]}),Fo);var No=Ai.aTypedArray,Ro=Ai.aTypedArrayConstructor,Do=[].slice,jo=u((function(){new Int8Array(1).slice()}));Ai.exportProto("slice",(function(e,t){for(var n=Do.call(No(this),e,t),r=En(this,this.constructor),i=0,a=n.length,o=new(Ro(r))(a);a>i;)o[i]=n[i++];return o}),jo);var qo=Ue.some,$o=Ai.aTypedArray;Ai.exportProto("some",(function(e){return qo($o(this),e,arguments.length>1?arguments[1]:void 0)}));var Uo=Ai.aTypedArray,Wo=[].sort;Ai.exportProto("sort",(function(e){return Wo.call(Uo(this),e)}));var Go=Ai.aTypedArray;Ai.exportProto("subarray",(function(e,t){var n=Go(this),r=n.length,i=de(e,r);return new(En(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,ue((void 0===t?r:de(t,r))-i))}));var Ho=l.Int8Array,Ko=Ai.aTypedArray,Zo=[].toLocaleString,Xo=[].slice,Yo=!!Ho&&u((function(){Zo.call(new Ho(1))})),Jo=u((function(){return[1,2].toLocaleString()!=new Ho([1,2]).toLocaleString()}))||!u((function(){Ho.prototype.toLocaleString.call([1,2])}));Ai.exportProto("toLocaleString",(function(){return Zo.apply(Yo?Xo.call(Ko(this)):Ko(this),arguments)}),Jo);var Qo=l.Uint8Array,es=Qo&&Qo.prototype,ts=[].toString,ns=[].join;u((function(){ts.call({})}))&&(ts=function(){return ns.call(this)}),Ai.exportProto("toString",ts,(es||{}).toString!=ts);var rs=Re("iterator"),is=Re("toStringTag"),as=oi.values;for(var os in Ye){var ss=l[os],ls=ss&&ss.prototype;if(ls){if(ls[rs]!==as)try{z(ls,rs,as)}catch(e){ls[rs]=as}if(ls[is]||z(ls,is,os),Ye[os])for(var us in oi)if(ls[us]!==oi[us])try{z(ls,us,oi[us])}catch(e){ls[us]=oi[us]}}}var cs=Re("isConcatSpreadable"),hs=kt>=51||!u((function(){var e=[];return e[cs]=!1,e.concat()[0]!==e})),ds=_t("concat"),fs=function(e){if(!_(e))return!1;var t=e[cs];return void 0!==t?!!t:ze(e)};Te({target:"Array",proto:!0,forced:!hs||!ds},{concat:function(e){var t,n,r,i,a,o=Be(this),s=je(o,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?o:arguments[t],fs(a)){if(l+(i=ue(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,l++)n in a&&Et(s,l,a[n])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Et(s,l++,a)}return s.length=l,s}}),Te({target:"Array",proto:!0},{fill:Pi}),jr("fill");var gs=Ue.findIndex,ps=!0;"findIndex"in[]&&Array(1).findIndex((function(){ps=!1})),Te({target:"Array",proto:!0,forced:ps},{findIndex:function(e){return gs(this,e,arguments.length>1?arguments[1]:void 0)}}),jr("findIndex"),Da("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var vs=null,ys=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;nt(this,e),this._seed=t,this._crypto="undefined"!=typeof window&&(window.crypto||window.msCrypto)||null}return it(e,[{key:"next",value:function(){if(this._crypto){var e=new Uint32Array(1);return this._crypto.getRandomValues(e),e/4294967296}return Math.random()}},{key:"nextFloat",value:function(e,t){return this.next()*(t-e)+e}},{key:"nextInteger",value:function(e,t){return Math.floor(this.next()*(t-e+1))+e}},{key:"nextBytes",value:function(e){var t=new Uint8Array(e);if(this._crypto)this._crypto.getRandomValues(t);else for(var n=0;n<e;n++)t[n]=this.nextInteger(0,255);return t}},{key:"nextBoolean",value:function(){return this.next()>=.5}},{key:"nextChoice",value:function(e){return e[this.nextInteger(0,e.length-1)]}}],[{key:"getInstance",value:function(){return null===vs&&(vs=new e),vs}}]),e}(),ms=function(){function e(){nt(this,e)}return it(e,null,[{key:"isEqual",value:function(t,n){if(t===n)return!0;if(null===t&&null===n)return!0;if(null===t||null===n)return!1;if(tt(t)!==tt(n))return!1;if(t instanceof Array){if(t.length!==n.length)return!1;for(var r=-1,i=!0;i&&++r<t.length;)i=e.isEqual(t[r],n[r]);return i}if(t instanceof Object){if("function"==typeof t.isEqualTo)return t.isEqualTo(n);if("function"==typeof n.isEqualTo)return n.isEqualTo(t);for(var a=e.unique(Object.keys(t).concat(Object.keys(n))),o=-1,s=!0;s&&++o<a.length;){var l=a[o];s=e.isEqual(t[l],n[l])}return s}return t instanceof Date&&t.getTime()===n.getTime()}},{key:"isUnique",value:function(e){return-1===e.findIndex((function(t,n){return e.indexOf(t)!==n}))}},{key:"unique",value:function(e){return e.filter((function(t,n){return e.indexOf(t)===n}))}},{key:"shuffle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=t||ys.getInstance();var n,r,i=e.slice();for(n=i.length-1;n>0;n--){var a=[i[r=t.nextInteger(0,n)],i[n]];i[n]=a[0],i[r]=a[1]}return i}},{key:"chunk",value:function(e,t){for(var n=Math.ceil(e.length/t),r=new Array(n),i=0;i<n;i++)r[i]=e.slice(i*t,(i+1)*t);return r}},{key:"joinSlices",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.length,r=t.length,i=[],a=0;a<n;a++)r>0&&a>0&&(i=i.concat(t)),i=i.concat(e[a]);return i}},{key:"indexOfSlice",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===t.length)return-1;for(var r=-1,i=n-1;-1===r&&-1!==(i=e.indexOf(t[0],i+1));)this.isEqual(e.slice(i,i+t.length),t)&&(r=i);return r}},{key:"replaceSlice",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,i=-1,a=[];-1!==(i=this.indexOfSlice(e,t,i+1));)a=(a=a.concat(e.slice(r,i))).concat(n),r=i+t.length;return a=a.concat(e.slice(r))}},{key:"resizeBitSizedArray",value:function(e,t,n){for(var r,i,a,o,s,l,u,c,h=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=Math.ceil(e.length*t/n),f=8===n?new Uint8Array(d):new Array(d).fill(0),g=(1<<n)-1,p=0;p<e.length;p++)for(r=e[p],i=p*t,a=(p+1)*t,o=Math.floor(i/n),l=n-a%n,f[s=Math.floor(a/n)]|=r<<l&g,u=r>>n-l,c=s;--c>=o&&u>0;)f[c]|=u&g,u>>=n;if(h){for(var v=f.length-1;0===f[v];)v--;return f.slice(0,v+1)}return f}}]),e}(),bs=function(e,t,n,r){try{return r?t(L(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&L(i.call(e)),t}},ks=!xa((function(e){Array.from(e)}));Te({target:"Array",stat:!0,forced:ks},{from:function(e){var t,n,r,i,a,o=Be(e),s="function"==typeof this?this:Array,l=arguments.length,u=l>1?arguments[1]:void 0,c=void 0!==u,h=0,d=Ta(o);if(c&&(u=Pe(u,l>2?arguments[2]:void 0,2)),null==d||s==Array&&Ba(d))for(n=new s(t=ue(o.length));t>h;h++)Et(n,h,c?u(o[h],h):o[h]);else for(a=(i=d.call(o)).next,n=new s;!(r=a.call(i)).done;h++)Et(n,h,c?bs(i,u,[r.value,h],!0):r.value);return n.length=h,n}});var ws="".repeat||function(e){var t=String(k(this)),n="",r=se(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},_s=Math.ceil,Ss=function(e){return function(t,n,r){var i,a,o=String(k(t)),s=o.length,l=void 0===r?" ":String(r),u=ue(n);return u<=s||""==l?o:(i=u-s,(a=ws.call(l,_s(i/l.length))).length>i&&(a=a.slice(0,i)),e?o+a:a+o)}},xs={start:Ss(!1),end:Ss(!0)},Vs=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(vt),Is=xs.end;Te({target:"String",proto:!0,forced:Vs},{padEnd:function(e){return Is(this,e,arguments.length>1?arguments[1]:void 0)}});var Cs=B.f,Es=be.f,As=Re("match"),Ms=l.RegExp,Ts=Ms.prototype,Ls=/a/g,Ps=/a/g,Bs=new Ms(Ls)!==Ls;if(c&&Ae("RegExp",!Bs||u((function(){return Ps[As]=!1,Ms(Ls)!=Ls||Ms(Ps)==Ps||"/a/i"!=Ms(Ls,"i")})))){for(var zs=function(e,t){var n=this instanceof zs,r=In(e),i=void 0===t;return!n&&r&&e.constructor===zs&&i?e:Ra(Bs?new Ms(r&&!i?e.source:e,t):Ms((r=e instanceof zs)?e.source:e,r&&i?jt.call(e):t),n?this:Ts,zs)},Os=function(e){e in zs||Cs(zs,e,{configurable:!0,get:function(){return Ms[e]},set:function(t){Ms[e]=t}})},Fs=Es(Ms),Ns=0;Fs.length>Ns;)Os(Fs[Ns++]);Ts.constructor=zs,zs.prototype=Ts,te(l,"RegExp",zs)}Na("RegExp");var Rs=Math.max,Ds=Math.min,js=Math.floor,qs=/\$([$&'`]|\d\d?|<[^>]*>)/g,$s=/\$([$&'`]|\d\d?)/g;xn("replace",2,(function(e,t,n){return[function(n,r){var i=k(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,i,r):t.call(String(i),n,r)},function(e,i){var a=n(t,e,this,i);if(a.done)return a.value;var o=L(e),s=String(this),l="function"==typeof i;l||(i=String(i));var u=o.global;if(u){var c=o.unicode;o.lastIndex=0}for(var h=[];;){var d=Pn(o,s);if(null===d)break;if(h.push(d),!u)break;""===String(d[0])&&(o.lastIndex=Ln(s,ue(o.lastIndex),c))}for(var f,g="",p=0,v=0;v<h.length;v++){d=h[v];for(var y=String(d[0]),m=Rs(Ds(se(d.index),s.length),0),b=[],k=1;k<d.length;k++)b.push(void 0===(f=d[k])?f:String(f));var w=d.groups;if(l){var _=[y].concat(b,m,s);void 0!==w&&_.push(w);var S=String(i.apply(void 0,_))}else S=r(y,s,m,b,w,i);m>=p&&(g+=s.slice(p,m)+S,p=m+y.length)}return g+s.slice(p)}];function r(e,n,r,i,a,o){var s=r+e.length,l=i.length,u=$s;return void 0!==a&&(a=Be(a),u=qs),t.call(o,u,(function(t,o){var u;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(s);case"<":u=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return t;if(c>l){var h=js(c/10);return 0===h?t:h<=l?void 0===i[h-1]?o.charAt(1):i[h-1]+o.charAt(1):t}u=i[c-1]}return void 0===u?"":u}))}}));var Us=0,Ws=function(){function e(){nt(this,e)}return it(e,null,[{key:"camelCaseToRegular",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/\b([A-Z]+)([A-Z])([a-z])/,"$1 $2$3").replace(/^./,(function(e){return e.toUpperCase()}))}},{key:"uniqueId",value:function(){return"u"+(++Us).toString(16)}},{key:"chunk",value:function(e,t){return""!==e?e.match(new RegExp(".{1,".concat(t,"}"),"g")):[]}},{key:"isWhitespace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e[t];return!!n&&null!==n.match(/\s/)}},{key:"removeWhitespaces",value:function(e){return this.replaceWhitespaces(e,"",!0)}},{key:"normalizeWhitespaces",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.replaceWhitespaces(e," ",t)}},{key:"replaceWhitespaces",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e.replace(/\s+/g,t):e.replace(/\s/g,t)}}]),e}(),Gs=function(e){function t(e){var n;return nt(this,t),(n=ht(this,ot(t).call(this,e))).name=n.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(ct(n),n.constructor):n.stack=new Error(e).stack,n}return at(t,e),t}(ut(Error)),Hs=function(e){function t(){return nt(this,t),ht(this,ot(t).apply(this,arguments))}return at(t,e),t}(Gs),Ks=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return nt(this,t),(n=ht(this,ot(t).call(this,e))).index=r,n}return at(t,e),t}(Hs),Zs={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",padding:"=",paddingOptional:!1,foreignCharacters:!1,maxLineLength:null,lineSeparator:"\r\n"},Xs=function(){function e(){nt(this,e)}return it(e,null,[{key:"hexStringFromBytes",value:function(e){return Array.from(e).map((function(e){return("0"+e.toString(16)).slice(-2)})).join("")}},{key:"bytesFromHexString",value:function(e){(e=Ws.removeWhitespaces(e)).length%2==1&&(e+="0");var t=Ws.chunk(e,2).map((function(e,t){var n=parseInt(e,16);if(null===e.match(/[0-9a-f]{2}/i)||isNaN(n))throw new Ks("Invalid hex encoded byte '".concat(e,"'"));return n}));return new Uint8Array(t)}},{key:"binaryStringFromBytes",value:function(e){return Array.from(e).map((function(e){return("0000000"+e.toString(2)).slice(-8)})).join("")}},{key:"bytesFromBinaryString",value:function(e){(e=Ws.removeWhitespaces(e)).length%8>0&&(e=e.padEnd(e.length-e.length%8+8,"0"));var t=Ws.chunk(e,8).map((function(e,t){var n=parseInt(e,2);if(null===e.match(/[0-1]{8}/)||isNaN(n))throw new Ks("Invalid binary encoded byte '".concat(e,"'"));return n}));return new Uint8Array(t)}},{key:"base64StringFromBytes",value:function(e){for(var t,n,r,i,a,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Object.assign({},Zs,s),u=l.alphabet,c=l.padding,h=l.paddingOptional,d=l.maxLineLength,f=l.lineSeparator,g=!h&&c?c:"",p="",v=0;v<e.length;v+=3)i=(3&(t=e[v]))<<4|(n=v+1<e.length?e[v+1]:NaN)>>4,a=(15&n)<<2|(r=v+2<e.length?e[v+2]:NaN)>>6,o=63&r,p+=u[t>>2]+u[i]+(isNaN(n)?g:u[a])+(isNaN(r)?g:u[o]);if(d){for(var y="",m=0;m<p.length;m+=d)y+=(""!==y?f:"")+p.substr(m,d);p=y}return p}},{key:"bytesFromBase64String",value:function(e){for(var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},Zs,r),a=i.alphabet,o=i.padding,s=(i.paddingOptional,i.foreignCharacters),l=i.maxLineLength,u=i.lineSeparator,c=e.length,h=[],d=-1;++d<c;)if(t=e[d],null!==l&&u&&t===u[0]&&e.substr(d,u.length)===u)d=d+u.length-1;else if(t===o);else if(-1!==(n=a.indexOf(t)))h.push(n);else if(!s)throw new Ks("Forbidden character '".concat(t,"' at index ").concat(d));var f=(4-h.length%4)%4;if(3===f)throw new Ks("A single remaining encoded character in the last quadruple or a padding of 3 characters is not allowed");for(d=0;d<f;d++)h.push(0);var g,p=h.length/4*3,v=new Uint8Array(p);for(d=0;d<h.length;d+=4)v[g=d/4*3]=h[d]<<2|h[d+1]>>4,v[g+1]=(15&h[d+1])<<4|h[d+2]>>2,v[g+2]=(3&h[d+2])<<6|h[d+3];return v.slice(0,p-f)}}]),e}(),Ys=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return nt(this,t),(n=ht(this,ot(t).call(this,e))).byteIndex=r,n}return at(t,e),t}(Hs),Js=function(){function e(){nt(this,e)}return it(e,null,[{key:"validateCodePoint",value:function(e){return isFinite(e)&&e>=0&&e<=1114111&&Math.floor(e)===e}},{key:"validateCodePoints",value:function(t){for(var n=!0,r=0;n&&r<t.length;)n=e.validateCodePoint(t[r]),r++;return n}},{key:"stringFromCodePoints",value:function(e){var t,n,r=new Array(2*e.length),i=0;for(t=0;t<e.length;t++)(n=e[t])<65536?r[i++]=String.fromCharCode(n):(n-=65536,r[i++]=String.fromCharCode(55296+(n>>10)),r[i++]=String.fromCharCode(n%1024+56320));return r.slice(0,i).join("")}},{key:"codePointsFromString",value:function(e){for(var t,n,r=e.length,i=new Array(r),a=0,o=0;o<r;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r?56320==(64512&(n=e.charCodeAt(o++)))?i[a++]=((1023&t)<<10)+(1023&n)+65536:(i[a++]=t,o--):i[a++]=t;return i.slice(0,a)}},{key:"bytesFromCodePoints",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";switch(n){case"utf8":return e._encodeCodePointsToUTF8Bytes(t);default:throw new Error("Encoding to '".concat(n,"' is currently not supported."))}}},{key:"codePointsFromBytes",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";switch(n){case"utf8":return e._decodeCodePointsFromUTF8Bytes(t);default:throw new Error("Decoding from '".concat(n,"' is currently not supported."))}}},{key:"_encodeCodePointsToUTF8Bytes",value:function(e){var t,n,r=new Uint8Array(4*e.length),i=0;for(t=0;t<e.length;t++)(n=e[t])<=127?r[i++]=n:n<=2047?(r[i++]=192|n>>6,r[i++]=128|63&n):n<=65535?(r[i++]=224|n>>12,r[i++]=128|(4095&n)>>6,r[i++]=128|63&n):(r[i++]=240|n>>18,r[i++]=128|(262143&n)>>12,r[i++]=128|(4095&n)>>6,r[i++]=128|63&n);return r.slice(0,i)}},{key:"_decodeCodePointsFromUTF8Bytes",value:function(e){for(var t,n,r=e.length,i=new Array(r),a=0,o=-1,s=0;++o<r;)if((t=e[o])>127&&t<=191){if(--a<0)throw new Ys("Invalid UTF-8 encoded text: "+"Unexpected continuation byte at 0x".concat(o.toString(16)),o);n=n<<6|63&t,0===a&&(i[s++]=n)}else{if(a>0)throw new Ys("Invalid UTF-8 encoded text: "+"Continuation byte expected at 0x".concat(o.toString(16)),o);if(t<=127)i[s++]=t;else if(t<=223)n=31&t,a=1;else if(t<=239)n=15&t,a=2;else{if(!(t<=247))throw new Ys("Invalid UTF-8 encoded text: "+"Invalid byte ".concat(t," at 0x").concat(o.toString(16)),o);n=7&t,a=3}}if(0!==a)throw new Ys("Invalid UTF-8 encoded text: Unexpected end of bytes");return i.slice(0,s)}}]),e}(),Qs=null,el=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(nt(this,e),this._codePoints=null,this._string=null,this._bytes=null,this._encoding=n,null===t)this._codePoints=[],this._string="",this._bytes=new Uint8Array(0);else{var r=Object.prototype.toString.call(t);switch(r){case"[object Array]":if(!Js.validateCodePoints(t))throw new Error("Chain constructor expects a valid array of code points.");this._codePoints=t;break;case"[object String]":this._string=t;break;case"[object Uint8Array]":this._bytes=t;break;default:throw new Error("Chain constructor expects one optional parameter of type "+"Array, String or Uint8Array. Received unexpected ".concat(r,"."))}}}return it(e,[{key:"getCodePoints",value:function(){return null===this._codePoints&&(null!==this._string?this._codePoints=Js.codePointsFromString(this._string):this._codePoints=Js.codePointsFromBytes(this._bytes,this._encoding)),this._codePoints}},{key:"getChars",value:function(){return this.getCodePoints().map((function(e){return Js.stringFromCodePoints([e])}))}},{key:Symbol.iterator,value:function(){return this.getCodePoints().values}},{key:"getCodePointAt",value:function(e){return this.getCodePoints()[e]}},{key:"getCharAt",value:function(e){return Js.stringFromCodePoints([this.getCodePointAt(e)])}},{key:"getCharBytesAt",value:function(e){return Js.bytesFromCodePoints([this.getCodePointAt(e)])}},{key:"getLength",value:function(){return this.getCodePoints().length}},{key:"getString",value:function(){return null===this._string&&(this._string=Js.stringFromCodePoints(this.getCodePoints())),this._string}},{key:"toString",value:function(){return this.getString()}},{key:"toLowerCase",value:function(){return e.wrap(this.getString().toLowerCase(),this._encoding)}},{key:"toUpperCase",value:function(){return e.wrap(this.getString().toUpperCase(),this._encoding)}},{key:"split",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return n=n instanceof e?n.toString():n,this.getString().split(n,r).map((function(n){return e.wrap(n,t._encoding)}))}},{key:"substr",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(n<=0||t>=this.getLength())return e.empty();t<0&&(t=Math.max(this.getLength()+t,0));var r=this.getCodePoints().slice(t,n?t+n:void 0);return e.wrap(r,this._encoding)}},{key:"truncate",value:function(t){return this.getLength()>t?e.wrap(this.substr(0,t).getString()+"…",this._encoding):this}},{key:"extend",value:function(t){for(var n,r=this.getCodePoints(),i=e.wrap(t).getCodePoints(),a=r.slice(),o=0;a.length<i.length&&o<i.length;)n=i[o++],-1===r.indexOf(n)&&a.push(n);return e.wrap(a)}},{key:"match",value:function(e){return this.getString().match(e)}},{key:"getDescription",value:function(){return null!==this._string?"String(".concat(this._string,")"):null!==this._codePoints?"CodePoints(".concat(this._codePoints.join(", "),")"):"Bytes(".concat(Xs.hexStringFromBytes(this._bytes),")")}},{key:"contains",value:function(e){return-1!==this.getString().indexOf(e.toString())}},{key:"indexOfCodePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.getCodePoints().indexOf(e,t)}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.getString(),r=n.indexOf(e.toString(),t);if(-1===r)return-1;var i=n.substr(0,r),a=Js.codePointsFromString(i);return a.length}},{key:"getBytes",value:function(){return null===this._bytes&&(this._bytes=Js.bytesFromCodePoints(this.getCodePoints(),this._encoding)),this._bytes}},{key:"getByteAt",value:function(e){return this.getBytes()[e]}},{key:"getSize",value:function(){return this.getBytes().length}},{key:"needsTextEncoding",value:function(){return null===this._codePoints&&null===this._string}},{key:"needsByteEncoding",value:function(){return null===this._bytes}},{key:"isEmpty",value:function(){return this===Qs||null!==this._codePoints&&0===this._codePoints.length||null!==this._string&&""===this._string||null!==this._bytes&&0===this._bytes.length}},{key:"isEqualTo",value:function(t){if(t===this)return!0;if(!(t instanceof e))return!1;if(this.isEmpty()&&t.isEmpty())return!0;if(t.getEncoding()!==this._encoding)return!1;if(null!==this._string&&this._string===t._string)return!0;if(null!==this._bytes&&null!==t._bytes)return ms.isEqual(this._bytes,t._bytes);try{return ms.isEqual(this.getCodePoints(),t.getCodePoints())}catch(e){if(e instanceof Ys)return!1;throw e}}},{key:"getEncoding",value:function(){return this._encoding}}],[{key:"isEqual",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length<2)return!0;var i=n[0];if(!(i instanceof e))return!1;for(var a=!0,o=0;a&&++o<n.length;)a=i.isEqualTo(n[o]);return a}},{key:"wrap",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return t instanceof e?t:null===t||0===t.length?e.empty():new e(t,n)}},{key:"join",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e.wrap(t.map((function(e){return e.toString()})).join(n))}},{key:"empty",value:function(){return null===Qs&&(Qs=new e),Qs}}]),e}(),tl=[].reverse,nl=[1,2];Te({target:"Array",proto:!0,forced:String(nl)===String(nl.reverse())},{reverse:function(){return ze(this)&&(this.length=this.length),tl.call(this)}});var rl,il,al,ol=l.Promise,sl=r((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,i,a){var o,s,l,u,c,h,d,f=Pe(n,r,i?2:1);if(a)o=e;else{if("function"!=typeof(s=Ta(e)))throw TypeError("Target is not iterable");if(Ba(s)){for(l=0,u=ue(e.length);u>l;l++)if((c=i?f(L(d=e[l])[0],d[1]):f(e[l]))&&c instanceof t)return c;return new t(!1)}o=s.call(e)}for(h=o.next;!(d=h.call(o)).done;)if("object"==typeof(c=bs(o,f,d.value,i))&&c&&c instanceof t)return c;return new t(!1)}).stop=function(e){return new t(!0,e)}})),ll=/(iphone|ipod|ipad).*applewebkit/i.test(vt),ul=l.location,cl=l.setImmediate,hl=l.clearImmediate,dl=l.process,fl=l.MessageChannel,gl=l.Dispatch,pl=0,vl={},yl=function(e){if(vl.hasOwnProperty(e)){var t=vl[e];delete vl[e],t()}},ml=function(e){return function(){yl(e)}},bl=function(e){yl(e.data)},kl=function(e){l.postMessage(e+"",ul.protocol+"//"+ul.host)};cl&&hl||(cl=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return vl[++pl]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},rl(pl),pl},hl=function(e){delete vl[e]},"process"==v(dl)?rl=function(e){dl.nextTick(ml(e))}:gl&&gl.now?rl=function(e){gl.now(ml(e))}:fl&&!ll?(al=(il=new fl).port2,il.port1.onmessage=bl,rl=Pe(al.postMessage,al,1)):!l.addEventListener||"function"!=typeof postMessage||l.importScripts||u(kl)?rl="onreadystatechange"in E("script")?function(e){Nn.appendChild(E("script")).onreadystatechange=function(){Nn.removeChild(this),yl(e)}}:function(e){setTimeout(ml(e),0)}:(rl=kl,l.addEventListener("message",bl,!1)));var wl,_l,Sl,xl,Vl,Il,Cl,El,Al={set:cl,clear:hl},Ml=T.f,Tl=Al.set,Ll=l.MutationObserver||l.WebKitMutationObserver,Pl=l.process,Bl=l.Promise,zl="process"==v(Pl),Ol=Ml(l,"queueMicrotask"),Fl=Ol&&Ol.value;Fl||(wl=function(){var e,t;for(zl&&(e=Pl.domain)&&e.exit();_l;){t=_l.fn,_l=_l.next;try{t()}catch(e){throw _l?xl():Sl=void 0,e}}Sl=void 0,e&&e.enter()},zl?xl=function(){Pl.nextTick(wl)}:Ll&&!ll?(Vl=!0,Il=document.createTextNode(""),new Ll(wl).observe(Il,{characterData:!0}),xl=function(){Il.data=Vl=!Vl}):Bl&&Bl.resolve?(Cl=Bl.resolve(void 0),El=Cl.then,xl=function(){El.call(Cl,wl)}):xl=function(){Tl.call(l,wl)});var Nl,Rl,Dl,jl,ql=Fl||function(e){var t={fn:e,next:void 0};Sl&&(Sl.next=t),_l||(_l=t,xl()),Sl=t},$l=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Le(t),this.reject=Le(n)},Ul={f:function(e){return new $l(e)}},Wl=function(e,t){if(L(e),_(t)&&t.constructor===e)return t;var n=Ul.f(e);return(0,n.resolve)(t),n.promise},Gl=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Hl=Al.set,Kl=Re("species"),Zl="Promise",Xl=ee.get,Yl=ee.set,Jl=ee.getterFor(Zl),Ql=ol,eu=l.TypeError,tu=l.document,nu=l.process,ru=N("inspectSource"),iu=ie("fetch"),au=Ul.f,ou=au,su="process"==v(nu),lu=!!(tu&&tu.createEvent&&l.dispatchEvent),uu=Ae(Zl,(function(){var e=ru(Ql)!==String(Ql);if(66===kt)return!0;if(!e&&!su&&"function"!=typeof PromiseRejectionEvent)return!0;if(kt>=51&&/native code/.test(Ql))return!1;var t=Ql.resolve(1),n=function(e){e((function(){}),(function(){}))};return(t.constructor={})[Kl]=n,!(t.then((function(){}))instanceof n)})),cu=uu||!xa((function(e){Ql.all(e).catch((function(){}))})),hu=function(e){var t;return!(!_(e)||"function"!=typeof(t=e.then))&&t},du=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;ql((function(){for(var i=t.value,a=1==t.state,o=0;r.length>o;){var s,l,u,c=r[o++],h=a?c.ok:c.fail,d=c.resolve,f=c.reject,g=c.domain;try{h?(a||(2===t.rejection&&vu(e,t),t.rejection=1),!0===h?s=i:(g&&g.enter(),s=h(i),g&&(g.exit(),u=!0)),s===c.promise?f(eu("Promise-chain cycle")):(l=hu(s))?l.call(s,d,f):d(s)):f(i)}catch(e){g&&!u&&g.exit(),f(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&gu(e,t)}))}},fu=function(e,t,n){var r,i;lu?((r=tu.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:n},(i=l["on"+e])?i(r):"unhandledrejection"===e&&function(e,t){var n=l.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},gu=function(e,t){Hl.call(l,(function(){var n,r=t.value;if(pu(t)&&(n=Gl((function(){su?nu.emit("unhandledRejection",r,e):fu("unhandledrejection",e,r)})),t.rejection=su||pu(t)?2:1,n.error))throw n.value}))},pu=function(e){return 1!==e.rejection&&!e.parent},vu=function(e,t){Hl.call(l,(function(){su?nu.emit("rejectionHandled",e):fu("rejectionhandled",e,t.value)}))},yu=function(e,t,n,r){return function(i){e(t,n,i,r)}},mu=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,du(e,t,!0))},bu=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw eu("Promise can't be resolved itself");var i=hu(n);i?ql((function(){var r={done:!1};try{i.call(n,yu(bu,e,r,t),yu(mu,e,r,t))}catch(n){mu(e,r,n,t)}})):(t.value=n,t.state=1,du(e,t,!1))}catch(n){mu(e,{done:!1},n,t)}}};uu&&(Ql=function(e){Ti(this,Ql,Zl),Le(e),Nl.call(this);var t=Xl(this);try{e(yu(bu,this,t),yu(mu,this,t))}catch(e){mu(this,t,e)}},(Nl=function(e){Yl(this,{type:Zl,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Mi(Ql.prototype,{then:function(e,t){var n=Jl(this),r=au(En(this,Ql));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=su?nu.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&du(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Rl=function(){var e=new Nl,t=Xl(e);this.promise=e,this.resolve=yu(bu,e,t),this.reject=yu(mu,e,t)},Ul.f=au=function(e){return e===Ql||e===Dl?new Rl(e):ou(e)},"function"==typeof ol&&(jl=ol.prototype.then,te(ol.prototype,"then",(function(e,t){var n=this;return new Ql((function(e,t){jl.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof iu&&Te({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Wl(Ql,iu.apply(l,arguments))}}))),Te({global:!0,wrap:!0,forced:uu},{Promise:Ql}),Jn(Ql,Zl,!1),Na(Zl),Dl=ie(Zl),Te({target:Zl,stat:!0,forced:uu},{reject:function(e){var t=au(this);return t.reject.call(void 0,e),t.promise}}),Te({target:Zl,stat:!0,forced:uu},{resolve:function(e){return Wl(this,e)}}),Te({target:Zl,stat:!0,forced:cu},{all:function(e){var t=this,n=au(t),r=n.resolve,i=n.reject,a=Gl((function(){var n=Le(t.resolve),a=[],o=0,s=1;sl(e,(function(e){var l=o++,u=!1;a.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,a[l]=e,--s||r(a))}),i)})),--s||r(a)}));return a.error&&i(a.value),n.promise},race:function(e){var t=this,n=au(t),r=n.reject,i=Gl((function(){var i=Le(t.resolve);sl(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});r((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),o=new C(r||[]);return a._invoke=function(e,t,n){var r=c;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw a;return A()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var l=u(e,t,n);if("normal"===l.type){if(r=n.done?f:h,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=f,n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",g={};function p(){}function v(){}function y(){}var m={};m[a]=function(){return this};var b=Object.getPrototypeOf,k=b&&b(b(E([])));k&&k!==n&&r.call(k,a)&&(m=k);var w=y.prototype=p.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function S(e){var t;this._invoke=function(n,i){function a(){return new Promise((function(t,a){!function t(n,i,a,o){var s=u(e[n],e,i);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,a,o)}),(function(e){t("throw",e,a,o)})):Promise.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return t("throw",e,a,o)}))}o(s.arg)}(n,i,t,a)}))}return t=t?t.then(a,a):a()}}function x(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=u(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function V(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(V,this),this.reset(!0)}function E(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=w.constructor=y,y.constructor=v,y[s]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},_(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i){var a=new S(l(t,n,r,i));return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(w),w[s]="Generator",w[a]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=E,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:E(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var ku=Ue.find,wu=!0;"find"in[]&&Array(1).find((function(){wu=!1})),Te({target:"Array",proto:!0,forced:wu},{find:function(e){return ku(this,e,arguments.length>1?arguments[1]:void 0)}}),jr("find");var _u=[],Su=_u.sort,xu=u((function(){_u.sort(void 0)})),Vu=u((function(){_u.sort(null)})),Iu=We("sort");Te({target:"Array",proto:!0,forced:xu||!Vu||Iu},{sort:function(e){return void 0===e?Su.call(Be(this)):Su.call(Be(this),Le(e))}});var Cu=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$message=null,e._message=null,e._id=Ws.uniqueId(),e._first=!1,e}return at(t,e),it(t,[{key:"isFirst",value:function(){return this._first}},{key:"setFirst",value:function(e){return this._first!==e&&(this._first=e,e?this.getElement().classList.add("field--first"):this.getElement().classList.remove("field--first")),this}},{key:"getMessage",value:function(){return this._message}},{key:"setMessage",value:function(e){return this._message=e,this.update()}},{key:"clearMessage",value:function(){return this.setMessage(null)}},{key:"getId",value:function(){return this._id}},{key:"render",value:function(){return Ht.createElement("div",{className:"field"+(this._first?" field--first":"")},[this.renderLabel(),this.renderField()])}},{key:"renderLabel",value:function(){return Ht.createElement("label",{className:"field__label",htmlFor:this.getId()},this.getModel().getLabel())}},{key:"renderField",value:function(){return Ht.createElement("div",{className:"field__field"})}},{key:"renderMessage",value:function(){return null!==this.getMessage()?Ht.createElement("div",{className:"field__message"},this.getMessage()):null}},{key:"didRender",value:function(){dt(ot(t.prototype),"didRender",this).call(this),this.updateValue()}},{key:"update",value:function(){var e=this.getElement();return e.dataset.width=this.getModel().getWidth(),this.hasFocus()?e.classList.add("field--focus"):e.classList.remove("field--focus"),this.getModel().isValid()&&null===this.getMessage()?e.classList.remove("field--invalid"):e.classList.add("field--invalid"),null!==this._$message&&null!==this._$message.parentNode&&this._$message.parentNode.removeChild(this._$message),this._$message=null,this._$message=this.renderMessage(),null!==this._$message&&this.getElement().appendChild(this._$message),this}},{key:"didFocus",value:function(){this.getElement().classList.add("field--focus")}},{key:"didBlur",value:function(){this.getElement().classList.remove("field--focus")}},{key:"updateValue",value:function(){return this}}]),t}(Ht),Eu=function(e){function t(){return nt(this,t),ht(this,ot(t).apply(this,arguments))}return at(t,e),it(t,[{key:"render",value:function(){return Ht.createElement("div",{className:"form"})}},{key:"appendSubviewElement",value:function(e){if(e instanceof Cu){this.getElement();var n=this.getSubviews().filter((function(e){return e instanceof Cu}));n.push(e);var r=this.getModel().getFields();n.sort((function(e,t){return r.indexOf(e.getModel())-r.indexOf(t.getModel())}));var i=n.indexOf(e),a=i<n.length-1?n[i+1].getElement():null;this.getElement().insertBefore(e.getElement(),a);var o=0;return n.forEach((function(e){var t=e.getModel().getWidth();(o+=t)===t||o>12?(o=t,e.setFirst(!0)):e.setFirst(!1)})),this}return dt(ot(t.prototype),"appendSubviewElement",this).call(this,e)}}]),t}(Ht),Au='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 7H3.83l3.58-3.59L6 2 0 8l6 6 1.41-1.41L3.83 9H16z"/></svg>',Mu={forward:Au,backward:Au,error:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M15 2.41L13.59 1 8 6.59 2.41 1 1 2.41 6.59 8 1 13.59 2.41 15 8 9.41 13.59 15 15 13.59 9.41 8z"/></svg>'},Tu=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$menu=null,e._$body=null,e._$settings=null,e._$header=null,e._$status=null,e._$statusIcon=null,e._$statusMessage=null,e._menuVisible=!1,e._menuHideHandler=e.toggleMenu.bind(ct(e)),e}return at(t,e),it(t,[{key:"render",value:function(){this._$settings=this.renderSettings(),this._$header=this.renderHeader();var e=this.getModel().getMeta();return Ht.createElement("div",{className:"brick",role:"region",ariaLabel:"".concat(e.title," ").concat(e.type)},[this._$header,this._$settings,this.renderContent(),this.renderStatus()])}},{key:"renderHeader",value:function(){var e=this;this._$menu=this.renderMenu();var t=Ht.createElement("button",{className:"brick__btn-menu",onClick:function(t){t.preventDefault(),e.toggleMenu()}});t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><circle cx="8" cy="2" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="14" r="1.5"/></svg>';var n=Ht.createElement("div",{className:"brick__title-caret"});return n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3 6l5 5 5-5z"/></svg>',Ht.createElement("header",{className:"brick__header"},[Ht.createElement("button",{className:"brick__title",onClick:function(t){t.preventDefault(),e.getModel().viewReplaceButtonDidClick(e)}},[Ht.createElement("h3",{className:"brick__title-inner"},this.getModel().getTitle()),n]),t])}},{key:"renderMenu",value:function(){var e=this,t=[];return this.getModel().hasPipe()&&(t.push({label:"Remove",name:"remove"}),t.push({label:"Hide",name:"hide"}),t.push({label:"Duplicate",name:"duplicate"})),this.getModel().isRandomizable()&&t.push({label:"Randomize",name:"randomize"}),Ht.createElement("div",{className:"brick__menu menu"},[Ht.createElement("ul",{className:"menu__list"},t.map((function(t){return Ht.createElement("li",{className:"menu__item"},[Ht.createElement("button",{className:"menu__button",onClick:function(n){n.preventDefault(),e.getModel().viewMenuItemDidClick(e,t.name)}},t.label)])})))])}},{key:"renderSettings",value:function(){return Ht.createElement("div",{className:"brick__settings"})}},{key:"renderContent",value:function(){return Ht.createElement("div",{className:"brick__content"})}},{key:"renderStatus",value:function(){return this._$statusIcon=Ht.createElement("div",{className:"brick__status-icon"}),this._$statusMessage=Ht.createElement("div",{className:"brick__status-message"}),this._$status=Ht.createElement("footer",{className:"brick__status brick__status--hidden"},[this._$statusIcon,this._$statusMessage]),this._$status}},{key:"appendSubviewElement",value:function(e){return e instanceof Eu?(this.getElement(),this._$settings.appendChild(e.getElement()),this):dt(ot(t.prototype),"appendSubviewElement",this).call(this,e)}},{key:"didFocus",value:function(){this.getElement().classList.add("brick--focus")}},{key:"didBlur",value:function(){this.getElement().classList.remove("brick--focus")}},{key:"toggleMenu",value:function(){var e=this;this._menuVisible=!this._menuVisible,this._menuVisible?(this._$header.appendChild(this._$menu),this._$menu.getBoundingClientRect(),this._$menu.classList.add("menu--visible"),window.requestAnimationFrame((function(){window.addEventListener("click",e._menuHideHandler)}))):(this._$header.removeChild(this._$menu),window.removeEventListener("click",this._menuHideHandler))}},{key:"updateStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===e?(this._$status.classList.add("brick__status--hidden"),this._$statusIcon.innerHTML=null,this._$statusMessage.innerText=null):(this._$status.className="brick__status brick__status--".concat(e),this._$statusIcon.innerHTML=Mu[e]||"",this._$statusMessage.innerText=t||"","forward"!==e&&"backward"!==e||(this._$status.classList.add("brick__status--flash"),this._$status.getBoundingClientRect(),this._$status.classList.remove("brick__status--flash"))),this}}]),t}(Ht),Lu=null,Pu=function(){function e(){nt(this,e),this._observerNames=[],this._observerCallbacks=[]}return it(e,[{key:"trigger",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;-1!==(n=this._observerNames.indexOf(e,n));)this._observerCallbacks[n](e,t),n++;return this}},{key:"subscribe",value:function(e,t){return this._observerNames.push(e),this._observerCallbacks.push(t),this}},{key:"unsubscribe",value:function(e,t){for(var n=0;-1!==(n=this._observerNames.indexOf(e,n));)this._observerCallbacks[n]===t?(this._observerNames.splice(n,1),this._observerCallbacks.splice(n,1)):n++;return this}}],[{key:"getSharedInstance",value:function(){return null===Lu&&(Lu=new e),Lu}},{key:"trigger",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.getSharedInstance().trigger(t,n)}}]),e}(),Bu=function(){function e(){nt(this,e),this._view=null,this._viewPrototype=Ht}return it(e,[{key:"hasView",value:function(){return null!==this._view}},{key:"getView",value:function(){return null===this._view&&(this._view=new this._viewPrototype,this._view.setModel(this),this.didCreateView(this._view)),this._view}},{key:"updateView",value:function(){return this.hasView()&&this.getView().setNeedsUpdate(),this}},{key:"didCreateView",value:function(e){}}]),e}(),zu=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nt(this,t),(n=ht(this,ot(t).call(this)))._viewPrototype=Cu,n._name=e,n._value=void 0!==r.value?r.value:null,n._delegate=r.delegate||null,n._randomizable=!1!==r.randomizable,n._valid=!0,n._message=null,n._messageKey=null,n._validateValueCallback=r.validateValue||null,n._filterValueCallback=r.filterValue||null,n._randomizeValueCallback=r.randomizeValue||null,n._label=r.label||Ws.camelCaseToRegular(e),n._visible=!1!==r.visible,n._priority=void 0!==r.priority?r.priority:0,n._width=r.width||12,n}return at(t,e),it(t,[{key:"getName",value:function(){return this._name}},{key:"getLabel",value:function(){return this._label}},{key:"isVisible",value:function(){return this._visible}},{key:"setVisible",value:function(e){return this._visible=e,this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getPriority",value:function(){return this._priority}},{key:"setPriority",value:function(e){return this._priority=e,this._delegate&&this._delegate.fieldPriorityDidChange&&this._delegate.fieldPriorityDidChange(this,e),this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getWidth",value:function(){return this._width}},{key:"setWidth",value:function(e){return this._width=e,this.updateView(),this._delegate&&this._delegate.fieldNeedsLayout&&this._delegate.fieldNeedsLayout(this),this}},{key:"getDelegate",value:function(){return this._delegate}},{key:"setDelegate",value:function(e){return this._delegate=e,this}},{key:"unsetDelegate",value:function(){return this._delegate=null,this}},{key:"isValid",value:function(){return this._valid}},{key:"getMessage",value:function(){return this._message}},{key:"getMessageKey",value:function(){return this._messageKey}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.validateValue(e);if(this._valid=!0===n,this._valid?(this._message=null,this._messageKey=null):"object"===tt(n)?(this._message=n.message,this._messageKey=n.key):(this._message="The value is invalid",this._messageKey="invalid"),this.hasView()&&this.getView().setMessage(this.getMessage()),!this._valid)return this._value=e,this;var r=this.filterValue(e),i=r instanceof el?r.isEqualTo(this._value):this._value===r;return i||(this._value=r,this.hasView()&&this.getView()!==t&&this.getView().updateValue(),this._delegate&&this._delegate!==t&&void 0!==this._delegate.fieldValueDidChange&&this.getDelegate().fieldValueDidChange(this,r)),this}},{key:"revalidateValue",value:function(){return this.setValue(this.getValue())}},{key:"validateValue",value:function(e){return null===this._validateValueCallback||this._validateValueCallback(e,this)}},{key:"filterValue",value:function(e){return null!==this._filterValueCallback?this._filterValueCallback(e,this):e}},{key:"isRandomizable",value:function(){return this._randomizable}},{key:"randomize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.isRandomizable())return this;var t=this.randomizeValue(e||new ys);return null!==t?this.setValue(t):this}},{key:"randomizeValue",value:function(e){return this.randomizeValueWithCallback(e)}},{key:"randomizeValueWithCallback",value:function(e){return null!==this._randomizeValueCallback?this._randomizeValueCallback(e,this):null}},{key:"isCustomRandomizationSet",value:function(){return null!==this._randomizeValueCallback}},{key:"serializeValue",value:function(){if(!this.isValid())throw new Error("Invalid field values can't be serialized.");var e=this.getValue();if("boolean"!=typeof e&&"number"!=typeof e&&"string"!=typeof e&&null!==e)throw new Error("Field value serialization is not possible. Generic fields can only serialize boolean, number, string or null values safely. "+"Received value type '".concat(tt(e),"'."));return e}},{key:"extract",value:function(e){return this.setValue(this.extractValue(e)),this}},{key:"extractValue",value:function(e){return e}},{key:"didCreateView",value:function(e){this.getView().setMessage(this.getMessage())}}]),t}(Bu),Ou=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$input=null,e}return at(t,e),it(t,[{key:"updateValue",value:function(){return this._$input.checked=this.getModel().getValue(),this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("field-boolean"),e}},{key:"renderField",value:function(){var e=this;this._$input=Ht.createElement("input",{className:"field-boolean__input",type:"checkbox",id:this.getId(),onChange:this.inputValueDidChange.bind(this),checked:this.getModel().getValue(),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=Ht.createElement("label",{className:"field-boolean__toggle",htmlFor:this.getId()},[Ht.createElement("span",{className:"field-boolean__choice"},this.getModel().getTrueLabel()),Ht.createElement("span",{className:"field-boolean__choice"},this.getModel().getFalseLabel())]),r=dt(ot(t.prototype),"renderField",this).call(this);return r.appendChild(this._$input),r.appendChild(n),r}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.checked)}}]),t}(Cu),Fu=[!0,1,"1","true"],Nu=[!1,0,"0","false"],Ru=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nt(this,t),(n=ht(this,ot(t).call(this,e,r)))._viewPrototype=Ou,n._trueLabel=r.trueLabel||"Yes",n._falseLabel=r.falseLabel||"No",n}return at(t,e),it(t,[{key:"getTrueLabel",value:function(){return this._trueLabel}},{key:"getFalseLabel",value:function(){return this._falseLabel}},{key:"validateValue",value:function(e){return-1===Fu.indexOf(e)&&-1===Nu.indexOf(e)?{key:"booleanInvalid",message:"The value is not a boolean"}:dt(ot(t.prototype),"validateValue",this).call(this,e)}},{key:"filterValue",value:function(e){return dt(ot(t.prototype),"filterValue",this).call(this,-1!==Fu.indexOf(e))}},{key:"randomizeValue",value:function(e){var n=dt(ot(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:e.nextBoolean()}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(zu),Du=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$input=null,e}return at(t,e),it(t,[{key:"updateValue",value:function(){var e=this.getModel().getValue(),t=Xs.hexStringFromBytes(e);return t=Ws.chunk(t,2).join(" "),this._$input.value=t,this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("field-byte"),e}},{key:"renderField",value:function(){var e=this;this._$input=Ht.createElement("input",{className:"field-byte__input",id:this.getId(),type:"text",spellcheck:!1,onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=dt(ot(t.prototype),"renderField",this).call(this);return n.classList.remove("field__field"),n.classList.add("field-byte__field"),n.appendChild(this._$input),n}},{key:"inputValueDidChange",value:function(e){var t=Ws.removeWhitespaces(this._$input.value);if(null===t.match(/^[0-9a-f]+$/gi))return this.setMessage("The value contains non-hexadecimal characters");this.clearMessage();var n=Xs.bytesFromHexString(t);this.getModel().viewValueDidChange(this,n)}}]),t}(Cu),ju=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nt(this,t),(n=ht(this,ot(t).call(this,e,r)))._viewPrototype=Du,n._value=r.value||new Uint8Array,n._minSize=null,n._maxSize=null,n._randomizeSize=r.randomizeSize||null,n.setMinSize(r.minSize||null,!1),n.setMaxSize(r.maxSize||null,!1),n}return at(t,e),it(t,[{key:"getMinSize",value:function(){return this._minSize}},{key:"setMinSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._minSize===e?this:(this._minSize=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getMaxSize",value:function(){return this._maxSize}},{key:"setMaxSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._maxSize===e?this:(this._maxSize=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"validateValue",value:function(e){return e instanceof Uint8Array?null!==this._minSize&&e.length<this._minSize?{key:"byteSizeTooShort",message:"The value must be at least ".concat(this._minSize," ")+"".concat(1===this._minSize?"byte":"bytes"," long, ")+"found ".concat(e.length," ").concat(1===e.length?"byte":"bytes")}:null!==this._maxSize&&e.length>this._maxSize?{key:"byteSizeTooLong",message:"The value must not exceed ".concat(this._maxSize," ")+"".concat(1===this._maxSize?"byte":"bytes"," in length, ")+"found ".concat(e.length," ").concat(1===e.length?"byte":"bytes")}:dt(ot(t.prototype),"validateValue",this).call(this,e):{key:"byteUnexpectedType",message:"The value is expected to be of type Uint8Array"}}},{key:"randomizeValue",value:function(e){var n=dt(ot(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:null!==this._randomizeSize?e.nextBytes(this._randomizeSize):null!==this.getMinSize()?e.nextBytes(this.getMinSize()):this.isValid()?e.nextBytes(this.getValue().length):null}},{key:"serializeValue",value:function(){return Xs.base64StringFromBytes(this.getValue())}},{key:"extractValue",value:function(e){if("string"!=typeof e)throw new Error("Value of field '".concat(this.getName(),"' is expected to be a valid ")+"base64 string.");return Xs.bytesFromBase64String(e)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(zu),qu=ge.includes;Te({target:"Array",proto:!0},{includes:function(e){return qu(this,e,arguments.length>1?arguments[1]:void 0)}}),jr("includes");var $u=function(e){if(In(e))throw TypeError("The method doesn't accept regular expressions");return e},Uu=Re("match");Te({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Uu]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(k(this)).indexOf($u(e),arguments.length>1?arguments[1]:void 0)}});var Wu=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._style="default",e._$select=null,e._$$radio=[],e}return at(t,e),it(t,[{key:"getStyle",value:function(){return this._style}},{key:"setStyle",value:function(e){return this._style!==e&&(this._style=e,this.refresh()),this}},{key:"updateValue",value:function(){var e=this.getModel().getSelectedIndex();return"radio"===this.getStyle()?this._$$radio.forEach((function(t,n){t.checked=n===e})):this._$select.value=e,this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.className+=" field-enum field-enum--".concat(this.getStyle()),e}},{key:"renderField",value:function(){var e=this,n=this.getModel().getElementLabels(),r=this.getModel().getElementDescriptions(),i=dt(ot(t.prototype),"renderField",this).call(this);if(i.classList.remove("field__field"),i.classList.add("field-enum__field"),"radio"===this.getStyle()){this._$$radio=[];var a=Ht.createElement("div",{className:"field-enum__options",role:"radiogroup",id:this.getId()});i.appendChild(a),n.map((function(t,n){var r="".concat(e.getId(),"-").concat(n+1),i=Ht.createElement("input",{type:"radio",className:"field-enum__option-radio",id:r,onChange:e.valueDidChange.bind(e),name:e.getId()}),o=Ht.createElement("div",{className:"field-enum__option"},[i,Ht.createElement("label",{htmlFor:r,className:"field-enum__option-label"},t)]);e._$$radio.push(i),a.appendChild(o)}))}else{var o=n.map((function(e,t){return Ht.createElement("option",{value:t,title:r[t]||""},e)}));this._$select=Ht.createElement("select",{className:"field-enum__select",id:this.getId(),onChange:this.valueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}},o),i.appendChild(this._$select)}return i}},{key:"valueDidChange",value:function(e){var t="radio"===this.getStyle()?this._$$radio.findIndex((function(e){return e.checked})):parseInt(this._$select.value),n=this.getModel().getElementAt(t);this.getModel().viewValueDidChange(this,n)}}]),t}(Cu),Gu=function(e){function t(e,n){var r;return nt(this,t),(r=ht(this,ot(t).call(this,e,n)))._viewPrototype=Wu,r._elements=[],r._labels=[],r._descriptions=[],r._style=n.style||"default",r._blackChoiceList=n.blackChoiceList||[],r.setElements(n.elements,n.labels||null,n.descriptions||null,!1),r}return at(t,e),it(t,[{key:"getElements",value:function(){return this._elements}},{key:"getElementLabels",value:function(){return this._labels}},{key:"getElementDescriptions",value:function(){return this._descriptions}},{key:"setElements",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(0===e.length)throw new Error("Array of elements can't be empty.");if(null!==t&&e.length!==t.length)throw new Error("Element and label arrays require the same length.");if(null!==n&&e.length!==n.length)throw new Error("Element and description arrays require the same length.");return this._elements=e,this._labels=null!==t?t:e,this._descriptions=null!==n?n:e.map((function(){return null})),null===this._value&&(this._value=this._elements[0]),this.hasView()&&this.getView().refresh(),r?this.revalidateValue():this}},{key:"getElementAt",value:function(e){return e<this._elements.length?this._elements[e]:null}},{key:"getSelectedIndex",value:function(){return this._elements.indexOf(this.getValue())}},{key:"setSelectedIndex",value:function(e){var t=this._elements[e];return this.setValue(t)}},{key:"getStyle",value:function(){return this._style}},{key:"setStyle",value:function(e){return this._style=e,this.hasView()&&this.getView().setStyle(e),this}},{key:"getBlackChoiceList",value:function(){return this._blackChoiceList}},{key:"setBlackChoiceList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._blackChoiceList=e,t?this.revalidateValue():this}},{key:"validateValue",value:function(e){return-1===this._elements.indexOf(e)?{key:"enumNotInHaystack",message:"The value must be occur in the list of elements"}:this._blackChoiceList.includes(e)?{key:this.name,message:"Chosen option is not compatible with other settings"}:dt(ot(t.prototype),"validateValue",this).call(this,e)}},{key:"randomizeValue",value:function(e){var n=dt(ot(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:e.nextChoice(this._elements)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}},{key:"didCreateView",value:function(e){dt(ot(t.prototype),"didCreateView",this).call(this,e),this.getView().setStyle(this.getStyle())}}]),t}(zu),Hu=sn.trim,Ku=l.parseFloat,Zu=1/Ku(tn+"-0")!=-1/0?function(e){var t=Hu(String(e)),n=Ku(t);return 0===n&&"-"==t.charAt(0)?-0:n}:Ku;Te({global:!0,forced:parseFloat!=Zu},{parseFloat:Zu});var Xu,Yu=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$input=null,e._displayEnabled=!1,e._$display=null,e._$displayValue=null,e._$displayDescription=null,e}return at(t,e),it(t,[{key:"updateValue",value:function(){var e=this.getModel().getValue();return this._$input.value=e,this._updateValueDisplay(),this}},{key:"_updateValueDisplay",value:function(){var e=this.getModel().getValue(),t=this.getModel().getValueDescription(),n=null!==t;return this._displayEnabled!==n&&(this._displayEnabled=n,n?this._$display.classList.add("field-number__display--enabled"):(this._$display.classList.remove("field-number__display--enabled"),this._$displayValue.innerText="",this._$displayDescription.innerText="")),n&&(this._$displayValue.innerText=e,this._$displayDescription.innerText=t),this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("field-number"),e}},{key:"renderField",value:function(){var e=this;this._$input=Ht.createElement("input",{className:"field-number__input",id:this.getId(),type:"number",onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}}),this._$displayValue=Ht.createElement("span",{className:"field-number__display-value"}),this._$displayDescription=Ht.createElement("span",{className:"field-number__display-description"}),this._$display=Ht.createElement("div",{className:"field-number__display"},[this._$displayValue,this._$displayDescription]);var n=Ht.createElement("button",{className:"field-number__btn-step-down",onClick:this.stepDownButtonDidClick.bind(this)},"Step Down"),r=Ht.createElement("div",{className:"field-number__value"},[this._$input,this._$display]),i=Ht.createElement("button",{className:"field-number__btn-step-up",onClick:this.stepUpButtonDidClick.bind(this)},"Step Up"),a=dt(ot(t.prototype),"renderField",this).call(this);return a.classList.remove("field__field"),a.classList.add("field-number__field"),a.appendChild(n),a.appendChild(r),a.appendChild(i),a}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.value),this._updateValueDisplay()}},{key:"stepDownButtonDidClick",value:function(e){return this.getModel().stepDown(),e.preventDefault(),!1}},{key:"stepUpButtonDidClick",value:function(e){return this.getModel().stepUp(),e.preventDefault(),!1}}]),t}(Cu),Ju=function(e){function t(e,n){var r;return nt(this,t),(r=ht(this,ot(t).call(this,e,n)))._viewPrototype=Yu,r._integer=n.integer||!1,r._step=n.step||1,r._min=void 0!==n.min?n.min:null,r._max=void 0!==n.max?n.max:null,r._rotate=void 0!==n.rotate?n.rotate:null!==r._min&&null!==r._max,r._describeValueCallback=n.describeValue||null,r}return at(t,e),it(t,[{key:"isInteger",value:function(){return this._integer}},{key:"setInteger",value:function(e){return this._integer=e,this.revalidateValue()}},{key:"getStep",value:function(){return this._step}},{key:"setStep",value:function(e){return this._step=e,this}},{key:"stepValue",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=this.getValue(),r=0,i=!1;!i&&r++<t&&(this._rotate||e>0||n!==this._min)&&(this._rotate||e<0||n!==this._max);)n+=e,this._rotate&&n>this._max&&this._rotate?n=this._min:this._rotate&&n<this._min&&this._rotate&&(n=this._max+e),i=!0===this.validateValue(n);return i?n:null}},{key:"stepUp",value:function(){var e=this.stepValue(this._step);return null!==e?this.setValue(e):this}},{key:"stepDown",value:function(){var e=this.stepValue(-this._step);return null!==e?this.setValue(e):this}},{key:"getMin",value:function(){return this._min}},{key:"setMin",value:function(e){return this._min=e,this.revalidateValue()}},{key:"getMax",value:function(){return this._max}},{key:"setMax",value:function(e){return this._max=e,this.revalidateValue()}},{key:"isRotate",value:function(){return this._rotate}},{key:"setRotate",value:function(e){return this._rotate=e&&null!==this._min&&null!==this._max,this}},{key:"getValueDescription",value:function(){return this.isValid()&&null!==this._describeValueCallback?this._describeValueCallback(this.getValue(),this):null}},{key:"setNeedsValueDescriptionUpdate",value:function(){this.hasView()&&this.getView().updateValue()}},{key:"validateValue",value:function(e){var n=this.filterValue(e);return isNaN(n)||!isFinite(n)?{key:"numberNotNumeric",message:"The value is not numeric"}:null!==this._min&&n<this._min?{key:"numberTooSmall",message:"The value must be greater than or equal to ".concat(this._min)}:null!==this._max&&n>=this._max?{key:"numberTooLarge",message:"The value must be less than ".concat(this._max)}:dt(ot(t.prototype),"validateValue",this).call(this,n)}},{key:"filterValue",value:function(e){return e=this.isInteger()?parseInt(e):parseFloat(e),dt(ot(t.prototype),"filterValue",this).call(this,e)}},{key:"randomizeValue",value:function(e){var n=dt(ot(t.prototype),"randomizeValue",this).call(this,e);return null!==n?n:null!==this.getMin()&&null!==this.getMax()?this.isInteger()?e.nextInteger(this.getMin(),Math.ceil(this.getMax())-1):e.nextFloat(this.getMin(),this.getMax()):null}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(zu),Qu=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$input=null,e}return at(t,e),it(t,[{key:"updateValue",value:function(){return this._$input.value=this.getModel().getValue().getString(),this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("field-text"),e}},{key:"renderField",value:function(){var e=this;this._$input=Ht.createElement("input",{className:"field-text__input",id:this.getId(),type:"text",spellcheck:!1,onInput:this.inputValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}});var n=dt(ot(t.prototype),"renderField",this).call(this);return n.classList.remove("field__field"),n.classList.add("field-text__field"),n.appendChild(this._$input),n}},{key:"inputValueDidChange",value:function(e){this.getModel().viewValueDidChange(this,this._$input.value)}}]),t}(Cu),ec=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nt(this,t),(n=ht(this,ot(t).call(this,e,r)))._viewPrototype=Qu,n._value=el.wrap(r.value||null),n._minLength=null,n._maxLength=null,n._whitelistChars=null,n._blacklistChars=null,n._uniqueChars=!1,n._caseSensitivity=null,n.setMinLength(void 0!==r.minLength?r.minLength:null,!1),n.setMaxLength(void 0!==r.maxLength?r.maxLength:null,!1),n.setWhitelistChars(r.whitelistChars||null,!1),n.setBlacklistChars(r.blacklistChars||null,!1),n.setUniqueChars(r.uniqueChars||!1,!1),n.setCaseSensitivity(!1!==r.caseSensitivity,!1),n}return at(t,e),it(t,[{key:"getMinLength",value:function(){return this._minLength}},{key:"setMinLength",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._minLength===e?this:(this._minLength=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getMaxLength",value:function(){return this._maxLength}},{key:"setMaxLength",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._maxLength===e?this:(this._maxLength=null!==e?parseInt(e):null,t?this.revalidateValue():this)}},{key:"getWhitelistChars",value:function(){return this._whitelistChars}},{key:"setWhitelistChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._whitelistChars=null!==e?el.wrap(e).getCodePoints():null,t?this.revalidateValue():this}},{key:"getBlacklistChars",value:function(){return this._blacklistChars}},{key:"setBlacklistChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._blacklistChars=null!==e?el.wrap(e).getCodePoints():null,t?this.revalidateValue():this}},{key:"isUniqueChars",value:function(){return this._uniqueChars}},{key:"setUniqueChars",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._uniqueChars===e?this:(this._uniqueChars=e,t?this.revalidateValue():this)}},{key:"isCaseSensitive",value:function(){return this._caseSensitivity}},{key:"setCaseSensitivity",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._caseSensitivity===e?this:(this._caseSensitivity=e,t?this.revalidateValue():this)}},{key:"validateValue",value:function(e){if("function"!=typeof e.toString)return{key:"textInvalidString",message:"The value can't be casted to a string"};var n=this.filterValue(e);if(null!==this._minLength&&n.getLength()<this._minLength)return{key:"textLengthTooShort",message:"The value must be at least ".concat(this._minLength," ")+"".concat(1===this._minLength?"character":"characters"," long")};if(null!==this._maxLength&&n.getLength()>this._maxLength)return{key:"textLengthTooLong",message:"The value must not exceed ".concat(this._maxLength," ")+"".concat(1===this._maxLength?"character":"characters"," in length")};if(this._uniqueChars&&!ms.isUnique(n.getCodePoints()))return{key:"textCharactersNotUnique",message:"The value must not contain duplicate characters"};if(null!==this._whitelistChars||null!==this._blacklistChars){for(var r,i=this._whitelistChars,a=this._blacklistChars,o=[],s=0;s<n.getLength();s++)r=n.getCodePointAt(s),(null!==i&&-1===i.indexOf(r)||null!==a&&-1!==a.indexOf(r))&&o.push(n.getCharAt(s));if(o.length>0)return o=ms.unique(o),{key:"textForbiddenCharacter",message:"The value contains forbidden characters: "+"'".concat(o.join(""),"'")}}return dt(ot(t.prototype),"validateValue",this).call(this,n)}},{key:"filterValue",value:function(e){return e=el.wrap(e),!1===this._caseSensitivity&&(e=e.toLowerCase()),el.wrap(dt(ot(t.prototype),"filterValue",this).call(this,e))}},{key:"randomizeValue",value:function(e){var n=dt(ot(t.prototype),"randomizeValue",this).call(this,e);if(null!==n)return n;if(this.isValid()){if(this.isUniqueChars()){var r=this.getValue().getCodePoints();return el.wrap(ms.shuffle(r,e))}if(null!==this.getWhitelistChars()){for(var i=this.getValue().getLength(),a=[],o=0;o<i;o++)a.push(e.nextChoice(this.getWhitelistChars()));return el.wrap(a)}}return null}},{key:"serializeValue",value:function(){return this.getValue().getString()}},{key:"extractValue",value:function(e){if("string"!=typeof e)throw new Error("Value of field '".concat(this.getName(),"' is expected to be a string."));return el.wrap(e)}},{key:"viewValueDidChange",value:function(e,t){this.setValue(t,e)}}]),t}(zu),tc=null,nc=function(e){function t(){var e;nt(this,t),e=ht(this,ot(t).call(this));var n={boolean:Ru,bytes:ju,enum:Gu,number:Ju,text:ec};for(var r in n)e.register(r,n[r]);return e}return at(t,e),it(t,[{key:"create",value:function(e){if(!e.name)throw new Error("Field specification requires a 'name' field.");if(!e.type)throw new Error("Field specification requires a 'type' field.");if(!this.exists(e.type))throw new Error("Unknown Field type '".concat(e.type,"'."));return dt(ot(t.prototype),"create",this).call(this,e.type,e.name,e)}}],[{key:"getInstance",value:function(){return null===tc&&(tc=new t),tc}}]),t}(en),rc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=Eu,e._delegate=null,e._fieldFactory=r,e._fields=[],e.addFields(n),e}return at(t,e),it(t,[{key:"getFields",value:function(){return this._fields.slice()}},{key:"getInvalidFields",value:function(){return this._fields.filter((function(e){return!e.isValid()}))}},{key:"getVisibleFields",value:function(){return this._fields.filter((function(e){return e.isVisible()}))}},{key:"addFields",value:function(e){return e.forEach(this.addField.bind(this)),this}},{key:"removeFields",value:function(e){return e.forEach(this.removeField.bind(this)),this}},{key:"getField",value:function(e){return this._fields.find((function(t){return t.getName()===e}))||null}},{key:"addField",value:function(e){var t=e;if(!(e instanceof zu)){var n=e;void 0===n.priority&&(n.priority=this._calculateDefaultPriority()),t=this.getFieldFactory().create(n)}if(this.getField(t.getName()))throw new Error("Name '".concat(t.getName(),"' is already assigned to a field."));return this._fields.push(t),t.setDelegate(this),this._sortFields(),t.isVisible()&&this.hasView()&&this.getView().addSubview(t.getView()),this}},{key:"removeField",value:function(e){var t=e;if(!(e instanceof zu)){var n=e;void 0===n.priority&&(n.priority=this._calculateDefaultPriority()),t=this.getFieldFactory().create(n)}if(!this.getField(t.getName()))throw new Error("Field '".concat(t.getName(),"' is not assigned to the field."));var r=this._fields.indexOf(t);return this._fields.splice(r,1),t.unsetDelegate(),this._sortFields(),t.isVisible()&&this.hasView()&&this.getView().removeSubview(t.getView()),this}},{key:"getFieldValue",value:function(e){var t=this.getField(e);if(null===t)throw new Error("There is no field assigned to the name '".concat(e,"'."));return t.getValue()}},{key:"setFieldValue",value:function(e,t){var n=this.getField(e);if(null===n)throw new Error("There is no field assigned to the name '".concat(e,"'."));return n.setValue(t),this}},{key:"getFieldValues",value:function(){var e={};return this.getVisibleFields().forEach((function(t){e[t.getName()]=t.getValue()})),e}},{key:"setFieldValues",value:function(e){for(var t in e)this.setFieldValue(t,e[t]);return this}},{key:"getFieldFactory",value:function(){return null===this._fieldFactory&&(this._fieldFactory=nc.getInstance()),this._fieldFactory}},{key:"setFieldFactory",value:function(e){return this._fieldFactory=e,this}},{key:"isValid",value:function(){return 0===this.getInvalidFields().length}},{key:"isRandomizable",value:function(){return void 0!==this._fields.find((function(e){return e.isRandomizable()}))}},{key:"randomize",value:function(){return this._fields.filter((function(e){return e.isVisible()&&e.isRandomizable()})).forEach((function(e){return e.randomize()})),this}},{key:"getDelegate",value:function(){return this._delegate}},{key:"setDelegate",value:function(e){return this._delegate=e,this}},{key:"serializeValues",value:function(){var e={};return this.getVisibleFields().forEach((function(t){e[t.getName()]=t.serializeValue()})),e}},{key:"extract",value:function(e){return this.setFieldValues(this.extractValues(e))}},{key:"extractValues",value:function(e){if("object"!==tt(e))throw new Error("Serialized form values is expected to be an object mapping field names to their respective serialized values. "+"Received value type '".concat(tt(e),"'."));var t={};for(var n in e){if("string"!=typeof n)throw new Error("Field name is expected to be a string. "+"Received type '".concat(tt(n),"'."));var r=this.getField(n);if(null===r)throw new Error("There is no field assigned to the name '".concat(n,"'."));t[n]=r.extractValue(e[n])}return t}},{key:"_calculateDefaultPriority",value:function(){if(0===this._fields.length)return 0;for(var e=this._fields[0].getPriority(),t=1;t<this._fields.length;t++)e=Math.min(e,this._fields[t].getPriority());return e-1}},{key:"_sortFields",value:function(){this._fields.sort((function(e,t){return t.getPriority()-e.getPriority()}))}},{key:"didCreateView",value:function(e){var t=this;this._fields.forEach((function(e){return t.fieldNeedsLayout(e)}))}},{key:"fieldPriorityDidChange",value:function(e,t){this._sortFields()}},{key:"fieldNeedsLayout",value:function(e){this.hasView()&&(e.getView().removeFromSuperview(),e.isVisible()&&this.getView().addSubview(e.getView()))}},{key:"fieldValueDidChange",value:function(e,t){this._delegate&&this._delegate.formValueDidChange&&this.getDelegate().formValueDidChange(this,e,t)}}]),t}(Bu),ic=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._pipe=null,e._viewPrototype=Tu,e._settingsForm=new rc,e._settingsForm.setDelegate(ct(e)),e._title=null,e._hidden=!1,e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){throw new Error("Brick static method 'getMeta' has not been overridden.")}}]),it(t,[{key:"getPipe",value:function(){return this._pipe}},{key:"hasPipe",value:function(){return null!==this._pipe}},{key:"setPipe",value:function(e){return this._pipe=e,this}},{key:"getMeta",value:function(){return this.constructor.getMeta()}},{key:"getName",value:function(){return this.getMeta().name}},{key:"getTitle",value:function(){return null===this._title?this.getMeta().title:this._title}},{key:"setTitle",value:function(e){return this._title=e&&e!==this.getMeta().title?e:null,this}},{key:"isHidden",value:function(){return this._hidden}},{key:"setHidden",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._hidden!==e&&(this._hidden=e,this.hasPipe()&&this.getPipe().brickVisibilityDidChange(this,e)),this}},{key:"getSettingsForm",value:function(){return this._settingsForm}},{key:"getSettings",value:function(){return this._settingsForm.getFields()}},{key:"addSettings",value:function(e){return this._settingsForm.addFields(e),this}},{key:"removeSettings",value:function(e){return this._settingsForm.removeFields(e),this}},{key:"getSetting",value:function(e){return this._settingsForm.getField(e)}},{key:"addSetting",value:function(e){return this._settingsForm.addField(e),this}},{key:"removeSetting",value:function(e){return this._settingsForm.removeField(e),this}},{key:"getSettingValue",value:function(e){return this._settingsForm.getFieldValue(e)}},{key:"setSettingValue",value:function(e,t){return this._settingsForm.setFieldValue(e,t),this}},{key:"getSettingValues",value:function(){return this._settingsForm.getFieldValues()}},{key:"setSettingValues",value:function(e){return this._settingsForm.setFieldValues(e),this}},{key:"isValid",value:function(){return this._settingsForm.isValid()}},{key:"isSettingValid",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return void 0===n.find((function(t){return!e.getSetting(t).isValid()}))}},{key:"isRandomizable",value:function(){return this._settingsForm.isRandomizable()}},{key:"randomize",value:function(){return this._settingsForm.randomize(),this}},{key:"formValueDidChange",value:function(e,t,n){e===this._settingsForm&&(this.settingValueDidChange(t,n),this.hasPipe()&&this.getPipe().brickSettingDidChange(this))}},{key:"settingValueDidChange",value:function(e,t){}},{key:"didCreateView",value:function(e){e.addSubview(this._settingsForm.getView())}},{key:"viewMenuItemDidClick",value:function(e,t){switch(Pu.trigger("brickMenuItemClick",{brick:this,menuItem:t}),t){case"remove":this.getPipe().removeBrick(this);break;case"hide":this.setHidden(!0);break;case"duplicate":this.isValid()&&this.getPipe().duplicateBrick(this);break;case"randomize":this.randomize()}}},{key:"viewReplaceButtonDidClick",value:function(e){this.hasPipe()&&(Pu.trigger("brickReplaceButtonClick",{brick:this}),this.getPipe().brickReplaceButtonDidClick(this))}},{key:"serialize",value:function(){var e={};e.name=this.getName(),null!==this._title&&(e.title=this._title),this.isHidden()&&(e.hidden=!0);var t=this._settingsForm.serializeValues();return Object.keys(t).length>0&&(e.settings=t),e}},{key:"copy",value:function(){if(!this.isValid())throw new Error("Invalid bricks can't be copied.");var e=new this.constructor;return e.setTitle(this.getTitle()),e.setHidden(this.isHidden()),e.setSettingValues(this.getSettingValues()),e}}],[{key:"extract",value:function(e,t){if("string"!=typeof e.name)throw new Error("Brick property 'name' is expected to be of type 'string'");var n=e.name;if(!t.exists(n))throw new Error("Brick property 'name' refers to an unknown brick '".concat(n,"'"));var r=t.create(n);if(void 0!==e.title){if("string"!=typeof e.title)throw new Error("Optional brick property 'title' is expected to be of type 'string'");r.setTitle(e.title)}if(void 0!==e.hidden){if("boolean"!=typeof e.hidden)throw new Error("Optional brick property 'hidden' is expected to be of type 'boolean'");r.setHidden(e.hidden)}if(void 0!==e.reverse){if("function"!=typeof r.setReverse)throw new Error("Optional brick property 'reverse' can only be set on encoder bricks");if("boolean"!=typeof e.reverse)throw new Error("Optional brick property 'reverse' is expected to be of type 'boolean'");r.setReverse(e.reverse)}return void 0!==e.settings&&r.getSettingsForm().extract(e.settings),r}}]),t}(Bu),ac=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$encodeAction=null,e._$decodeAction=null,e}return at(t,e),it(t,[{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("encoder"),e}},{key:"renderHeader",value:function(){this._$encodeAction=Ht.createElement("a",{className:"brick__action brick__action--active",href:"#",onClick:this.actionDidClick.bind(this,"encode"),draggable:!1},"Encode"),this._$decodeAction=Ht.createElement("a",{className:"brick__action",href:"#",onClick:this.actionDidClick.bind(this,"decode"),draggable:!1},"Decode");var e=Ht.createElement("ul",{className:"brick__actions"},[Ht.createElement("li",{className:"brick__action-item"},this._$encodeAction),Ht.createElement("li",{className:"brick__action-item"},this._$decodeAction)]),n=dt(ot(t.prototype),"renderHeader",this).call(this);return n.insertBefore(e,n.firstChild),n}},{key:"renderContent",value:function(){return null}},{key:"actionDidClick",value:function(e,t){t.preventDefault();var n="decode"===e;this.getModel().isReverse()!==n&&this.getModel().viewDidReverse(this)}},{key:"update",value:function(){var e=this.getModel().isReverse();e?(this._$encodeAction.classList.remove("brick__action--active"),this._$decodeAction&&this._$decodeAction.classList.add("brick__action--active")):(this._$encodeAction.classList.add("brick__action--active"),this._$decodeAction&&this._$decodeAction.classList.remove("brick__action--active"));var t=this.getModel().getLastError(),n=this.getModel().getLastTranslationMeta();if(null!==n){var r=n.isEncode?"forward":"backward",i="".concat(n.isEncode!==e?"Encoded":"Decoded"," ");return null!==n.charCount?i+="".concat(n.charCount," ")+"".concat(1===n.charCount?"char":"chars"):i+="".concat(n.byteCount," ")+"".concat(1===n.byteCount?"byte":"bytes"),this.updateStatus(r,i)}return null!==t?this.updateStatus("error",t.message):this}}]),t}(Tu),oc=function(){function e(){nt(this,e)}return it(e,null,[{key:"mod",value:function(e,t){var n=e%(t=t<0?-t:t);return n<0?n+t:n}},{key:"div",value:function(e,t){return Math.floor(e/t)}},{key:"isCoprime",value:function(t,n){return 1===e.gcd(t,n)}},{key:"gcd",value:function(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}},{key:"xgcd",value:function(t,n){if(0===n)return[1,0,t];var r=ft(e.xgcd(n,t%n),3),i=r[0],a=r[1],o=r[2];return[a,i-a*e.div(t,n),o]}},{key:"time",value:function(){return"undefined"!=typeof window&&void 0!==window.performance?window.performance.now():"undefined"!=typeof process?process.hrtime()[1]/1e6:parseFloat((new Date).getTime())}}]),e}(),sc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=ac,e._reverse=!1,e._encodeOnly=!1,e._lastError=null,e._lastTranslationMeta=null,e}return at(t,e),it(t,[{key:"encode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.translate(e,!0));case 1:case"end":return t.stop()}}),null,this)}},{key:"decode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.translate(e,!1));case 1:case"end":return t.stop()}}),null,this)}},{key:"translate",value:function(e,t){var n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,n=oc.time(),t!==this._reverse||!this.isEncodeOnly()){i.next=4;break}throw new Hs("Decoding is not defined in brick '".concat(this.getMeta().title,"'"));case 4:if(!((r=this.getSettingsForm().getInvalidFields()).length>0)){i.next=7;break}throw new Hs("Can't ".concat(t?"encode":"decode"," with invalid settings: ")+r.map((function(e){return e.getLabel()+" ("+(e.getMessage()||"none")+")"})).join(", "));case 7:if(e=el.wrap(e),t===this._reverse){i.next=26;break}return i.t0=el,i.next=12,regeneratorRuntime.awrap(this.willEncode(e));case 12:return i.t1=i.sent,e=i.t0.wrap.call(i.t0,i.t1),i.t2=el,i.next=17,regeneratorRuntime.awrap(this.performEncode(e));case 17:return i.t3=i.sent,e=i.t2.wrap.call(i.t2,i.t3),i.t4=el,i.next=22,regeneratorRuntime.awrap(this.didEncode(e));case 22:i.t5=i.sent,e=i.t4.wrap.call(i.t4,i.t5),i.next=41;break;case 26:return i.t6=el,i.next=29,regeneratorRuntime.awrap(this.willDecode(e));case 29:return i.t7=i.sent,e=i.t6.wrap.call(i.t6,i.t7),i.t8=el,i.next=34,regeneratorRuntime.awrap(this.performDecode(e));case 34:return i.t9=i.sent,e=i.t8.wrap.call(i.t8,i.t9),i.t10=el,i.next=39,regeneratorRuntime.awrap(this.didDecode(e));case 39:i.t11=i.sent,e=i.t10.wrap.call(i.t10,i.t11);case 41:return this._lastError=null,this._lastTranslationMeta={isEncode:t,duration:oc.time()-n,byteCount:e.needsByteEncoding()?null:e.getSize(),charCount:e.needsTextEncoding()?null:e.getLength()},this.updateView(),i.abrupt("return",e);case 47:throw i.prev=47,i.t12=i.catch(0),this._lastError=i.t12,this._lastTranslationMeta=null,this.updateView(),i.t12;case 53:case"end":return i.stop()}}),null,this,[[0,47]])}},{key:"isReverse",value:function(){return this._reverse}},{key:"setReverse",value:function(e){return this._reverse!==e&&(this._reverse=e,this.updateView(),this.hasPipe()&&this.getPipe().encoderDidReverse(this,e)),this}},{key:"isEncodeOnly",value:function(){return this._encodeOnly}},{key:"setEncodeOnly",value:function(e){return this._encodeOnly=e,this}},{key:"getLastError",value:function(){return this._lastError}},{key:"getLastTranslationMeta",value:function(){return this._lastTranslationMeta}},{key:"serialize",value:function(){var e=dt(ot(t.prototype),"serialize",this).call(this);return this.isReverse()&&(e.reverse=!0),e}},{key:"copy",value:function(){var e=dt(ot(t.prototype),"copy",this).call(this);return e.setReverse(this.isReverse()),e}},{key:"willEncode",value:function(e){return this.willTranslate(e,!0)}},{key:"performEncode",value:function(e){return this.performTranslate(e,!0)}},{key:"didEncode",value:function(e){return this.didTranslate(e,!0)}},{key:"willDecode",value:function(e){return this.willTranslate(e,!1)}},{key:"performDecode",value:function(e){return this.performTranslate(e,!1)}},{key:"didDecode",value:function(e){return this.didTranslate(e,!1)}},{key:"willTranslate",value:function(e,t){return e}},{key:"performTranslate",value:function(e,t){return e}},{key:"didTranslate",value:function(e,t){return e}},{key:"viewDidReverse",value:function(e){this.setReverse(!this.isReverse()),Pu.trigger("encoderReverse",{encoder:this,reverse:this.isReverse()})}}]),t}(ic),lc=0,uc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._mode=lc,e.registerSeparatorSetting(),e}return at(t,e),it(t,[{key:"setCharacterToBlockMode",value:function(){return this._mode=lc,this}},{key:"setBlockToCharacterMode",value:function(){return this._mode=1,this}},{key:"registerSeparatorSetting",value:function(){return this.addSetting({name:"separator",type:"text",value:" ",minLength:1,randomizable:!1,priority:-10})}},{key:"getSeparator",value:function(){return this.getSettingValue("separator")}},{key:"performEncode",value:function(e){var t=this;switch(this._mode){case lc:var n=e.getCodePoints().map((function(n,r){return t.performCharEncodeToBlock(n,r,e)})).filter((function(e){return null!==e})).map(el.wrap);return el.join(n,this.getSeparator());case 1:return e.split(this.getSeparator()).map((function(n,r,i){return t.performBlockEncodeToChar(n,r,i,e)})).filter((function(e){return null!==e}))}}},{key:"performDecode",value:function(e){var t=this;switch(this._mode){case lc:return e.split(this.getSeparator()).map((function(n,r,i){return t.performBlockDecodeToChar(n,r,i,e)})).filter((function(e){return null!==e}));case 1:var n=e.getCodePoints().map((function(n,r){return t.performCharDecodeToBlock(n,r,e)})).filter((function(e){return null!==e})).map(el.wrap);return el.join(n,this.getSeparator())}}},{key:"performCharEncodeToBlock",value:function(e,t,n){}},{key:"performBlockEncodeToChar",value:function(e,t,n,r){}},{key:"performCharDecodeToBlock",value:function(e,t,n){}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){}}]),t}(sc),cc={name:"a1z26",title:"A1Z26",category:"Ciphers",type:"encoder"},hc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:"abcdefghijklmnopqrstuvwxyz",uniqueChars:!0,minLength:2},{name:"caseSensitivity",type:"boolean",value:!1,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return cc}}]),it(t,[{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other");break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}},{key:"willEncode",value:function(e){return this.getSettingValue("caseSensitivity")?e:e.toLowerCase()}},{key:"performCharEncodeToBlock",value:function(e,t,n){var r=this.getSettingValue("caseSensitivity"),i=this.getSettingValue("alphabet");r||(i=i.toLowerCase());var a=i.indexOfCodePoint(e);return-1===a?null:(a+=1).toString()}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){var i=this.getSettingValue("caseSensitivity"),a=this.getSettingValue("alphabet");i||(a=a.toLowerCase());var o=parseInt(e);return isNaN(o)||o<1||o>a.getLength()?null:a.getCodePointAt(o-1)}}]),t}(uc),dc={name:"polybius-square",title:"Polybius square",category:"Polybius square ciphers",type:"encoder"},fc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"alphabet",type:"text",value:"abcdefghiklmnopqrstuvwxyz",uniqueChars:!0,minLength:2,validateValue:e.validateAlphabetValue.bind(ct(e)),caseSensitivity:!1},{name:"rows",type:"text",value:"12345",uniqueChars:!0,minLength:2,width:6,randomizable:!1,caseSensitivity:!1},{name:"columns",type:"text",value:"12345",uniqueChars:!0,minLength:2,width:6,randomizable:!1,caseSensitivity:!1},{name:"separator",type:"text",value:"",randomizable:!1,caseSensitivity:!1,validateValue:e.validateSeparatorValue.bind(ct(e))},{name:"caseSensitivity",type:"boolean",width:6,value:!1,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!1,randomizable:!1,trueLabel:"Include",falseLabel:"Ignore"}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return dc}}]),it(t,[{key:"willTranslate",value:function(e,t){return this.getSettingValue("caseSensitivity")?e:e.toLowerCase()}},{key:"performEncode",value:function(e){for(var t,n,r,i=this.getSettingValue("alphabet").getCodePoints(),a=this.getSettingValue("separator").getCodePoints(),o=this.getSettingValue("includeForeignChars"),s=this.getSettingValue("rows").getCodePoints(),l=this.getSettingValue("columns").getCodePoints(),u=l.length,c=e.getCodePoints(),h=a.length,d=c.length,f=new Array(d*(h+2)),g=0,p=!1,v=0;v<d;v++){if(t=c[v],n=i.indexOf(t),g>0&&(-1!==n||o&&!p))for(r=0;r<h;r++)f[g++]=a[r];p=!1,-1!==n?(f[g++]=s[Math.floor(n/u)],f[g++]=l[n%u]):o&&(f[g++]=t,p=!0)}return f.slice(0,g)}},{key:"performDecode",value:function(e){for(var t,n,r,i=this.getSettingValue("alphabet").getCodePoints(),a=this.getSettingValue("separator").getCodePoints(),o=this.getSettingValue("includeForeignChars"),s=this.getSettingValue("rows").getCodePoints(),l=this.getSettingValue("columns").getCodePoints(),u=ms.replaceSlice(e.getCodePoints(),a),c=i.length,h=l.length,d=u.length,f=new Array(d),g=0,p=0;g<d;){for(t=null;null===t&&g<d;)-1!==(r=s.indexOf(u[g]))?t=r:o&&(f[p++]=u[g]),g++;for(n=null;null===n&&g<d;)-1!==(r=s.indexOf(u[g]))?n=r:o&&(f[p++]=u[g]),g++;if(null!==t&&null!==n){if((r=t*h+n)>=c)throw new Hs("Polybius square cell at coordinates ".concat(t,",").concat(n," are not ")+"defined by the alphabet.");f[p++]=i[r]}else if(null!==t||null!==n)throw new Hs("Reached unexpected end of content. The last set of Polybius square coordinates is incomplete.")}return f.slice(0,p)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"caseSensitivity":this.getSetting("alphabet").setCaseSensitivity(t),this.getSetting("rows").setCaseSensitivity(t),this.getSetting("columns").setCaseSensitivity(t),this.getSetting("separator").setCaseSensitivity(t);break;case"columns":case"rows":this.getSetting("alphabet").revalidateValue()}}},{key:"validateAlphabetValue",value:function(e,t){var n=e.getLength(),r=this.getSettingValue("columns").getLength(),i=this.getSettingValue("rows").getLength();return n>i*r?{key:"polybiusSquareAlphabetTooLong",message:"The alphabet size ".concat(n," is too big for the given ")+"".concat(i,"×").concat(r," Polybius square defined by the settings ")+"'columns' and 'rows'."}:!(n<=(i-1)*r)||{key:"polybiusSquareAlphabetTooShort",message:"The alphabet size ".concat(n," is too short for the given ")+"".concat(i,"×").concat(r," Polybius square defined by the settings ")+"'columns' and 'rows'."}}},{key:"validateSeparatorValue",value:function(e,t){var n=this.getSettingValue("rows").getCodePoints();return n.concat(this.getSettingValue("columns").getCodePoints()),!(void 0!==e.getCodePoints().find((function(e){return-1!==n.indexOf(e)})))||{key:"polybiusSquareSeparatorInvalid",message:"The separator shall not contain characters from the Polybius square rows or columns"}}}]),t}(sc),gc={name:"adfgx-cipher",title:"ADFGX cipher",category:"Polybius square ciphers",type:"encoder"},pc="adfgx",vc=[{name:"adfgx",label:"ADFGX",squarePositions:"adfgx",alphabet:"zyxwvutsrqponmlkihgfedcba"},{name:"adfgvx",label:"ADFGVX",squarePositions:"adfgvx",alphabet:"9876543210zyxwvutsrqponmlkjihgfedcba"}],yc="abcdefghiklmnopqrstuvwxyz",mc=function(e){function t(){var e;nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",value:pc,elements:vc.map((function(e){return e.name})),labels:vc.map((function(e){return e.label})),randomizable:!1},{name:"alphabet",type:"text",value:yc,uniqueChars:!0,blacklistChars:" ",minLength:0,maxLength:25,caseSensitivity:!1},{name:"key",type:"text",value:"cargo",minLength:2,maxLength:24,caseSensitivity:!1}]);var n=e.constructor.getVariant(pc);return e._polybiusSquare=new fc,e._polybiusSquare.setSettingValues({alphabet:yc,rows:n.squarePositions,columns:n.squarePositions,separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return gc}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.getString(),"adfgx"===this.getSettingValue("variant")&&(t=t.replace(/j/gi,"i")),n=this.getSettingValue("key"),r=n.getLength(),i=this.mapElementsToSortedPosition(n.getChars()),f.next=8,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 8:for(a=f.sent,o=a.getLength(),s=new Array(o+r),d=0,l=0;l<r;l++)for(u=i[l],c=0;c*r+u<o;c++)h=c*r+u,s[d++]=a.getCodePointAt(h);return f.abrupt("return",ms.joinSlices(ms.chunk(s.slice(0,d),5),[32]));case 14:case"end":return f.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a=this.getSettingValue("variant"),o=this.constructor.getVariant(a),s=el.wrap(o.squarePositions).getCodePoints(),l=e.getCodePoints().filter((function(e){return-1!==s.indexOf(e)})),u=l.length,c=this.getSettingValue("key"),h=c.getLength(),d=this.mapElementsToSortedPosition(c.getChars()),f=u%h||h,g=Math.ceil(u/h),p=new Array(u),v=0;for(t=0;t<h;t++)for(i=(n=d[t])>=f?g-1:g,r=0;r<i;r++)p[r*h+n]=l[v++];return this._polybiusSquare.decode(p)}},{key:"mapElementsToSortedPosition",value:function(e){for(var t,n=e.length,r=new Array(n),i=e.slice(),a=e.slice().sort(),o=0;o<n;o++)t=i.indexOf(a[o]),r[o]=t,delete i[t];return r}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":var n=this.constructor.getVariant(t);this._polybiusSquare.setSettingValues({rows:n.squarePositions,columns:n.squarePositions});var r=this.getSetting("alphabet");r.isValid()&&this._polybiusSquare.setSettingValue("alphabet",r.getValue().extend(n.alphabet)),this.getSetting("alphabet").setMaxLength(n.alphabet.length),this.getSetting("key").setMaxLength(n.alphabet.length-1);break;case"alphabet":var i=this.constructor.getVariant(this.getSettingValue("variant"));this._polybiusSquare.setSettingValue("alphabet",t.extend(i.alphabet))}}}],[{key:"getVariant",value:function(e){return vc.find((function(t){return t.name===e}))||null}}]),t}(sc),bc={name:"affine-cipher",title:"Affine cipher",category:"Ciphers",type:"encoder"},kc="abcdefghijklmnopqrstuvwxyz",wc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"a",type:"number",label:"Slope / a",value:5,integer:!0,min:1,validateValue:e.validateSlopeValue.bind(ct(e)),randomizeValue:e.randomizeSlopeValue.bind(ct(e)),width:6},{name:"b",type:"number",label:"Intercept / b",value:8,integer:!0,min:1,randomizeValue:e.randomizeInterceptValue.bind(ct(e)),width:6},{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:kc,uniqueChars:!0,minLength:2,randomizable:!1,caseSensitivity:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!0,width:6,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return bc}}]),it(t,[{key:"performTranslate",value:function(e,t){var n,r=this.getSettingValues(),i=r.a,a=r.b,o=r.caseStrategy,s=r.includeForeignChars,l=this.getSettingValue("alphabet");"strict"!==o&&(n=(l=l.toLowerCase()).toUpperCase());var u,c,h,d,f,g,p=l.getLength(),v=e.getLength(),y=new Array(v).fill(0),m=0;for(h=0;h<v;h++)u=e.getCodePointAt(h),c=!1,-1===(f=l.indexOfCodePoint(u))&&"strict"!==o&&(f=n.indexOfCodePoint(u),c=!0),-1===f?s&&(y[m++]=u):(t?g=oc.mod(i*f+a,p):(d=oc.xgcd(i,p)[0],g=oc.mod(d*(f-a),p)),y[m++]="maintain"===o&&c?n.getCodePointAt(g):l.getCodePointAt(g));return y.slice(0,m)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.getSetting("a").revalidateValue(),"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other");break;case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t);break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}},{key:"validateSlopeValue",value:function(e){var t=this.getSetting("alphabet");if(!t.isValid())return!1;var n=t.getValue().getLength();return!!oc.isCoprime(e,n)||{key:"affineCipherFunctionInvalid",message:"The value must be chosen such that it is coprime to the size "+"of the alphabet (".concat(n,")")}}},{key:"randomizeSlopeValue",value:function(e,t){var n=this.getSetting("alphabet");if(n.isValid()){var r=n.getValue(),i=r.getLength(),a=r.getCodePoints().map((function(e,t){return t+1})).filter((function(e){return e>1&&oc.isCoprime(e,i)}));return a.length>0?e.nextChoice(a):1}return null}},{key:"randomizeInterceptValue",value:function(e,t){if(this.getSetting("alphabet").isValid()){var n=this.getSetting("alphabet").getValue().getLength();return e.nextInteger(1,n-1)}return null}}]),t}(sc),_c={name:"alphabetical-substitution",title:"Atbash/Generic substitution",category:"Ciphers",type:"encoder"},Sc="abcdefghijklmnopqrstuvwxyz",xc="zyxwvutsrqponmlkjihgfedcba",Vc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"plaintextLanguage",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],randomizable:!1},{name:"plaintextAlphabet",type:"text",value:Sc,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"ciphertextAlphabet",type:"text",value:xc,uniqueChars:!0,minLength:0,caseSensitivity:!1,validateValue:e.validateCiphertextValue.bind(ct(e)),randomizeValue:e.randomizeCiphertextValue.bind(ct(e))},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!0,trueLabel:"Include",falseLabel:"Ignore",width:6,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return _c}}]),it(t,[{key:"performTranslate",value:function(e,t){var n,r,i=this.getSettingValue("caseStrategy"),a=this.getSettingValue("includeForeignChars"),o=this.getSettingValue("plaintextAlphabet"),s=this.getSettingValue("ciphertextAlphabet").extend(o);if(!t){var l=[o,s];s=l[0],o=l[1]}"strict"!==i&&(o=o.toLowerCase(),s=s.toLowerCase(),n=o.toUpperCase(),r=s.toUpperCase());for(var u,c,h,d=e.getCodePoints(),f=new Array(d.length).fill(0),g=0,p=0;p<d.length;p++)u=d[p],h=!1,-1===(c=o.indexOfCodePoint(u))&&"strict"!==i&&(c=n.indexOfCodePoint(u),h=!0),-1!==c?f[g++]="maintain"===i&&h?r.getCodePointAt(c):s.getCodePointAt(c):a&&(f[g++]=u);return f.slice(0,g)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"plaintextAlphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("plaintextLanguage").setValue("other"),this.getSetting("ciphertextAlphabet").setValue(t.split("").reverse().join(""));break;case"plaintextLanguage":"english"==t?this.getSetting("plaintextAlphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&this.getSetting("plaintextAlphabet").setValue("abcdefghilmnopqrstuvz");break;case"caseStrategy":this.getSetting("plaintextAlphabet").setCaseSensitivity("strict"===t),this.getSetting("ciphertextAlphabet").setCaseSensitivity("strict"===t)}}},{key:"validateCiphertextValue",value:function(e,t){if(!this.isSettingValid("plaintextAlphabet"))return!1;var n=this.getSettingValue("plaintextAlphabet");return!(e.getLength()>n.getLength())||{key:"alphabetContainsUnusedCharacters",message:"The ciphertext alphabet is longer than the plaintext alphabet"}}},{key:"randomizeCiphertextValue",value:function(e,t){if(!this.getSetting("plaintextAlphabet").isValid())return null;var n=this.getSettingValue("plaintextAlphabet");return el.wrap(ms.shuffle(n.getCodePoints()))}}]),t}(sc),Ic={name:"ascii85",title:"Ascii85",category:"Encoding",type:"encoder"},Cc=[{name:"original",label:"Original",alphabet:null,zeroTupleChar:"z"},{name:"Z85",label:"Z85 (ZeroMQ)",alphabet:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#",zeroTupleChar:null}],Ec=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSetting({name:"variant",type:"enum",label:"Variant",value:"original",elements:Cc.map((function(e){return e.name})),labels:Cc.map((function(e){return e.label})),randomizable:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Ic}}]),it(t,[{key:"performEncode",value:function(e){for(var t,n,r,i=this,a=e.getBytes(),o=Cc.find((function(e){return e.name===i.getSettingValue("variant")})),s=a.length,l="",u=0;u<s;u+=4)if(r=(a[u]<<24)+((a[u+1]||0)<<16)+((a[u+2]||0)<<8)+(a[u+3]||0)>>>0,null===o.zeroTupleChar||r>0){for(t=[],n=0;n<5;n++)t.push(r%85),r=Math.floor(r/85);t=t.reverse(),s<u+4&&t.splice(s-(u+4),4),l+=t.map((function(e){return null===o.alphabet?String.fromCharCode(e+33):o.alphabet[e]})).join("")}else l+=o.zeroTupleChar;return l}},{key:"willDecode",value:function(e){var t=e.getString().match(/<~(.+?)~>/);return null!==t?t[1]:e}},{key:"performDecode",value:function(e){for(var t,n,r,i=this,a=Ws.removeWhitespaces(e.getString()),o=Cc.find((function(e){return e.name===i.getSettingValue("variant")})),s=a.length,l=[],u=0;u<s;)a[u]===o.zeroTupleChar?(l.push(0,0,0,0),u++):(r=[(n=52200625*(t=a.substr(u,5).split("").map((function(e,t){var n=null===o.alphabet?e.charCodeAt(0)-33:o.alphabet.indexOf(e);if(n<0||n>84)throw new Hs("Invalid character '".concat(e,"' at index ").concat(t));return n})))[0]+614125*t[1]+7225*(u+2<s?t[2]:84)+85*(u+3<s?t[3]:84)+(u+4<s?t[4]:84))>>24&255,n>>16&255,n>>8&255,255&n],s<u+5&&r.splice(s-(u+5),5),l.push.apply(l,r),u+=5);return new Uint8Array(l)}}]),t}(sc),Ac={name:"bacon-cipher",title:"Bacon cipher",category:"Ciphers",type:"encoder"},Mc=[{name:"original",label:"Original",alphabet:"abcdefghijklmnopqrstuvwxyz",codeAlphabet:"aaaaaaaaabaaabaaaabbaabaaaababaabbaaabbbabaaaabaaaabaabababaababbabbaaabbababbbaabbbbbaaaabaaabbaababaabbbaabbbabaabababbabbababbb"},{name:"unique",label:"Unique codes for each letter",alphabet:"abcdefghijklmnopqrstuvwxyz",codeAlphabet:"aaaaaaaaabaaabaaaabbaabaaaababaabbaaabbbabaaaabaabababaababbabbaaabbababbbaabbbbbaaaabaaabbaababaabbbabaabababbabbababbbbbaaabbaab"}],Tc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",label:"Variant",value:"original",elements:Mc.map((function(e){return e.name})),labels:Mc.map((function(e){return e.label})),randomizable:!1},{name:"aMark",label:"Letter 1",type:"text",width:6,value:"a",minLength:1,maxLength:1,randomizable:!1,validateValue:e.validateLetterSettingValue.bind(ct(e))},{name:"bMark",label:"Letter 2",type:"text",width:6,value:"b",minLength:1,maxLength:1,randomizable:!1,validateValue:e.validateLetterSettingValue.bind(ct(e))}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Ac}}]),it(t,[{key:"validateLetterSettingValue",value:function(e,t){var n=this.getSetting("aMark"===t.getName()?"bMark":"aMark");return n.isValid()&&!e.isEqualTo(n.getValue())}},{key:"performEncode",value:function(e){for(var t,n=this._getVariant(),r=n.alphabet,i=n.codes,a=n.codeLength,o=this.getSettingValue("aMark").getCharAt(0),s=this.getSettingValue("bMark").getCharAt(0),l=e.toLowerCase(),u="",c=0;c<l.getLength();c++)-1!==(t=r.indexOf(l.getCharAt(c)))&&(u+=i[t]);return"a"===o&&"b"===s||(u=u.split("").map((function(e){return"a"===e?o:s})).join("")),ms.chunk(el.wrap(u).getChars(),a).map((function(e){return e.join("")})).join(" ")}},{key:"performDecode",value:function(e){var t,n=this._getVariant(),r=n.alphabet,i=n.codes,a=n.codeLength,o=this.getSettingValue("aMark").getCodePointAt(0),s=this.getSettingValue("bMark").getCodePointAt(0),l=e.getCodePoints(),u="";for(t=0;t<l.length;t++)switch(l[t]){case o:u+="a";break;case s:u+="b"}var c,h=Ws.chunk(u,a),d="";for(t=0;t<h.length;t++)-1!==(c=i.indexOf(h[t]))&&(d+=r[c]);return d}},{key:"_getVariant",value:function(){var e=this.getSettingValue("variant"),t=Mc.find((function(t){return t.name===e})),n=t.alphabet,r=t.codeAlphabet,i=r.length/n.length;return{alphabet:n,codes:Ws.chunk(r,i),codeLength:i}}}]),t}(sc),Lc={name:"base32",title:"Base32",category:"Encoding",type:"encoder"},Pc=[{name:"base32",label:"Base32 (RFC 3548, RFC 4648)",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",padding:61,decodeMap:{48:14,49:8}},{name:"base32hex",label:"Base32hex (RFC 4648)",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",padding:61},{name:"z-base-32",label:"z-base-32",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",padding:null},{name:"crockford-base32",label:"Crockford's Base32",alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",padding:null,decodeContentFilter:"uppercase",decodeMap:{79:0,73:1,76:1}},{name:"custom",label:"Custom"}],Bc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",value:Pc[0].name,elements:Pc.map((function(e){return e.name})),labels:Pc.map((function(e){return e.label})),randomizable:!1},{name:"alphabet",type:"text",value:Pc[0].alphabet,uniqueChars:!0,minLength:32,maxLength:32,caseSensitivity:!0,visible:!1},{name:"padding",type:"text",value:"=",blacklistChars:Pc[0].alphabet,minLength:0,maxLength:1,randomizable:!1,visible:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Lc}}]),it(t,[{key:"performEncode",value:function(e){for(var t,n,r=this.getVariantOptions(),i=r.alphabet,a=r.padding,o=i.getCodePoints(),s=e.getBytes(),l=s.length,u=8*Math.ceil(l/5),c=new Array(u),h=0,d=3,f=0,g=0;g<l;g++)n=f|(t=s[g])>>d,c[h++]=o[31&n],d>5&&(n=t>>(d-=5),c[h++]=o[31&n]),f=t<<(d=5-d),d=8-d;if(3!==d&&(c[h++]=o[31&f]),null!==a){for(;h<u;)c[h++]=a;return c}return c.slice(0,h)}},{key:"performDecode",value:function(e){var t=this.getVariantOptions(),n=t.alphabet,r=t.decodeMap,i=t.padding;"uppercase"===t.decodeContentFilter&&(e=e.toUpperCase());for(var a=0;a<n.getLength();a++)r[n.getCodePointAt(a)]=a;for(var o,s,l=e.getCodePoints(),u=l.length,c=5*Math.ceil(u/8),h=new Uint8Array(c),d=0,f=8,g=0,p=0;p<u;p++)if((o=l[p])===i);else{if(void 0===r[o])throw new Hs("Unexpected code point at index ".concat(p));s=255&r[o],(f-=5)>0?g|=s<<f:f<0?(h[d++]=g|s>>-f,g=s<<(f+=8)&255):(h[d++]=g|s,f=8,g=0)}return h.slice(0,d)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("alphabet").setVisible("custom"===t),this.getSetting("padding").setVisible("custom"===t);break;case"alphabet":this.getSetting("padding").setBlacklistChars(t)}}},{key:"getVariantOptions",value:function(){var e=this.getSettingValue("variant");if("custom"===e){var t=this.getSettingValue("padding");return{alphabet:this.getSettingValue("alphabet"),padding:1===t.getLength()?t.getCodePointAt(0):null,decodeContentFilter:null,decodeMap:{}}}var n=Pc.find((function(t){return t.name===e}));return n.alphabet=el.wrap(n.alphabet),n.decodeMap=n.decodeMap||{},n}}]),t}(sc),zc={name:"base64",title:"Base64",category:"Encoding",type:"encoder"},Oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Fc=[{name:"base64",label:"Base64 (RFC 3548, RFC 4648)",description:null,alphabet:"".concat(Oc,"+/")},{name:"base64url",label:"Base64url (RFC 4648 §5)",description:"URL and Filename Safe Alphabet",alphabet:"".concat(Oc,"-_"),paddingOptional:!0},{name:"rfc2045",label:"Transfer encoding for MIME (RFC 2045)",description:null,alphabet:"".concat(Oc,"+/"),foreignCharacters:!0,maxLineLength:76},{name:"rfc1421",label:"Original Base64 (RFC 1421)",description:"Privacy-Enhanced Mail (PEM)",alphabet:"".concat(Oc,"+/"),maxLineLength:64},{name:"custom",label:"Custom"}],Nc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",value:Fc[0].name,elements:Fc.map((function(e){return e.name})),labels:Fc.map((function(e){return e.label})),descriptions:Fc.map((function(e){return e.description})),randomizable:!1},{name:"alphabet",type:"text",value:Fc[0].alphabet,uniqueChars:!0,minLength:64,maxLength:64,caseSensitivity:!0,visible:!1},{name:"padding",type:"text",value:"=",blacklistChars:Fc[0].alphabet,minLength:1,maxLength:1,randomizable:!1,visible:!1,width:6},{name:"paddingOptional",type:"boolean",value:!1,randomizable:!1,visible:!1,width:6}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return zc}}]),it(t,[{key:"performEncode",value:function(e){return Xs.base64StringFromBytes(e.getBytes(),this.getVariantOptions())}},{key:"performDecode",value:function(e){return Xs.bytesFromBase64String(e.getString(),this.getVariantOptions())}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("alphabet").setVisible("custom"===t),this.getSetting("padding").setVisible("custom"===t),this.getSetting("paddingOptional").setVisible("custom"===t);break;case"alphabet":this.getSetting("padding").setBlacklistChars(t)}}},{key:"getVariantOptions",value:function(){var e=this.getSettingValue("variant");return"custom"===e?{alphabet:this.getSettingValue("alphabet").getString(),padding:this.getSettingValue("padding").getCharAt(0),paddingOptional:this.getSettingValue("paddingOptional")}:Fc.find((function(t){return t.name===e}))}}]),t}(sc),Rc={name:"baudot-code",title:"Baudot code",category:"Encoding",type:"encoder"},Dc=[{name:"ita1",label:"Original Baudot - ITA 1",characterSet:[0,"A","E","\r","Y","U","I","O","FS","J","G","H","B","C","F","D"," ","\n","X","Z","S","T","W","V",127,"K","M","L","R","Q","N","P",0,"1","2","\r","3","4",null,"5"," ","6","7","+","8","9",null,"0","LS","\n",",",":",".",null,"?","'",127,"(",")","=","-","/",null,"%"]},{name:"original-eu",label:"Original Baudot - Continental European",extends:"ita1",overrides:{3:"É",17:"T",35:"&",38:"º",43:"h",46:"f",49:".",52:";",53:"!",62:"№"}},{name:"original-uk",label:"Original Baudot - Domestic UK",extends:"ita1",overrides:{3:"/",18:"-",35:"⅟",38:"³",43:"¹",46:"⁵",49:".",50:"⁹",52:"⁷",53:"²",62:"£",63:"+"}},{name:"ita2",label:"Baudot-Murray - ITA 2",characterSet:[0,"E","\n","A"," ","S","I","U","\r","D","R","J","N","F","C","K","T","Z","L","W","H","Y","P","Q","O","B","G","FS","M","X","V",15,0,"3","\n","-"," ","'","8","7","\r",5,"4",7,",","!",":","(","5","+",")","2","£","6","0","1","9","?","&",14,".","/","=","LS"]},{name:"us-tty",label:"Baudot-Murray - US-TTY",extends:"ita2",overrides:{37:"'",41:5,43:7,49:"+",52:"£",62:"="}},{name:"murray-code",label:"Baudot-Murray - Murray Code",extends:"ita2",overrides:{0:" ",2:null,4:15,8:"\n",31:"*",32:" ",34:null,35:null,36:"LS",40:"\n",41:"²",43:"⁷",44:"-",45:"⅟",46:"(",47:"⁹",49:".",50:"/",52:"⁵",58:"³",60:",",61:"£",62:")",63:"*"}}],jc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._variantCharacterSet=[],e.addSetting({name:"variant",type:"enum",value:"ita2",elements:Dc.map((function(e){return e.name})),labels:Dc.map((function(e){return e.label})),randomizable:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Rc}}]),it(t,[{key:"performEncode",value:function(e){for(var t,n,r=this.getSettingValue("variant"),i=this.getVariantCharacterSet(r),a=i.indexOf("FS")%32,o=i.indexOf("LS")%32,s=e.getCodePoints(),l=s.length,u=[],c=!1,h=0;h<l;h++)n=s[h],-1===(t=i.indexOf(n))&&n>=97&&n<=122&&(t=i.indexOf(n-32)),t>=0&&t<32?(c&&(u.push(o),c=!1),u.push(t)):t>=32&&(c||(u.push(a),c=!0),u.push(t-32));return ms.resizeBitSizedArray(u,5,8)}},{key:"performDecode",value:function(e){for(var t,n,r=this.getSettingValue("variant"),i=this.getVariantCharacterSet(r),a=i.indexOf("FS")%32,o=i.indexOf("LS")%32,s=ms.resizeBitSizedArray(e.getBytes(),8,5,!0),l=new Array(s.length),u=!1,c=0,h=0;h<s.length;h++)t=s[h],u||t!==a?u&&t===o?u=!1:null!==(n=i[t+(u?32:0)])&&(l[c++]=n):u=!0;return l.slice(0,c)}},{key:"getVariantCharacterSet",value:function(e){if(void 0!==this._variantCharacterSet[e])return this._variantCharacterSet[e];var t=Dc.find((function(t){return t.name===e}));if(void 0===t)return null;var n=(t.characterSet||[]).slice();if(t.extends){var r=this.getVariantCharacterSet(t.extends);null!==r&&(n=r.slice())}if(t.overrides)for(var i in t.overrides)n[i]=t.overrides[i];for(var a=0;a<n.length;a++){var o=n[a];"FS"!==o&&"LS"!==o&&null!==o&&(n[a]="string"==typeof o?Js.codePointsFromString(o)[0]:o)}return this._variantCharacterSet[e]=n,n}}]),t}(sc),qc={name:"bifid-cipher",title:"Bifid cipher",category:"Polybius square ciphers",type:"encoder"},$c="abcdefghiklmnopqrstuvwxyz",Uc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSetting({name:"key",type:"text",value:"",uniqueChars:!0,minLength:0,caseSensitivity:!1}),e._polybiusSquare=new fc,e._polybiusSquare.setSettingValues({alphabet:$c,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return qc}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/j/gi,"i")));case 2:for(t=a.sent,n=t.getLength(),r=new Array(n),i=0;i<n/2;i++)r[i]=t.getCodePointAt(2*i),r[n/2+i]=t.getCodePointAt(2*i+1);return a.abrupt("return",this._polybiusSquare.decode(r));case 7:case"end":return a.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this._polybiusSquare.encode(e));case 2:for(t=a.sent,n=t.getLength(),r=new Array(n),i=0;i<n/2;i++)r[2*i]=t.getCodePointAt(i),r[2*i+1]=t.getCodePointAt(n/2+i);return a.abrupt("return",this._polybiusSquare.decode(r));case 7:case"end":return a.stop()}}),null,this)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"key":this._polybiusSquare.setSettingValue("alphabet",t.extend($c))}}}]),t}(sc),Wc={name:"bitwise-operation",title:"Bitwise operation",category:"Transform",type:"encoder"},Gc={NOT:"NOT",AND:"NAND",OR:"NOR",XOR:"NXOR",NAND:"AND",NOR:"OR",NXOR:"XOR"},Hc=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"operation",type:"enum",value:"NOT",elements:["NOT","AND","OR","XOR","NAND","NOR","NXOR"],labels:["NOT ~a","AND (a & b)","OR (a | b)","XOR (a ^ b)","NAND ~(a & b)","NOR ~(a | b)","NXOR ~(a ^ b)"],randomizable:!1,style:"radio"},{name:"operand",label:"Operand B (Repeating)",type:"bytes",value:new Uint8Array([15]),minSize:1,visible:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Wc}}]),it(t,[{key:"performTranslate",value:function(e,t){var n=this,r=e.getBytes(),i=this.getSettingValue("operand"),a=this.getSettingValue("operation");return t||(a=Gc[a]),r.map((function(e,t){return n.performByteOperation(e,a,i[t%i.length])}))}},{key:"performByteOperation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(t){case"NOT":return~e;case"AND":return e&n;case"OR":return e|n;case"XOR":return e^n;case"NAND":return~(e&n);case"NOR":return~(e|n);case"NXOR":return~(e^n);default:return e}}},{key:"settingValueDidChange",value:function(e,t){"operation"===e.getName()&&this.getSetting("operand").setVisible("NOT"!==t)}}]),t}(sc),Kc=r((function(e,t){var r=n&&n.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){this.name=e,this.version=t,this.os=n};t.BrowserInfo=i;var a=function(e){this.version=e,this.name="node",this.os=process.platform};t.NodeInfo=a;var o=function(){this.bot=!0,this.name="bot",this.version=null,this.os=null};t.BotInfo=o;var s=3,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],u=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function c(e){var t=""!==e&&l.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var a=i.exec(e);return!!a&&[r,a]}),!1);if(!t)return null;var n=t[0],a=t[1];if("searchbot"===n)return new o;var u=a[1]&&a[1].split(/[._]/).slice(0,3);return u?u.length<s&&(u=r(u,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(s-u.length))):u=[],new i(n,u.join("."),h(e))}function h(e){for(var t=0,n=u.length;t<n;t++){var r=u[t],i=r[0];if(r[1].test(e))return i}return null}function d(){return"undefined"!=typeof process&&process.version?new a(process.version.slice(1)):null}t.detect=function(e){return e?c(e):"undefined"!=typeof navigator?c(navigator.userAgent):d()},t.parseUserAgent=c,t.detectOS=h,t.getNodeVersion=d}));(Xu=Kc)&&Xu.__esModule&&Object.prototype.hasOwnProperty.call(Xu,"default")&&Xu.default;Kc.BrowserInfo,Kc.NodeInfo,Kc.BotInfo;var Zc=Kc.detect,Xc=(Kc.parseUserAgent,Kc.detectOS,Kc.getNodeVersion,null),Yc=function(){function e(){nt(this,e)}return it(e,null,[{key:"identify",value:function(){return null===Xc&&(Xc=Zc()||!1),Xc}},{key:"match",value:function(){var t=this,n=e.identify();if(!1===n)return!1;for(var r=/([a-zA-Z0-9-]+)(?:([<>=]+)([0-9.]+))?/,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return void 0!==a.find((function(e){var i=ft(e.match(r),4),a=i[1],o=i[2],s=i[3];return a===n.name&&(void 0===s||t.matchVersion(n.version,o,s))}))}},{key:"matchVersion",value:function(e,t,n){for(var r=e.split("."),i=n.split("."),a=Math.min(r.length,i.length),o="=",s=-1;"="===o&&++s<a;)r[s]=parseInt(r[s],10),i[s]=parseInt(i[s],10),o=r[s]!==i[s]?r[s]<i[s]?"<":">":"=";return"="===o&&(o=r.length!==i.length?r.length<i.length?"<":">":"="),-1!==t.indexOf(o)}},{key:"isNode",value:function(){return this.match("node")}},{key:"isBrowser",value:function(){return"undefined"!=typeof window}},{key:"placeBrowserAttribute",value:function(){if(e.isBrowser()&&!1!==e.identify()){var t=e.identify(),n=t.name,r=t.version;document.documentElement.dataset.browser="".concat(n,"/").concat(r)}return this}}]),e}(),Jc={name:"block-cipher",title:"Block Cipher",category:"Modern cryptography",type:"encoder"},Qc=[{name:"aes-128",label:"AES-128",blockSize:16,keySize:16,browserAlgorithm:"aes",nodeAlgorithm:"aes-128"},{name:"aes-192",label:"AES-192",blockSize:16,keySize:24,browserAlgorithm:!1,nodeAlgorithm:"aes-192"},{name:"aes-256",label:"AES-256",blockSize:16,keySize:32,browserAlgorithm:"aes",nodeAlgorithm:"aes-256"}],eh=[{name:"ecb",label:"ECB (Electronic Code Book)",hasIV:!1,browserMode:!1,nodeMode:!0},{name:"cbc",label:"CBC (Cipher Block Chaining)",hasIV:!0,browserMode:!0,nodeMode:!0},{name:"ctr",label:"CTR (Counter)",hasIV:!0,browserMode:!0,nodeMode:!0}],th=function(e){function n(){var e;nt(this,n),e=ht(this,ot(n).call(this));var t=n.getAlgorithms(),r=t[0],i=n.getModes(),a=n.isPaddingAvailable();return e.addSettings([{name:"algorithm",type:"enum",value:r.name,elements:t.map((function(e){return e.name})),labels:t.map((function(e){return e.label})),randomizable:!1,width:a?8:12},{name:"padding",type:"boolean",value:!1,randomizable:!1,width:a?4:12,visible:a},{name:"mode",type:"enum",value:"cbc",elements:i.map((function(e){return e.name})),labels:i.map((function(e){return e.label})),randomizable:!1},{name:"key",type:"bytes",value:new Uint8Array([43,126,21,22,40,174,210,166,171,247,21,136,9,207,79,60]),minSize:r.keySize,maxSize:r.keySize},{name:"iv",label:"IV",type:"bytes",value:new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),minSize:r.blockSize,maxSize:r.blockSize}]),e}return at(n,e),it(n,null,[{key:"getMeta",value:function(){return Jc}}]),it(n,[{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"algorithm":var r=n.getAlgorithm(t).keySize;this.getSetting("key").setMinSize(r).setMaxSize(r);break;case"mode":var i=this.getSettingValue("algorithm"),a=n.getAlgorithm(i).blockSize,o=n.getMode(t).hasIV;this.getSetting("iv").setVisible(o).setMinSize(a).setMaxSize(a)}}},{key:"performTranslate",value:function(e,t){var n,r,i,a,o,s,l;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=e.getBytes(),r=this.getSettingValues(),i=r.algorithm,a=r.mode,o=r.key,s=r.padding,l=r.iv,u.prev=2,u.next=5,regeneratorRuntime.awrap(this.createCipher(i,a,o,l,s,t,n));case 5:return u.abrupt("return",u.sent);case 8:if(u.prev=8,u.t0=u.catch(2),t){u.next=14;break}throw new Hs("".concat(i," decryption failed, ")+"this may be due to malformed content");case 14:throw new Hs("".concat(i," encryption failed"));case 15:case"end":return u.stop()}}),null,this,[[2,8]])}},{key:"createCipher",value:function(e,r,i,a,o,s,l){var u,c,h,d,f,g,p,v,y,m=this;return regeneratorRuntime.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(u=n.getAlgorithm(e),c=n.getMode(r),c.hasIV||(a=new Uint8Array([])),!Yc.isNode()){b.next=10;break}return h=u.nodeAlgorithm+"-"+r,a=global.Buffer.from(a),l=global.Buffer.from(l),b.abrupt("return",new Promise((function(e,n){var r=s?t.createCipheriv(h,i,a):t.createDecipheriv(h,i,a);r.setAutoPadding(o);var u=Buffer.concat([r.update(l),r.final()]);e(new Uint8Array(u))})));case 10:return d=u.browserAlgorithm+"-"+r,f=window.crypto||window.msCrypto,g=f.subtle||f.webkitSubtle,b.next=15,regeneratorRuntime.awrap(g.importKey("raw",i,{name:d},!1,["encrypt","decrypt"]));case 15:return p=b.sent,v={name:d,iv:a,counter:a,length:u.blockSize},void 0!==(y=s?g.encrypt(v,p,l):g.decrypt(v,p,l)).oncomplete&&(y=new Promise((function(e,t){y.oncomplete=e.bind(m,y.result),y.onerror=t}))),b.abrupt("return",y.then((function(e){return new Uint8Array(e)})));case 20:case"end":return b.stop()}}))}}],[{key:"isPaddingAvailable",value:function(){return Yc.isNode()}},{key:"getAlgorithm",value:function(e){return Qc.find((function(t){return t.name===e}))}},{key:"getAlgorithms",value:function(){var e=Yc.isNode();return Qc.filter((function(t){return t.browserAlgorithm&&!e||t.nodeAlgorithm&&e}))}},{key:"getMode",value:function(e){return eh.find((function(t){return t.name===e}))}},{key:"getModes",value:function(){var e=Yc.isNode();return eh.filter((function(t){return t.browserMode&&!e||t.nodeMode&&e}))}}]),n}(sc);Te({target:"Array",proto:!0,forced:So!==[].lastIndexOf},{lastIndexOf:So});var nh=be.f,rh=T.f,ih=B.f,ah=sn.trim,oh=l.Number,sh=oh.prototype,lh="Number"==v(qn(sh)),uh=function(e){var t,n,r,i,a,o,s,l,u=S(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=ah(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=(a=u.slice(2)).length,s=0;s<o;s++)if((l=a.charCodeAt(s))<48||l>i)return NaN;return parseInt(a,r)}return+u};if(Ae("Number",!oh(" 0o1")||!oh("0b1")||oh("+0x1"))){for(var ch,hh=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof hh&&(lh?u((function(){sh.valueOf.call(n)})):"Number"!=v(n))?Ra(new oh(uh(t)),n,hh):uh(t)},dh=c?nh(oh):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),fh=0;dh.length>fh;fh++)V(oh,ch=dh[fh])&&!V(hh,ch)&&ih(hh,ch,rh(oh,ch));hh.prototype=sh,sh.constructor=hh,te(l,"Number",hh)}Te({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});var gh={name:"bootstring",title:"Bootstring",category:"Encoding",type:"encoder"},ph=2,vh="Integer overflow: Input needs wider integers to process",yh=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"basicRangeStart",label:"Basic Start",type:"number",value:0,integer:!0,rotate:!1,min:0,max:127-ph,width:6,randomizable:!1},{name:"basicRangeEnd",label:"Basic End",type:"number",value:127,integer:!0,rotate:!1,min:ph,max:1114111,width:6,randomizable:!1},{name:"digitMapping",type:"text",value:"abcdefghijklmnopqrstuvwxyz0123456789",uniqueChars:!0,minLength:2,caseSensitivity:!1,validateValue:e.validateDigitMappingValue.bind(ct(e)),randomizable:!1},{name:"delimiter",type:"text",value:"-",width:6,minLength:1,maxLength:1,caseSensitivity:!1,validateValue:e.validateDelimiterValue.bind(ct(e)),randomizable:!1},{name:"caseSensitivity",type:"boolean",value:!1,width:6,randomizable:!1},{name:"initialBias",type:"number",value:72,integer:!0,width:6,validateValue:e.validateInitialBiasValue.bind(ct(e)),randomizable:!1},{name:"initialN",type:"number",value:128,integer:!0,min:0,width:6,randomizable:!1},{name:"tmin",type:"number",value:1,integer:!0,rotate:!1,min:0,max:26,width:6,randomizable:!1},{name:"tmax",type:"number",value:26,integer:!0,rotate:!1,min:0,max:35,width:6,randomizable:!1},{name:"skew",type:"number",value:38,integer:!0,min:1,width:6,randomizable:!1},{name:"damp",type:"number",value:700,integer:!0,min:2,width:6,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return gh}}]),it(t,[{key:"performEncode",value:function(e){var t=this.getSettingValues(),n=t.initialBias,r=t.initialN,i=t.tmin,a=t.tmax,o=t.caseSensitivity,s=this.getSettingValue("delimiter").getCodePointAt(0),l=this.getSettingValue("digitMapping").getLength();o||(e=e.toLowerCase());for(var u=e.getCodePoints(),c=u.length,h=r,d=n,f=0,g=[],p=0;p<u.length;p++)if(this._isBasic(u[p]))g.push(u[p]);else if(u[p]<h)throw new Hs("Unexpected code point at index ".concat(p,", consider changing initial n ")+"to include this code point");var v,y,m,b,k,w=g.length,_=g.length;for(_>0&&g.push(s);w<c;){v=Number.MAX_SAFE_INTEGER;var S=!0,x=!1,V=void 0;try{for(var I,C=u[Symbol.iterator]();!(S=(I=C.next()).done);S=!0)(k=I.value)>=h&&k<v&&!this._isBasic(k)&&(v=k)}catch(e){x=!0,V=e}finally{try{S||null==C.return||C.return()}finally{if(x)throw V}}if(v-h>oc.div(Number.MAX_SAFE_INTEGER-f,w+1))throw new Hs(vh);f+=(v-h)*(w+1),h=v;var E=!0,A=!1,M=void 0;try{for(var T,L=u[Symbol.iterator]();!(E=(T=L.next()).done);E=!0){if(((k=T.value)<h||this._isBasic(k))&&++f>Number.MAX_SAFE_INTEGER)throw new Hs(vh);if(k===h){for(y=f,m=l;!(y<(b=this._calcT(m,d,i,a)));m+=l)g.push(this._basicCodePointFromDigit(b+oc.mod(y-b,l-b))),y=oc.div(y-b,l-b);g.push(this._basicCodePointFromDigit(y)),d=this._adaptBias(f,w+1,w===_),f=0,w++}}}catch(e){A=!0,M=e}finally{try{E||null==L.return||L.return()}finally{if(A)throw M}}f++,h++}return g}},{key:"performDecode",value:function(e){var t=this.getSettingValues(),n=t.initialBias,r=t.initialN,i=t.tmin,a=t.tmax,o=t.caseSensitivity,s=this.getSettingValue("delimiter").getCodePointAt(0),l=this.getSettingValue("digitMapping").getLength();o||(e=e.toLowerCase());for(var u=e.getCodePoints(),c=u.length,h=r,d=n,f=Math.max(u.lastIndexOf(s),0),g=[],p=0;p<f;p++){if(!this._isBasic(u[p]))throw new Hs("Found unexpected non-basic code point at ".concat(p));g.push(u[p])}for(var v,y,m,b,k,w=0,_=f>0?f+1:0;_<c;){for(v=w,y=1,m=l;;m+=l){if(_>=c)throw new Hs("The input ends unexpectedly");if(-1===(b=this._digitFromBasicCodePoint(u[_++])))throw new Hs("Found unexpected non-basic code point at ".concat(_-1));if(b>oc.div(Number.MAX_SAFE_INTEGER-w,y))throw new Hs(vh);if(w+=b*y,b<(k=this._calcT(m,d,i,a)))break;if(y>oc.div(Number.MAX_SAFE_INTEGER,l-k))throw new Hs(vh);y*=l-k}if(d=this._adaptBias(w-v,g.length+1,0===v),oc.div(w,g.length+1)>Number.MAX_SAFE_INTEGER-h)throw new Hs(vh);if(h+=oc.div(w,g.length+1),w=oc.mod(w,g.length+1),this._isBasic(h))throw new Hs("Unexpectedly unwrapped basic code point");g.splice(w,0,h),w++}return g}},{key:"_adaptBias",value:function(e,t,n){var r=this.getSettingValues(),i=r.digitMapping,a=r.tmin,o=r.tmax,s=r.skew,l=i.getLength();if(n){var u=this.getSettingValue("damp");e=oc.div(e,u)}else e=oc.div(e,2);e+=oc.div(e,t);for(var c=0;e>oc.div((l-a)*o,2);)e=oc.div(e,l-a),c+=l;return c+oc.div((l-a+1)*e,e+s)}},{key:"_calcT",value:function(e,t,n,r){return e<=t+n?n:e>=t+r?r:e-t}},{key:"_isBasic",value:function(e){var t=this.getSettingValues(),n=t.basicRangeStart,r=t.basicRangeEnd;return e>=n&&e<=r}},{key:"_digitFromBasicCodePoint",value:function(e){return this.getSettingValue("digitMapping").indexOfCodePoint(e)}},{key:"_basicCodePointFromDigit",value:function(e){return this.getSettingValue("digitMapping").getCodePointAt(e)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"basicRangeStart":this.getSetting("basicRangeEnd").setMin(e.getValue()+ph),this.getSetting("digitMapping").revalidateValue(),this.getSetting("delimiter").revalidateValue();break;case"basicRangeEnd":this.getSetting("basicRangeStart").setMax(e.getValue()-ph),this.getSetting("digitMapping").revalidateValue(),this.getSetting("delimiter").revalidateValue();break;case"digitMapping":var n=e.getValue().getLength();this.getSetting("tmax").setMax(n-1),this.getSetting("delimiter").revalidateValue(),this.getSetting("initialBias").revalidateValue();break;case"tmin":this.getSetting("initialBias").revalidateValue();break;case"tmax":this.getSetting("tmin").setMax(e.getValue());break;case"caseSensitivity":this.getSetting("digitMapping").setCaseSensitivity(t),this.getSetting("delimiter").setCaseSensitivity(t)}}},{key:"validateDigitMappingValue",value:function(e,t){if(!this.isSettingValid("basicRangeStart","basicRangeEnd"))return!1;var n=this.getSettingValue("basicRangeStart"),r=this.getSettingValue("basicRangeEnd"),i=e.getCodePoints().findIndex((function(e){return e<n||e>r}));return-1===i||{key:"bootstringDigitMappingInvalid",message:"Character at index ".concat(i," needs to be part of the given ")+"basic code point range"}}},{key:"validateDelimiterValue",value:function(e,t){if(!this.isSettingValid("basicRangeStart","basicRangeEnd","digitMapping"))return!1;var n=this.getSettingValues(),r=n.basicRangeStart,i=n.basicRangeEnd,a=n.digitMapping,o=e.getCodePointAt(0);return!(o<r||o>i||-1!==a.indexOfCodePoint(o))||{key:"bootstringDelimiterInvalid",message:"The value must be part of the basic code point range while not having a digit mapped to it"}}},{key:"validateInitialBiasValue",value:function(e,t){if(!this.isSettingValid("digitMapping","tmin"))return!1;var n=this.getSettingValue("digitMapping").getLength(),r=this.getSettingValue("tmin");return!(oc.mod(e,n)>n-r)||{key:"bootstringInitialBiasInvalid",message:"The value must be chosen such that initial_bias mod base <= base - tmin"}}}]),t}(sc),mh=function(e){function t(){return nt(this,t),ht(this,ot(t).apply(this,arguments))}return at(t,e),it(t,[{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("viewer"),e}},{key:"renderHeader",value:function(){var e=Ht.createElement("ul",{className:"brick__actions"},[Ht.createElement("li",{className:"brick__action-item"},[Ht.createElement("span",{className:"brick__action brick__action--active"},"View")])]),n=dt(ot(t.prototype),"renderHeader",this).call(this);return n.insertBefore(e,n.firstChild),n}}]),t}(Tu),bh=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._text="",e._disabled=!1,e._$textarea=null,e}return at(t,e),it(t,[{key:"getText",value:function(){return this._text}},{key:"setText",value:function(e){return this._text!==e&&(this._text=e,null!==this._$textarea&&(this._$textarea.value=e,this.layoutTextarea())),this}},{key:"isDisabled",value:function(){return this._disabled}},{key:"setDisabled",value:function(e){return this._disabled=e,null!==this._$textarea&&(e?this._$textarea.disabled="disabled":this._$textarea.removeAttribute("disabled")),this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("viewer-text"),e}},{key:"renderContent",value:function(){var e=this;this._$textarea=Ht.createElement("textarea",{className:"viewer-text__textarea",ariaLabel:"Content",spellcheck:!1,value:this._text,onInput:this.textareaValueDidChange.bind(this),onFocus:function(t){return e.focus()},onBlur:function(t){return e.blur()}}),this.isDisabled()&&(this._$textarea.disabled="disabled");var n=dt(ot(t.prototype),"renderContent",this).call(this);return n.appendChild(this._$textarea),n}},{key:"textareaValueDidChange",value:function(e){if(this.isDisabled())return e.preventDefault(),!1;var t=this._$textarea.value;this._text!==t&&(this._text=t,this.getModel().viewTextDidChange(this,this._text),this.layoutTextarea())}},{key:"layout",value:function(){return this.layoutTextarea(),dt(ot(t.prototype),"layout",this).call(this)}},{key:"layoutTextarea",value:function(){return this._$textarea.style.height="",this._$textarea.style.height="".concat(this._$textarea.scrollHeight,"px"),this}},{key:"update",value:function(){var e=this.getModel().getError();return null!==e?this.updateStatus("error","Binary content can't be interpreted as text. Try switching to the bytes view. "+e.message):this.updateStatus(null)}}]),t}(mh),kh=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._queuedContent=null,e._error=null,e}return at(t,e),it(t,[{key:"view",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!((t=this.getSettingsForm().getInvalidFields()).length>0)){n.next=4;break}throw new Hs("Can't view content with invalid settings: "+t.map((function(e){return e.getLabel()})).join(", "));case 4:if(this.hasView()){n.next=7;break}return this._queuedContent=e,n.abrupt("return");case 7:return n.next=9,regeneratorRuntime.awrap(this.willView(e));case 9:return e=n.sent,n.next=12,regeneratorRuntime.awrap(this.performView(e));case 12:return n.next=14,regeneratorRuntime.awrap(this.didView(e));case 14:null!==this._error&&(this._error=null,this.updateView()),n.next=22;break;case 17:throw n.prev=17,n.t0=n.catch(0),this._error=n.t0,this.updateView(),n.t0;case 22:case"end":return n.stop()}}),null,this,[[0,17]])}},{key:"willView",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}))}},{key:"performView",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"didView",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"dare",value:function(e){var t,n=arguments;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=n.length>1&&void 0!==n[1]&&n[1],r.prev=1,r.next=4,regeneratorRuntime.awrap(e());case 4:null!==this._error&&(this._error=null,this.updateView()),r.next=13;break;case 7:if(r.prev=7,r.t0=r.catch(1),this._error=r.t0,this.updateView(),!t&&r.t0 instanceof Hs){r.next=13;break}throw r.t0;case 13:return r.abrupt("return",this);case 14:case"end":return r.stop()}}),null,this,[[1,7]])}},{key:"getError",value:function(){return this._error}},{key:"didCreateView",value:function(e){dt(ot(t.prototype),"didCreateView",this).call(this,e),null!==this._queuedContent&&(this.view(this._queuedContent),this._queuedContent=null)}},{key:"contentDidChange",value:function(e){this.hasPipe()&&this.getPipe().viewerContentDidChange(this,e)}}]),t}(ic),wh={name:"bytes",title:"Bytes",category:"View",type:"viewer"},_h=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=bh,e.addSettings([{name:"format",type:"enum",width:6,value:"hexadecimal",elements:["hexadecimal","binary"],labels:["Hexadecimal","Binary"],randomizable:!1},{name:"groupBits",label:"Group by",type:"enum",width:6,value:8,elements:[null,4,5,6,8,16,24,32],labels:["None","4 Bits","5 Bits","6 Bits","Byte","2 Bytes","3 Bytes","4 Bytes"],randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return wh}}]),it(t,[{key:"performView",value:function(e){var t,n,r,i,a,o;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:t=e.getBytes(),n=this.getSettingValue("format"),s.t0=n,s.next="hexadecimal"===s.t0?5:"binary"===s.t0?8:10;break;case 5:return r=Xs.hexStringFromBytes(t),i=4,s.abrupt("break",10);case 8:r=Xs.binaryStringFromBytes(t),i=1;case 10:null!==(a=this.getSettingValue("groupBits"))&&(o=a/i,r=Ws.chunk(r,o).join(" ")),this.getView().setText(r);case 13:case"end":return s.stop()}}),null,this)}},{key:"viewTextDidChange",value:function(e,t){var n=this;this.dare((function(){var e,r=n.getSettingValue("format"),i=t;switch(i=i.replace(/\s/g,""),r){case"hexadecimal":e=Xs.bytesFromHexString(i);break;case"binary":e=Xs.bytesFromBinaryString(i)}n.contentDidChange(el.wrap(e))}))}},{key:"settingValueDidChange",value:function(e,t){if("groupBits"===e.getName()){var n=this.getSetting("format"),r=["binary"],i=["Binary"];null!==t&&t%4!=0||(r.push("hexadecimal"),i.push("Hexadecimal")),-1===r.indexOf(n.getValue())&&n.setValue(r[0]),n.setElements(r,i)}}}]),t}(kh),Sh=1..toFixed,xh=Math.floor,Vh=function(e,t,n){return 0===t?n:t%2==1?Vh(e,t-1,n*e):Vh(e*e,t/2,n)},Ih=Sh&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!u((function(){Sh.call({})}));function Ch(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}function Eh(e,t,n){for(var r=0;r<n.length;r++)e[r]=Ch(e[r]);var i=function(e,t,n){for(var r=[],i=0;i<n.length;i++)r.push([i,Th(e[i],t)]);return r}(e,t,n);i.sort((function(e,t){return e[1]!=t[1]?e[1]-t[1]:e[0]-t[0]})),div=document.getElementById("crack-results"),div.innerHTML='\n\t<table>\n\t<thead>\n\t\t<tr>\n\t\t\t<th>Shift</th>\n\t\t\t<th colspan="2">Entropy per letter (bits) <span style="font-weight:normal">(lower is better)</span></th>\n\t\t\t<th colspan="2">Beginning of deciphered text </th>\n\t\t</tr>\n\t</thead>\n\t<tbody id="guesses"></tbody>\n\t</table>\n\t<table><tbody style="text-align: center"><tr><td>To change the shift, say \'No\' to Need Crack</td></tr></tbody></table>\n\t';var a=document.getElementById("guesses");return i.forEach((function(t,n){maxEntropy=i[i.length-1][1],minEntropy=i[0][1];var r=a.appendChild(document.createElement("tr"));0==n&&r.classList.add("active");var o=r.appendChild(document.createElement("td"));o.textContent=t[0].toString(),(o=r.appendChild(document.createElement("td"))).textContent=t[1].toFixed(3);var s=(o=r.appendChild(document.createElement("td"))).appendChild(document.createElement("div"));s.classList.add("bar"),s.style.width=(t[1]/maxEntropy*10+1).toFixed(6)+"em",(o=r.appendChild(document.createElement("td"))).textContent=e[t[0]]})),i[0][0]}Te({target:"Number",proto:!0,forced:Ih},{toFixed:function(e){var t,n,r,i,a=function(e){if("number"!=typeof e&&"Number"!=v(e))throw TypeError("Incorrect invocation");return+e}(this),o=se(e),s=[0,0,0,0,0,0],l="",u="0",c=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*s[n],s[n]=r%1e7,r=xh(r/1e7)},h=function(e){for(var t=6,n=0;--t>=0;)n+=s[t],s[t]=xh(n/e),n=n%e*1e7},d=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);t=""===t?n:t+ws.call("0",7-n.length)+n}return t};if(o<0||o>20)throw RangeError("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(l="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*Vh(2,69,1))-69)<0?a*Vh(2,-t,1):a/Vh(2,t,1),n*=4503599627370496,(t=52-t)>0){for(c(0,n),r=o;r>=7;)c(1e7,0),r-=7;for(c(Vh(10,r,1),0),r=t-1;r>=23;)h(1<<23),r-=23;h(1<<r),c(1,1),h(2),u=d()}else c(0,n),c(1<<-t,0),u=d()+ws.call("0",o);return u=o>0?l+((i=u.length)<=o?"0."+ws.call("0",o-i)+u:u.slice(0,i-o)+"."+u.slice(i-o)):l+u}});var Ah={a:.08167,b:.01492,c:.02782,d:.04253,e:.12702,f:.02228,g:.02015,h:.06094,i:.06966,j:.00153,k:.00772,l:.04025,m:.02406,n:.06749,o:.07507,p:.01929,q:95e-5,r:.05987,s:.06327,t:.09056,u:.02758,v:.00978,w:.0236,x:.0015,y:.01974,z:74e-5},Mh={a:.1174,b:.0092,c:.045,d:.0373,e:.1179,f:.0095,g:.0164,h:.0154,i:.1128,l:.0651,m:.0251,n:.0688,o:.0983,p:.0305,q:.0051,r:.0637,s:.0498,t:.0562,u:.0301,v:.021,z:.0049};function Th(e,t,n){var r=0,i=0;if("english"==t)var a=Ah;else if("italian"==t)a=Mh;for(var o=0;o<e.length;o++){var s=a[e[o].toLowerCase()];void 0!==s?r+=Math.log(s):i++}return-r/Math.log(2)/(e.length-i)}var Lh={name:"crackSetting",label:"Crack",type:"enum",value:"no",elements:["no","english","italian"],labels:["No","from english","from italian"],width:8,randomizable:!1},Ph={name:"caesar-cipher",title:"Caesar cipher",category:"Ciphers",type:"encoder"},Bh="abcdefghijklmnopqrstuvwxyz",zh=7,Oh=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"shift",type:"number",label:"Shift",priority:10,value:zh,integer:!0,describeValue:e.describeShiftValue.bind(ct(e)),randomizeValue:e.randomizeShiftValue.bind(ct(e))},{name:"language",label:"Ciphertext Alphabet",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],blackChoiceList:[],width:8,randomizable:!1},{name:"alphabet",type:"text",value:Bh,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!0,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}].concat(Lh)),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Ph}}]),it(t,[{key:"_performTranslate",value:function(e,t,n){var r,i,a=this.getSettingValues(),o=a.caseStrategy,s=a.includeForeignChars,l=this.getSettingValue("alphabet");"strict"!==o&&(r=(l=l.toLowerCase()).toUpperCase()),i=null==n?this.getSettingValue("shift"):n;for(var u,c,h,d,f=l.getLength(),g=e.getLength(),p=new Array(g),v=0,y=0;y<g;y++)u=e.getCodePointAt(y),d=!1,-1===(c=l.indexOfCodePoint(u))&&"strict"!==o&&(c=r.indexOfCodePoint(u),d=!0),-1===c?s&&(p[v++]=u):(h=oc.mod(c+i*(t?1:-1),f),p[v++]="maintain"===o&&d?r.getCodePointAt(h):l.getCodePointAt(h));return p.slice(0,v)}},{key:"performTranslate",value:function(e,t){var n=this.getSetting(Lh.name);if(!t&null==n?this.addSetting(Lh):t&null!==n&&this.removeSetting(n),t){if("undefined"!=typeof document){document.getElementById("crack-results").innerHTML="";var r=document.getElementById("bouncing-arrow");null!==r&&(r.style.visibility="hidden")}}else{var i=this.getSettingValue(Lh.name);if("no"!=i){for(var a=i,o={},s=this.getSettingValue("alphabet")._string,l=0;l<s.length;l++)o[l]=this._performTranslate(e,t,l).slice(0,40);bestShift=Eh(o,a,s),this.setSettingValue("shift",bestShift)}}return this._performTranslate(e,t)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t);break;case"alphabet":this.getSetting("shift").setNeedsValueDescriptionUpdate(),t!=Bh&&"abcdefghilmnopqrstuvz"!=t&&this.setSettingValue("language","other");break;case"language":"english"==t?this.setSettingValue("alphabet",Bh):"italian"==t&&this.setSettingValue("alphabet","abcdefghilmnopqrstuvz"),this.getSetting("shift").setNeedsValueDescriptionUpdate();break;case Lh.name:if("no"!=t){var n=document.getElementById("bouncing-arrow");if(null==n){var r=document.getElementsByClassName("pipe__scrollable")[0];(n=document.createElement("div")).classList.add("arrow","bounce"),n.id="bouncing-arrow",n.style.visibility="visible",r.appendChild(n)}else n.style.visibility="visible"}else{document.getElementById("crack-results").innerHTML="";var i=document.getElementById("bouncing-arrow");null!==i&&(i.style.visibility="hidden")}}}},{key:"randomizeShiftValue",value:function(e,t){var n=this.getSetting("alphabet");return n.isValid()?e.nextInteger(1,n.getValue().getLength()-1):null}},{key:"describeShiftValue",value:function(e,t){if(!this.getSetting("alphabet").isValid())return null;var n=this.getSettingValues(),r=n.alphabet,i=n.shift,a=r.getCharAt(0),o=oc.mod(i,r.getLength()),s=r.getCharAt(o);return"".concat(a,"→").concat(s)}}]),t}(sc),Fh={name:"case-transform",title:"Case transform",category:"Transform",type:"encoder"},Nh=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSetting({name:"case",type:"enum",value:"lower",elements:["lower","upper","capitalize","alternating","inverse"],labels:["Lower case","Upper case","Capitalize","Alternating case","Inverse case"],randomizable:!1,style:"radio"}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Fh}}]),it(t,[{key:"performEncode",value:function(e){switch(this.getSettingValue("case")){case"lower":return e.toLowerCase();case"upper":return e.toUpperCase();case"capitalize":return el.wrap(e.getString().replace(/[0-9A-Z_a-z](?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})));case"alternating":return el.wrap(e.getChars().map((function(e,t){return t%2==0?e.toLowerCase():e.toUpperCase()})).join(""));case"inverse":return this._inverseCase(e);default:return e}}},{key:"performDecode",value:function(e){switch(this.getSettingValue("case")){case"inverse":return this._inverseCase(e);default:return e}}},{key:"_inverseCase",value:function(e){return el.wrap(e.getChars().map((function(e){var t=e.toLowerCase();return e!==t?t:e.toUpperCase()})).join(""))}}]),t}(sc),Rh=Ao.left;Te({target:"Array",proto:!0,forced:We("reduce")},{reduce:function(e){return Rh(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Dh=sn.trim;Te({target:"String",proto:!0,forced:function(e){return u((function(){return!!tn[e]()||"​᠎"!="​᠎"[e]()||tn[e].name!==e}))}("trim")},{trim:function(){return Dh(this)}});var jh={name:"enigma",title:"Enigma machine",category:"Ciphers",type:"encoder"},qh="abcdefghijklmnopqrstuvwxyz",$h=[{name:"I",label:"Enigma I",description:"German Army & Air Force",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-A","UKW-B","UKW-C"],reflectorThumbwheel:!1,slots:[{rotors:["I","II","III","IV","V"]},{rotors:["I","II","III","IV","V"]},{rotors:["I","II","III","IV","V"]}]},{name:"N",label:'Enigma I "Norenigma"',description:"Norwegian Police Security Service",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-N"],reflectorThumbwheel:!1,slots:[{rotors:["I-N","II-N","III-N","IV-N","V-N"]},{rotors:["I-N","II-N","III-N","IV-N","V-N"]},{rotors:["I-N","II-N","III-N","IV-N","V-N"]}]},{name:"S",label:'Enigma I "Sondermaschine"',description:"German Intelligence",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-S"],reflectorThumbwheel:!1,slots:[{rotors:["I-S","II-S","III-S"]},{rotors:["I-S","II-S","III-S"]},{rotors:["I-S","II-S","III-S"]}]},{name:"M3",label:"Enigma M3",description:"German Army & Navy",characterGroupSize:5,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-B","UKW-C"],reflectorThumbwheel:!1,slots:[{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]}]},{name:"M4",label:'Enigma M4 "Shark"',description:"German Submarines",characterGroupSize:4,plugboard:!0,entryRotor:"ETW-ABCDEF",reflectorRotors:["UKW-B-thin","UKW-C-thin"],reflectorThumbwheel:!1,slots:[{rotors:["beta","gamma"],rotating:!1},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]},{rotors:["I","II","III","IV","V","VI","VII","VIII"]}]},{name:"D",label:"Enigma D / K",description:"Commercial Enigma",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,slots:[{rotors:["I-D","II-D","III-D"]},{rotors:["I-D","II-D","III-D"]},{rotors:["I-D","II-D","III-D"]}]},{name:"T",label:'Enigma T "Tirpitz"',description:"Japanese Army",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-T",reflectorRotors:["UKW-T"],reflectorThumbwheel:!0,slots:[{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]},{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]},{rotors:["I-T","II-T","III-T","IV-T","V-T","VI-T","VII-T","VIII-T"]}]},{name:"KS",label:"Swiss-K",description:"Swiss Army & Air Force",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,slots:[{rotors:["I-KS","II-KS","III-KS"]},{rotors:["I-KS","II-KS","III-KS"]},{rotors:["I-KS","II-KS","III-KS"]}]},{name:"KR",label:'Railway Enigma "Rocket I"',description:"German Railway",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-KR"],reflectorThumbwheel:!0,slots:[{rotors:["I-KR","II-KR","III-KR"]},{rotors:["I-KR","II-KR","III-KR"]},{rotors:["I-KR","II-KR","III-KR"]}]},{name:"Z",label:"Zählwerk Enigma A-865",description:null,characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-Z","II-Z","III-Z"]},{rotors:["I-Z","II-Z","III-Z"]},{rotors:["I-Z","II-Z","III-Z"]}]},{name:"G111",label:"Abwehr Enigma G-111",description:null,characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G111","II-G111","V-G111"]},{rotors:["I-G111","II-G111","V-G111"]},{rotors:["I-G111","II-G111","V-G111"]}]},{name:"G312",label:"Abwehr Enigma G-312",description:"German Seret Service",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-G312"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G312","II-G312","III-G312"]},{rotors:["I-G312","II-G312","III-G312"]},{rotors:["I-G312","II-G312","III-G312"]}]},{name:"G260",label:"Abwehr Enigma G-260",description:"German Seret Service in Argentina",characterGroupSize:5,plugboard:!1,entryRotor:"ETW-QWERTZ",reflectorRotors:["UKW-COM"],reflectorThumbwheel:!0,reflectorRotating:!0,turnoverMechanism:"cog",slots:[{rotors:["I-G260","II-G260","III-G260"]},{rotors:["I-G260","II-G260","III-G260"]},{rotors:["I-G260","II-G260","III-G260"]}]}],Uh=["name","label","wiring","turnovers"],Wh=["ETW-ABCDEF","Alphabet","abcdefghijklmnopqrstuvwxyz","","ETW-QWERTZ","Keyboard","jwulcmnohpqzyxiradkegvbtsf","","I","I","ekmflgdqvzntowyhxuspaibrcj","q","II","II","ajdksiruxblhwtmcqgznpyfvoe","e","III","III","bdfhjlcprtxvznyeiwgakmusqo","v","IV","IV","esovpzjayquirhxlnftgkdcmwb","j","V","V","vzbrgityupsdnhlxawmjqofeck","z","VI","VI","jpgvoumfyqbenhzrdkasxlictw","zm","VII","VII","nzjhgrcxmyswboufaivlpekqdt","zm","VIII","VIII","fkqhtlxocbjspdzramewniuygv","zm","beta","Beta","leyjvcnixwpbqmdrtakzgfuhos","","gamma","Gamma","fsokanuerhmbtiycwlqpzxvgjd","","UKW-A","UKW A","ejmzalyxvbwfcrquontspikhgd","","UKW-B","UKW B","yruhqsldpxngokmiebfzcwvjat","","UKW-C","UKW C","fvpjiaoyedrzxwgctkuqsbnmhl","","UKW-B-thin","UKW B thin","enkqauywjicopblmdxzvfthrgs","","UKW-C-thin","UKW C thin","rdobjntkvehmlfcwzaxgyipsuq","","I-N","I","wtokasuyvrbxjhqcpzefmdinlg","q","II-N","II","gjlpubswemctqvhxaofzdrkyni","e","III-N","III","jwfmhnbpusdytixvzgrqlaoekc","v","IV-N","IV","esovpzjayquirhxlnftgkdcmwb","j","V-N","V","hejxqotzbvfdascilwpgynmurk","z","UKW-N","UKW","mowjypuxndsraibfvlkzgqchet","","I-S","I","veosirzujdqckgwypnxaflthmb","q","II-S","II","uemoatqlshpkcyfwjzbgvxindr","e","III-S","III","tzhxmbsipnurjfdkeqvcwglaoy","v","UKW-S","UKW","ciagsndrbytpzfulvhekoqxwjm","","I-D","I","lpgszmhaeoqkvxrfybutnicjdw","y","II-D","II","slvgbtfxjqohewirzyamkpcndu","e","III-D","III","cjgdpshkturawzxfmynqobvlie","n","UKW-COM","UKW","imetcgfraysqbzxwlhkdvupojn","","ETW-T","ETW","ilxrztkgjyamwvdufcpqeonshb","","I-T","I","kptyuelocvgrfqdanjmbswhzxi","wzekq","II-T","II","uphzlweqmtdjxcaksoigvbyfnr","wzflr","III-T","III","qudlyrfekonvzaxwhmgpjbsict","wzekq","IV-T","IV","ciwtbkxnrespflydagvhquojzm","wzflr","V-T","V","uaxgisnjbverdylfzwtpckohmq","ycfkr","VI-T","VI","xfuzgalvhcnysewqtdmrbkpioj","xeimq","VII-T","VII","bjvftxplnayozikwgdqeruchsm","ycfkr","VIII-T","VIII","ymtpnzhwkodajxeluqvgcbisfr","xeimq","UKW-T","UKW","gekpbtaumocniljdxzyfhwvqsr","","I-KS","I","pezuohxscvfmtbglrinqjwaydk","y","II-KS","II","zouesydkfwpciqxhmvblgnjrat","e","III-KS","III","ehrvxgaobqusimzflynwktpdjc","n","I-KR","I","jgdqoxuscamifrvtpnewkblzyh","n","II-KR","II","ntzpsfbokmwrcjdivlaeyuxhgq","e","III-KR","III","jviubhtcdyakeqzposgxnrmwfl","y","UKW-KR","UKW","qyhognecvpuztfdjaxwmkisrbl","","I-Z","I","lpgszmhaeoqkvxrfybutnicjdw","suvwzabcefgiklopq","II-Z","II","slvgbtfxjqohewirzyamkpcndu","stvyzacdfghkmnq","III-Z","III","cjgdpshkturawzxfmynqobvlie","uwxaefhkmnr","I-G111","I","wlrhbqundkjczsexotmagyfpvi","suvwzabcefgiklopq","II-G111","II","tfjqazwmhlcuixrdygoevbnskp","stvyzacdfghkmnq","V-G111","V","qtpixwvdfrmusljohcanezkybg","swzfhmq","I-G312","I","dmtwsilruyqnkfejcazbpgxohv","suvwzabcefgiklopq","II-G312","II","hqzgpjtmoblncifdyawveusrkx","stvyzacdfghkmnq","III-G312","III","uqntlszfmrehdpxkibvygjcwoa","uwxaefhkmnr","UKW-G312","UKW","rulqmzjsygocetkwdahnbxpvif","","I-G260","I","rcspblkqaumhwytifzvgojnexd","suvwzabcefgiklopq","II-G260","II","wcmibvpjxarosgndlzkeyhufqt","stvyzacdfghkmnq","III-G260","III","fvdhzelsqmaxokyiwpgcbujtnr","uwxaefhkmnr"],Gh=null,Hh=null,Kh=function(e){function t(){var e;nt(this,t),e=ht(this,ot(t).call(this));var n=t.getModel("M3"),r=t.getRotors(n.slots[0].rotors),i=r.map((function(e){return e.name})),a=r.map((function(e){return e.label})),o=t.getRotors(n.reflectorRotors);e.addSetting({name:"model",type:"enum",value:n.name,elements:$h.map((function(e){return e.name})),labels:$h.map((function(e){return e.label})),descriptions:$h.map((function(e){return e.description})),randomizable:!1}),e.addSetting({name:"reflector",type:"enum",value:o[0].name,elements:o.map((function(e){return e.name})),labels:o.map((function(e){return e.label})),width:4}),e.addSetting({name:"positionReflector",label:"Position",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(ct(e)),width:4}),e.addSetting({name:"ringReflector",label:"Ring",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(ct(e)),width:4});for(var s=0;s<t.getMaxSlotCount();s++)e.addSetting({name:"rotor".concat(s+1),label:"Rotor ".concat(s+1),type:"enum",value:i[0],elements:i,labels:a,randomizable:!1,width:4}),e.addSetting({name:"position".concat(s+1),label:"Position",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(ct(e)),width:4}),e.addSetting({name:"ring".concat(s+1),label:"Ring",type:"number",value:1,integer:!0,min:1,max:27,describeValue:e.describePositionValue.bind(ct(e)),width:4});return e.addSetting({name:"plugboard",type:"text",value:"",caseSensitivity:!1,validateValue:e.validatePlugboardValue.bind(ct(e)),filterValue:function(e){return e.getString().trim().toLowerCase()},randomizeValue:e.randomizePlugboardValue.bind(ct(e))}),e.addSetting({name:"includeForeignChars",type:"boolean",label:"Foreign Chars",value:!1,trueLabel:"Include",falseLabel:"Ignore",randomizable:!1}),e.applyModel(n.name),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return jh}}]),it(t,[{key:"settingValueDidChange",value:function(e,n){dt(ot(t.prototype),"settingValueDidChange",this).call(this,e,n),"model"===e.getName()&&this.applyModel(n)}},{key:"applyModel",value:function(e){for(var n=t.getModel(e),r=t.getMaxSlotCount(),i=0;i<r;i++){var a=i<n.slots.length?n.slots[i]:null,o=null!==a,s=this.getSetting("rotor".concat(i+1)),l=this.getSetting("ring".concat(i+1)),u=this.getSetting("position".concat(i+1));if(s.setVisible(o),l.setVisible(o),u.setVisible(o),o){var c=t.getRotors(a.rotors);s.setElements(c.map((function(e){return e.name})),c.map((function(e){return e.label})),null,!1),!0!==s.validateValue(s.getValue())&&s.setValue(c[0].name)}}var h=t.getRotors(n.reflectorRotors),d=this.getSetting("reflector");d.setElements(h.map((function(e){return e.name})),h.map((function(e){return e.label})),null,!1),!0!==d.validateValue(d.getValue())&&d.setValue(h[0].name),d.setWidth(n.reflectorThumbwheel?4:12),d.setVisible(n.reflectorThumbwheel||h.length>1),this.getSetting("positionReflector").setVisible(n.reflectorThumbwheel),this.getSetting("ringReflector").setVisible(n.reflectorThumbwheel),this.getSetting("plugboard").setVisible(n.plugboard)}},{key:"performTranslate",value:function(e,n){var r=this.getSettingValue("includeForeignChars"),i=t.getModel(this.getSettingValue("model")),a=0,o=i.slots,s=[],l=[],u=[];for(a=0;a<o.length;a++){var c=this.getSettingValue("rotor".concat(a+1));s.push(t.getRotor(c)),l.push(this.getSettingValue("position".concat(a+1))-1),u.push(this.getSettingValue("ring".concat(a+1))-1)}var h=t.getRotor(i.entryRotor),d=t.getRotor(this.getSettingValue("reflector")),f=i.reflectorThumbwheel?this.getSettingValue("positionReflector"):0,g=i.reflectorThumbwheel?this.getSettingValue("ringReflector"):0,p=null;if(i.plugboard){var v=this.getSettingValue("plugboard");p=this.wiringFromPlugboardValue(v.toString())}var y=t.rotorMapChar,m=e.getCodePoints().map((function(e,n){var c=null;if(e>=65&&e<=90)c=e-65;else{if(!(e>=97&&e<=122))return!!r&&e;c=e-97}if("cog"===i.turnoverMechanism){var v=!0;for(a=o.length-1;v&&a>=0;)!1!==o[a].rotating?(v=t.rotorAtTurnover(s[a],l[a]),l[a]++):v=!1,a--;v&&!0===i.reflectorRotating&&f++}else{var m=!1;for(a=1;!m&&a<o.length;)(m=t.rotorAtTurnover(s[a],l[a]))&&(a!==o.length-1&&l[a]++,!1!==o[a-1].rotating&&l[a-1]++),a++;l[l.length-1]++}for(null!==p&&(c=y(c,p,0,0,!1)),c=y(c,h,0,0,!1),a=s.length-1;a>=0;a--)c=y(c,s[a],l[a],u[a],!1);for(c=y(c,d,f,g,!1),a=0;a<s.length;a++)c=y(c,s[a],l[a],u[a],!0);return c=y(c,h,0,0,!0),null!==p&&(c=y(c,p,0,0,!0)),c+97}));if(!r){var b=[];m.forEach((function(e){!1!==e&&((b.length+1)%(i.characterGroupSize+1)==0&&b.push(32),b.push(e))})),m=b}return m}},{key:"describePositionValue",value:function(e,t){return qh[e-1].toUpperCase()}},{key:"validatePlugboardValue",value:function(e,t){var n=e.getString();return""===n||(null===n.match(/^([a-z]{2}\s)*([a-z]{2})$/)?{key:"enigmaPlugboardInvalidFormat",message:"Invalid plugboard format: pairs of letters to be swapped expected (e.g. 'ab cd ef')"}:!!ms.isUnique(n.replace(/\s/g,"").split(""))||{key:"enigmaPlugboardPairsNotUnique",message:"Pairs of letters to be swapped need to be unique"})}},{key:"wiringFromPlugboardValue",value:function(e){var t=qh.split("");return e.split(" ").forEach((function(e){t[e.charCodeAt(0)-97]=e[1],t[e.charCodeAt(1)-97]=e[0]})),t.join("")}},{key:"isRandomizable",value:function(){return!0}},{key:"randomize",value:function(){var e,n,r,i=t.getModel(this.getSettingValue("model")),a=i.reflectorRotors;for(e=0;e<i.slots.length;e++)a=a.concat(i.slots[e].rotors);for(a=ms.unique(a),-1!==(n=(a=ms.shuffle(a)).findIndex((function(e){return-1!==i.reflectorRotors.indexOf(e)})))&&(r=a.splice(n,1)[0],this.setSettingValue("reflector",r)),e=0;e<i.slots.length;e++)-1!==(n=a.findIndex((function(t){return-1!==i.slots[e].rotors.indexOf(t)})))&&(r=a.splice(n,1)[0],this.setSettingValue("rotor".concat(e+1),r));return dt(ot(t.prototype),"randomize",this).call(this),this}},{key:"randomizePlugboardValue",value:function(e,t){var n=ms.shuffle(qh.split(""),e).join("").substr(0,20);return Ws.chunk(n,2).join(" ")}}],[{key:"rotorAtTurnover",value:function(e,t){if(void 0===e.turnovers)return!1;var n=String.fromCharCode(97+oc.mod(t,26));return-1!==e.turnovers.indexOf(n)}},{key:"rotorMapChar",value:function(e,t,n,r,i){var a="string"==typeof t?t:t.wiring;return n=oc.mod(n-r,26),e=oc.mod(e+n,26),e=i?a.indexOf(String.fromCharCode(97+e)):a.charCodeAt(e)-97,e=oc.mod(e-n,26)}},{key:"getModel",value:function(e){return null===Gh&&(Gh={},$h.forEach((function(e){Gh[e.name]=e}))),Gh[e]||null}},{key:"getMaxSlotCount",value:function(){return $h.reduce((function(e,t){return Math.max(e,t.slots.length)}),0)}},{key:"getRotor",value:function(e){var t,n,r;if(null===Hh)for(Hh={},t=0;t<Wh.length;t+=Uh.length){for(r={},n=0;n<Uh.length;n++)r[Uh[n]]=Wh[t+n];Hh[r.name]=r}return Hh[e]||null}},{key:"getRotors",value:function(e){return e.map((function(e){return t.getRotor(e)}))}}]),t}(sc),Zh=1732584193,Xh=4023233417,Yh=2562383102,Jh=271733878,Qh=7,ed=12,td=17,nd=22,rd=5,id=9,ad=14,od=20,sd=4,ld=11,ud=16,cd=23,hd=6,dd=10,fd=15,gd=21;function pd(e,t){var n=ft(e,4),r=n[0],i=n[1],a=n[2],o=n[3];r=md(r,i,a,o,t[0],Qh,3614090360),o=md(o,r,i,a,t[1],ed,3905402710),a=md(a,o,r,i,t[2],td,606105819),i=md(i,a,o,r,t[3],nd,3250441966),r=md(r,i,a,o,t[4],Qh,4118548399),o=md(o,r,i,a,t[5],ed,1200080426),a=md(a,o,r,i,t[6],td,2821735955),i=md(i,a,o,r,t[7],nd,4249261313),r=md(r,i,a,o,t[8],Qh,1770035416),o=md(o,r,i,a,t[9],ed,2336552879),a=md(a,o,r,i,t[10],td,4294925233),i=md(i,a,o,r,t[11],nd,2304563134),r=md(r,i,a,o,t[12],Qh,1804603682),o=md(o,r,i,a,t[13],ed,4254626195),a=md(a,o,r,i,t[14],td,2792965006),r=bd(r,i=md(i,a,o,r,t[15],nd,1236535329),a,o,t[1],rd,4129170786),o=bd(o,r,i,a,t[6],id,3225465664),a=bd(a,o,r,i,t[11],ad,643717713),i=bd(i,a,o,r,t[0],od,3921069994),r=bd(r,i,a,o,t[5],rd,3593408605),o=bd(o,r,i,a,t[10],id,38016083),a=bd(a,o,r,i,t[15],ad,3634488961),i=bd(i,a,o,r,t[4],od,3889429448),r=bd(r,i,a,o,t[9],rd,568446438),o=bd(o,r,i,a,t[14],id,3275163606),a=bd(a,o,r,i,t[3],ad,4107603335),i=bd(i,a,o,r,t[8],od,1163531501),r=bd(r,i,a,o,t[13],rd,2850285829),o=bd(o,r,i,a,t[2],id,4243563512),a=bd(a,o,r,i,t[7],ad,1735328473),r=kd(r,i=bd(i,a,o,r,t[12],od,2368359562),a,o,t[5],sd,4294588738),o=kd(o,r,i,a,t[8],ld,2272392833),a=kd(a,o,r,i,t[11],ud,1839030562),i=kd(i,a,o,r,t[14],cd,4259657740),r=kd(r,i,a,o,t[1],sd,2763975236),o=kd(o,r,i,a,t[4],ld,1272893353),a=kd(a,o,r,i,t[7],ud,4139469664),i=kd(i,a,o,r,t[10],cd,3200236656),r=kd(r,i,a,o,t[13],sd,681279174),o=kd(o,r,i,a,t[0],ld,3936430074),a=kd(a,o,r,i,t[3],ud,3572445317),i=kd(i,a,o,r,t[6],cd,76029189),r=kd(r,i,a,o,t[9],sd,3654602809),o=kd(o,r,i,a,t[12],ld,3873151461),a=kd(a,o,r,i,t[15],ud,530742520),r=wd(r,i=kd(i,a,o,r,t[2],cd,3299628645),a,o,t[0],hd,4096336452),o=wd(o,r,i,a,t[7],dd,1126891415),a=wd(a,o,r,i,t[14],fd,2878612391),i=wd(i,a,o,r,t[5],gd,4237533241),r=wd(r,i,a,o,t[12],hd,1700485571),o=wd(o,r,i,a,t[3],dd,2399980690),a=wd(a,o,r,i,t[10],fd,4293915773),i=wd(i,a,o,r,t[1],gd,2240044497),r=wd(r,i,a,o,t[8],hd,1873313359),o=wd(o,r,i,a,t[15],dd,4264355552),a=wd(a,o,r,i,t[6],fd,2734768916),i=wd(i,a,o,r,t[13],gd,1309151649),r=wd(r,i,a,o,t[4],hd,4149444226),o=wd(o,r,i,a,t[11],dd,3174756917),a=wd(a,o,r,i,t[2],fd,718787259),i=wd(i,a,o,r,t[9],gd,3951481745),e[0]=vd(r,e[0]),e[1]=vd(i,e[1]),e[2]=vd(a,e[2]),e[3]=vd(o,e[3])}function vd(e,t){return e+t&4294967295}function yd(e,t,n,r,i,a){return t=vd(vd(t,e),vd(r,a)),vd(t<<i|t>>>32-i,n)}function md(e,t,n,r,i,a,o){return yd(t&n|~t&r,e,t,i,a,o)}function bd(e,t,n,r,i,a,o){return yd(t&r|n&~r,e,t,i,a,o)}function kd(e,t,n,r,i,a,o){return yd(t^n^r,e,t,i,a,o)}function wd(e,t,n,r,i,a,o){return yd(n^(t|~r),e,t,i,a,o)}var _d={name:"hash",title:"Hash function",category:"Modern cryptography",type:"encoder"},Sd=[{name:"md5",label:"MD5",blockSize:64,available:!0},{name:"sha1",label:"SHA-1",blockSize:64,browserAlgorithm:"SHA-1",browserExceptions:["ie=11","edge"],nodeAlgorithm:"sha1"},{name:"sha256",label:"SHA-256",blockSize:64,browserAlgorithm:"SHA-256",nodeAlgorithm:"sha256"},{name:"sha384",label:"SHA-384",blockSize:128,browserAlgorithm:"SHA-384",nodeAlgorithm:"sha384"},{name:"sha512",label:"SHA-512",blockSize:128,browserAlgorithm:"SHA-512",browserExceptions:["ie=11"],nodeAlgorithm:"sha512"}],xd=function(e){function n(){var e;nt(this,n),(e=ht(this,ot(n).call(this))).setEncodeOnly(!0);var t=n.filterAvailableAlgorithms();return e.addSetting({name:"algorithm",type:"enum",value:"sha256",elements:t.map((function(e){return e.name})),labels:t.map((function(e){return e.label})),randomizable:!1,style:"radio"}),e}return at(n,e),it(n,null,[{key:"getMeta",value:function(){return _d}}]),it(n,[{key:"performEncode",value:function(e){var t=this.getSettingValue("algorithm");return this.createDigest(t,e.getBytes())}},{key:"createDigest",value:function(e,n){var r=this,i=Sd.find((function(t){return t.name===e}));switch(e){case"md5":return new Promise((function(e){return e(function(e){var t,n=(e=Array.from(e)).length;for(e.push(128);e.length%64!=56;)e.push(0);for(var r=0;r<8;r++)0===r?e.push((31&n)<<3):(t=8*r-3,e.push(t<32?n>>t&255:0));for(var i=e.length/4,a=new Array(i),o=0;o<i;o++)a[o]=(e[4*o+3]<<24)+(e[4*o+2]<<16)+(e[4*o+1]<<8)+e[4*o];for(var s=[Zh,Xh,Yh,Jh],l=0;l<i;l+=16)pd(s,a.slice(l,l+16));for(var u=new Array(16),c=0,h=0;h<16;c++,h+=4)u[h]=255&s[c],u[h+1]=s[c]>>8&255,u[h+2]=s[c]>>16&255,u[h+3]=s[c]>>24&255;return new Uint8Array(u)}(n))}))}if(Yc.isNode())return new Promise((function(e,r){var a=t.createHash(i.nodeAlgorithm).update(global.Buffer.from(n)).digest();e(new Uint8Array(a))}));var a=window.crypto||window.msCrypto,o=(a.subtle||a.webkitSubtle).digest(i.browserAlgorithm,n);return void 0!==o.oncomplete&&(o=new Promise((function(e,t){o.oncomplete=e.bind(r,o.result),o.onerror=t}))),o.then((function(e){return new Uint8Array(e)}))}}],[{key:"filterAvailableAlgorithms",value:function(){var e=Yc.isNode();return Sd.filter((function(t){return!0===t.available||(e||void 0===t.browserAlgorithm?!(!e||void 0===t.nodeAlgorithm):void 0===t.browserExceptions||!Yc.match.apply(Yc,t.browserExceptions))}))}},{key:"getAlgorithmBlockSize",value:function(e){var t=Sd.find((function(t){return t.name===e}));return void 0!==t?t.blockSize:null}}]),n}(sc),Vd={name:"hmac",title:"HMAC",category:"Modern cryptography",type:"encoder"},Id=function(e){function t(){var e;nt(this,t),(e=ht(this,ot(t).call(this))).setEncodeOnly(!0),e._hashEncoder=new xd;var n=e._hashEncoder.getSetting("algorithm");return e.addSettings([{name:"key",type:"bytes",value:new Uint8Array([99,114,121,112,116,105,105])},{name:"algorithm",type:"enum",value:n.getValue(),elements:n.getElements(),labels:n.getElementLabels(),randomizable:!1,style:"radio"}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Vd}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.getBytes(),n=this.getSettingValue("algorithm"),r=xd.getAlgorithmBlockSize(n),!((i=this.getSettingValue("key")).length>r)){c.next=8;break}return c.next=7,regeneratorRuntime.awrap(this.createDigest(n,i));case 7:i=c.sent;case 8:for((a=new Uint8Array(r)).set(i,0),(o=new Uint8Array(r+t.length)).set(a,0),o.set(t,r),s=0;s<r;s++)o[s]^=54,a[s]^=92;return c.next=16,regeneratorRuntime.awrap(this.createDigest(n,o));case 16:return l=c.sent,(u=new Uint8Array(r+l.length)).set(a,0),u.set(l,r),c.abrupt("return",this.createDigest(n,u));case 21:case"end":return c.stop()}}),null,this)}},{key:"createDigest",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return null===this._hashEncoder&&(this._hashEncoder=new xd),this._hashEncoder.setSettingValue("algorithm",e),r.next=4,regeneratorRuntime.awrap(this._hashEncoder.encode(t));case 4:return n=r.sent,r.abrupt("return",n.getBytes());case 6:case"end":return r.stop()}}),null,this)}}]),t}(sc);Da("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Da("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Da("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Da("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Cd={name:"integer",title:"Integer",category:"Encoding",type:"encoder"},Ed=["U8","I8","U16","I16","U32","I32"],Ad=[1,1,2,2,4,4],Md=["8-bit unsigned integer (U8)","8-bit signed integer (I8)","16-bit unsigned integer (U16)","16-bit signed integer (I16)","32-bit unsigned integer (U32)","32-bit signed integer (I32)"],Td=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"format",type:"enum",value:"decimal",elements:["binary","octal","decimal","hexadecimal"],labels:["Binary","Octal","Decimal","Hexadecimal"],randomizable:!1,priority:30},{name:"type",type:"enum",value:"U8",elements:Ed,labels:Md,randomizable:!1,style:"radio",priority:20},{name:"byteOrder",type:"enum",value:"big-endian",elements:["little-endian","big-endian"],labels:["Little-endian","Big-endian"],randomizable:!1,visible:!1,priority:10}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Cd}}]),it(t,[{key:"performEncode",value:function(e){var t=this.getSettingValue("type"),n=Ed.indexOf(t),r=Ad[n],i="big-endian"===this.getSettingValue("byteOrder"),a=e.getSize();a%r!=0&&(a+=r-a%r);var o=new Uint8Array(a);o.set(e.getBytes());for(var s=this.createIntegerTypeArray(a/r,t),l=0,u=0;u<o.length;)i?l=l<<8|o[u]:l|=o[u]<<u%r*8,++u%r==0&&(s[u/r-1]=l,l=0);var c=this.getSettingValue("format"),h=[];for(u=0;u<s.length;u++)switch(c){case"binary":h.push(s[u].toString(2));break;case"octal":h.push(s[u].toString(8));break;case"decimal":h.push(s[u].toString(10));break;default:h.push(s[u].toString(16))}return h.join(" ")}},{key:"performDecode",value:function(e){var t,n,r,i=this.getSettingValue("type"),a=Ed.indexOf(i),o=Ad[a],s="big-endian"===this.getSettingValue("byteOrder"),l=this.getSettingValue("format"),u=e.getString().split(/\s+/),c=this.createIntegerTypeArray(u.length,i);for(t=0;t<u.length;t++){switch(""===(r=u[t])&&(r="0"),l){case"binary":n=parseInt(r,2);break;case"octal":n=parseInt(r,8);break;case"decimal":n=parseInt(r,10);break;default:n=parseInt(r,16)}if(isNaN(n))throw new Hs("Invalid integer '".concat(r,"' at index ").concat(t));c[t]=n}var h,d=new Uint8Array(c.length*o);for(t=0;t<d.length;t++)n=c[parseInt(t/o)],h=s?o-t%o-1:t%o,d[t]=n>>8*h&255;return d}},{key:"createIntegerTypeArray",value:function(e,t){switch(t){case"I8":return new Int8Array(e);case"U8":return new Uint8Array(e);case"I16":return new Int16Array(e);case"U16":return new Uint16Array(e);case"I32":return new Int32Array(e);default:return new Uint32Array(e)}}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"type":var n=Ed.indexOf(this.getSettingValue("type"));this.getSetting("byteOrder").setVisible(Ad[n]>1)}}}]),t}(sc),Ld={name:"letters-to-numbers",title:"Letters to numbers",category:"Encoding",type:"encoder"},Pd="abcdefghijklmnopqrstuvwxyz",Bd=1,zd=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"shift",type:"number",label:"Shift",priority:10,value:Bd,integer:!0,describeValue:e.describeShiftValue.bind(ct(e)),randomizeValue:e.randomizeShiftValue.bind(ct(e))},{name:"language",label:"Ciphertext Alphabet",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],blackChoiceList:[],width:8,randomizable:!1},{name:"alphabet",type:"text",value:Pd,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Ld}}]),it(t,[{key:"fromLettersToNumbers",value:function(e,t){for(var n=new el(e),r=n.toString(),i="",a=0;a<n.getLength();a++)num=t.indexOf(r[a]),-1!==num&&(i+=num.toString()+" ");return new el(i).getCodePoints()}},{key:"fromNumbersToLetters",value:function(e,t){var n=e.getString(),r=n.replace(/(\d+)/g,(function(e,r,i){return!((0===i||Ws.isWhitespace(n,i-1))&&(n.length===i+r.length||Ws.isWhitespace(n,i+r.length)))||r>=t.length?r:t.getCharAt(r)}));return new el(r)}},{key:"performTranslate",value:function(e,t){this.getSettingValues().caseStrategy;var n,r,i,a=this.getSettingValue("alphabet"),o=(a=a.toLowerCase()).toUpperCase(),s=this.getSettingValue("shift"),l=a.getLength(),u=e.getLength(),c=new Array(u),h=0;t||(e=this.fromNumbersToLetters(e,a));for(var d=0;d<u;d++)n=e.getCodePointAt(d),-1===(r=a.indexOfCodePoint(n))&&(r=o.indexOfCodePoint(n)),-1!==r&&(i=oc.mod(r+s*(t?1:-1),l),c[h++]=a.getCodePointAt(i));return c=c.slice(0,h),t&&(c=this.fromLettersToNumbers(c,a)),c}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.getSetting("shift").setNeedsValueDescriptionUpdate(),t!=Pd&&"abcdefghilmnopqrstuvz"!=t&&this.setSettingValue("language","other");break;case"language":"english"==t?this.setSettingValue("alphabet",Pd):"italian"==t&&this.setSettingValue("alphabet","abcdefghilmnopqrstuvz"),this.getSetting("shift").setNeedsValueDescriptionUpdate()}}},{key:"randomizeShiftValue",value:function(e,t){var n=this.getSetting("alphabet");return n.isValid()?e.nextInteger(1,n.getValue().getLength()-1):null}},{key:"describeShiftValue",value:function(e,t){if(!this.getSetting("alphabet").isValid())return null;var n=this.getSettingValues(),r=n.alphabet,i=n.shift,a=r.getCharAt(0),o=oc.mod(i,r.getLength());return"".concat(a,"→").concat(o)}}]),t}(sc);Te({target:"String",proto:!0},{repeat:ws});var Od={name:"morse-code",title:"Morse code",category:"Alphabets",type:"encoder"},Fd="abcdefghijklmnopqrstuvwxyz0123456789.,?'!/()&:;=+-_\"$@",Nd=[".-","-...","-.-.","-..",".","..-.","--.","....","..",".---","-.-",".-..","--","-.","---",".--.","--.-",".-.","...","-","..-","...-",".--","-..-","-.--","--..","-----",".----","..---","...--","....-",".....","-....","--...","---..","----.",".-.-.-","--..--","..--..",".----.","-.-.--","-..-.","-.--.","-.--.-",".-...","---...","-.-.-.","-...-",".-.-.","-....-","..--.-",".-..-.","..._.._",".--.-."],Rd=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",value:"english",elements:["english"],labels:["English"],randomizable:!1},{name:"representation",type:"enum",value:"code",elements:["code","timing"],labels:["Code","Timing"],randomizable:!1},{name:"shortMark",label:"Short",type:"text",width:4,value:".",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(ct(e))},{name:"longerMark",label:"Long",type:"text",width:4,value:"-",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(ct(e))},{name:"spaceMark",label:"Space",type:"text",width:4,value:"/",minLength:1,randomizable:!1,validateValue:e.validateCodeMarkSettingValue.bind(ct(e))},{name:"signalOnMark",label:"Signal On",type:"text",width:6,visible:!1,value:"=",minLength:1,randomizable:!1,validateValue:e.validateTimingMarkSettingValue.bind(ct(e))},{name:"signalOffMark",label:"Signal Off",type:"text",width:6,visible:!1,value:".",minLength:1,randomizable:!1,validateValue:e.validateTimingMarkSettingValue.bind(ct(e))}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Od}}]),it(t,[{key:"performEncode",value:function(e){var n=this.getSettingValue("representation"),r=".",i="-",a="/";"code"===n&&(r=this.getSettingValue("shortMark").getString(),i=this.getSettingValue("longerMark").getString(),a=this.getSettingValue("spaceMark").getString());var o=e.toLowerCase().getChars().map((function(e){var n=t.encodeCharacter(e,r,i,a);if(null===n)throw new Hs("Char '".concat(e,"' is not defined in morse code"));return n})).join(" ");if("timing"===n){var s=this.getSettingValue("signalOnMark").getString(),l=this.getSettingValue("signalOffMark").getString();o=o.split("").map((function(e){switch(e){case".":return s;case"-":return s.repeat(3);default:return l}})).join(l)}return o}},{key:"performDecode",value:function(e){var n=this.getSettingValue("representation"),r=e.getString(),i=".",a="-",o="/";if("code"===n&&(i=this.getSettingValue("shortMark").getString(),a=this.getSettingValue("longerMark").getString(),o=this.getSettingValue("spaceMark").getString()),"timing"===n){var s=[this.getSettingValue("signalOnMark").getString(),this.getSettingValue("signalOffMark").getString()];r=(r=t.translateMarks(r,s,["=","."])).replace(/===/g,"-").replace(/\.{7}/g," / ").replace(/\.{3}/g," ").replace(/\./g,"").replace(/=/g,".")}return r=r.split(" ").map((function(e){if(""===e)return null;var n=t.decodeCode(e,i,a,o);if(null===n)throw new Hs("Code '".concat(e,"' is not defined in morse code"));return n})).filter((function(e){return null!==e})).join("")}},{key:"validateCodeMarkSettingValue",value:function(e,t){var n=this,r=t.filterValue(e);return null!==r.match(/\s/)?{key:"morseCodeMarkWhitespaceNotAllowed",message:"Whitespaces are not allowed inside morse code marks"}:void 0===["shortMark","longerMark","spaceMark"].filter((function(e){return e!==t.getName()})).find((function(e){return r.isEqualTo(n.getSettingValue(e))}))||{key:"morseCodeMarkNotUnique",message:"Morse code marks need to be different from each other"}}},{key:"validateTimingMarkSettingValue",value:function(e,t){var n=this,r=t.filterValue(e);return void 0===["signalOnMark","signalOffMark"].filter((function(e){return e!==t.getName()})).find((function(e){return 0===r.indexOf(n.getSettingValue(e))}))||{key:"morseCodeMarkNotUnique",message:"Timing marks need to be different from each other"}}},{key:"settingValueDidChange",value:function(e,t){var n=this;switch(e.getName()){case"shortMark":case"longerMark":case"spaceMark":["shortMark","longerMark","spaceMark"].filter((function(t){return t!==e.getName()})).forEach((function(e){return n.getSetting(e).revalidateValue()}));break;case"signalOnMark":case"signalOffMark":["signalOnMark","signalOffMark"].filter((function(t){return t!==e.getName()})).forEach((function(e){return n.getSetting(e).revalidateValue()}));break;case"representation":this.getSetting("shortMark").setVisible("code"===t),this.getSetting("longerMark").setVisible("code"===t),this.getSetting("spaceMark").setVisible("code"===t),this.getSetting("signalOnMark").setVisible("timing"===t),this.getSetting("signalOffMark").setVisible("timing"===t)}}}],[{key:"encodeCharacter",value:function(e,n,r,i){if(Ws.isWhitespace(e))return i;var a=Fd.indexOf(e);if(-1===a)return null;var o=Nd[a];return t.translateMarks(o,[".","-"],[n,r])}},{key:"decodeCode",value:function(e,n,r,i){if(e===i)return" ";var a=t.translateMarks(e,[n,r],[".","-"]),o=Nd.indexOf(a);return-1!==o?Fd[o]:null}},{key:"translateMarks",value:function(e,t,n){for(var r,i,a,o="",s=-1;++s<e.length;)for(a=!1,r=-1;!a&&++r<t.length;)i=t[r],(a=e.substr(s,i.length)===i)&&(o+=n[r],s+=i.length-1);return o}}]),t}(sc),Dd={name:"nihilist-cipher",title:"Nihilist cipher",category:"Polybius square ciphers",type:"encoder"},jd="cryptii",qd="abcdefghiklmnopqrstuvwxyz",$d=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"alphabet",type:"text",value:qd,uniqueChars:!0,minLength:0,maxLength:25,caseSensitivity:!1},{name:"key",type:"text",value:jd,whitelistChars:qd,minLength:2,caseSensitivity:!1},{name:"separator",type:"text",value:" ",randomizable:!1,blacklistChars:"0123456789",minLength:1,caseSensitivity:!1}]),e._polybiusSquare=new fc,e._polybiusSquare.setSettingValues({alphabet:qd,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Dd}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t=this.getSettingValue("key"),n=this.getSettingValue("separator"),d.next=4,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/j/gi,"i")));case 4:return r=d.sent,d.next=7,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 7:for(i=d.sent,a=r.getLength()/2,o=t.getLength(),s=new Array(a),h=0;h<a;h++)l=parseInt(r.getCharAt(2*h)+r.getCharAt(2*h+1)),u=2*oc.mod(h,o),c=parseInt(i.getCharAt(u)+i.getCharAt(u+1)),s[h]=l+c;return d.abrupt("return",el.join(s,n));case 13:case"end":return d.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return t=this.getSettingValue("key"),n=this.getSettingValue("separator"),r=e.getString().split(n),i=r.length,a=t.getLength(),f.next=7,regeneratorRuntime.awrap(this._polybiusSquare.encode(t));case 7:o=f.sent,h="",d=0;case 10:if(!(d<i)){f.next=23;break}if(s=parseInt(r[d]),!isNaN(s)){f.next=14;break}throw new Hs("Block at index ".concat(d+1," is not a number."));case 14:if(u=2*oc.mod(d,a),c=parseInt(o.getCharAt(u)+o.getCharAt(u+1)),(l=s-c).toString().match(/^[1-5]{2}$/)){f.next=19;break}throw new Hs("Block at index ".concat(d+1," results in invalid ")+"Polybius square coordinates '".concat(l,"'."));case 19:h+=l.toString();case 20:d++,f.next=10;break;case 23:return f.abrupt("return",this._polybiusSquare.decode(h));case 24:case"end":return f.stop()}}),null,this)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":var n=t.extend(qd);this._polybiusSquare.setSettingValue("alphabet",n),this.getSetting("key").setWhitelistChars(n)}}}]),t}(sc),Ud=Math.floor,Wd=function(e){return!_(e)&&isFinite(e)&&Ud(e)===e};Te({target:"Number",stat:!0},{isInteger:Wd});var Gd=Math.abs;Te({target:"Number",stat:!0},{isSafeInteger:function(e){return Wd(e)&&Gd(e)<=9007199254740991}});var Hd={name:"numeral-system",title:"Numeral system",category:"Transform",type:"encoder"},Kd=["binary","octal","decimal","hexadecimal","roman-numerals"],Zd=["Binary (2)","Octal (8)","Decimal (10)","Hexadecimal (16)","Roman numerals"],Xd=[/([01]+)/g,/([0-7]+)/g,/(\d+)/g,/([0-9a-f]+)/gi,/([IVXLCDM]+)/gi],Yd=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],Jd=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],Qd=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"from",label:"Read",type:"enum",value:"decimal",elements:Kd,labels:Zd,randomizable:!1,style:"radio"},{name:"to",label:"Convert to",type:"enum",value:"hexadecimal",elements:Kd,labels:Zd,randomizable:!1,style:"radio"}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Hd}}]),it(t,[{key:"performTranslate",value:function(e,n){var r=e.toString(),i=this.getSettingValue(n?"from":"to"),a=this.getSettingValue(n?"to":"from"),o=Xd[Kd.indexOf(i)];return r.replace(o,(function(e,n,o){if(!((0===o||Ws.isWhitespace(r,o-1))&&(r.length===o+n.length||Ws.isWhitespace(r,o+n.length))))return n;var s=t.decodeNumber(i,n);return(null!==s?t.encodeNumber(a,s):null)||n}))}}],[{key:"decodeNumber",value:function(e,n){if("undefined"!=typeof BigInt)switch(e){case"binary":return BigInt("0b".concat(n));case"octal":return BigInt("0o".concat(n));case"decimal":return BigInt(n);case"hexadecimal":return BigInt("0x".concat(n))}var r=null;switch(e){case"binary":r=parseInt(n,2);break;case"octal":r=parseInt(n,8);break;case"decimal":r=parseInt(n,10);break;case"hexadecimal":r=parseInt(n,16);break;case"roman-numerals":r=t.romanNumeralsToDecimal(n)}if(null===r||isNaN(r))return null;if(!t.isSafeInteger(r))throw new Hs("Can't read '".concat(n,"' because the current environment does not ")+"support arbitrarily large integers.");return r}},{key:"encodeNumber",value:function(e,n){switch(e){case"binary":return n.toString(2);case"octal":return n.toString(8);case"decimal":return n.toString(10);case"hexadecimal":return n.toString(16);case"roman-numerals":return t.decimalToRomanNumerals(n);default:return null}}},{key:"isSafeInteger",value:function(e){if(void 0===Number.isSafeInteger){var t=Number.MAX_SAFE_INTEGER||9007199254740991;return Number.isInteger(e)&&Math.abs(e)<=t}return Number.isSafeInteger(e)}},{key:"decimalToRomanNumerals",value:function(e){if(e<=0||e>=4e3)return null;for(var t,n=Number(e),r="";n>0;)t=Jd.findIndex((function(e){return n>=e})),r+=Yd[t],n-=Jd[t];return r}},{key:"romanNumeralsToDecimal",value:function(e){e=e.toString().toUpperCase();for(var t,n=0,r=0,i=!1,a=0;!i&&n<e.length;)-1!==(t=Yd.findIndex((function(t){return e.substr(n,t.length)===t})))&&t>=a?(r+=Jd[t],n+=Yd[t].length,a=t):i=!0;return i?null:r}}]),t}(sc),ef=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._tape=[],e._rows=8,e._$canvas=null,e._$tapes=null,e._$marks=null,e._$holes=null,e}return at(t,e),it(t,[{key:"setTape",value:function(e,t){return this._tape=e,this._rows=t,this.setNeedsUpdate()}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("viewer-paper-tape"),e}},{key:"renderContent",value:function(){this._$tapes=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$tapes.classList.add("viewer-punched-tape__tape"),this._$marks=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$marks.classList.add("viewer-punched-tape__mark"),this._$holes=document.createElementNS("http://www.w3.org/2000/svg","path"),this._$holes.classList.add("viewer-punched-tape__hole"),this._$canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._$canvas.classList.add("viewer-punched-tape__canvas"),this._$canvas.appendChild(this._$tapes),this._$canvas.appendChild(this._$marks),this._$canvas.appendChild(this._$holes),this.setNeedsUpdate();var e=dt(ot(t.prototype),"renderContent",this).call(this);return e.appendChild(this._$canvas),e}},{key:"layout",value:function(){return this.setNeedsUpdate(),dt(ot(t.prototype),"layout",this).call(this)}},{key:"update",value:function(){var e=this._tape,t=this._tape.length,n=this._rows,r=Math.floor((n-1)/2);n++;var i,a,o,s,l,u=1.5,c=this._$canvas.getBoundingClientRect().width-32,h=Math.floor((c-22)/13)+1,d=(c-13*(h-1))/2,f=Math.ceil(t/h),g=13*(n-1)+22,p=g+16,v=f*(g+16)+16,m=[],b=[];for(s=0;s<t;s++){for(i=e[s],a=16+d+s%h*13,o=27+Math.floor(s/h)*p,l=0;l<n;l++)l===r?(b.push("M ".concat(a-u," ").concat(o+13*l)),b.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(3,",0")),b.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(-3,",0"))):(0!=(1&i)&&(b.push("M ".concat(a-3," ").concat(o+13*l)),b.push("a ".concat(3,",").concat(3," 0 1,0 ").concat(6,",0")),b.push("a ".concat(3,",").concat(3," 0 1,0 ").concat(-6,",0"))),i>>=1);s%n==0&&n>=5&&(m.push("M ".concat(a-u,",").concat(o-11+g+8)),m.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(3,",0")),m.push("a ".concat(u,",").concat(u," 0 1,0 ").concat(-3,",0")))}var k,w,_=[];for(y=0;y<f;y++)16,k=16+y*p,w=y<f-1||t%h==0?c:t%h*13+2*d,_.push("M ".concat(16,",").concat(k+3)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(3,",").concat(-3)),_.push("L ".concat(16+w-3,",").concat(k)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(3,",").concat(3)),_.push("L ".concat(16+w,",").concat(k+g-3)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(-3,",").concat(3)),_.push("L ".concat(19,",").concat(k+g)),_.push("a ".concat(3,",").concat(3," 0 0 1 ").concat(-3,",").concat(-3)),_.push("Z");this._$canvas.style.height="".concat(v,"px"),this._$tapes.setAttribute("d",_.join(" ")),this._$marks.setAttribute("d",m.join(" ")),this._$holes.setAttribute("d",b.join(" "))}}]),t}(mh),tf={name:"punched-tape",title:"Punched tape",category:"View",type:"viewer"},nf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=ef,e.addSetting({name:"rows",type:"number",value:8,min:3,max:25,randomizable:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return tf}}]),it(t,[{key:"performView",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:t=this.getSettingValue("rows"),n=e.getBytes(),r=ms.resizeBitSizedArray(n,8,t,!0),this.getView().setTape(r,t);case 4:case"end":return i.stop()}}),null,this)}}]),t}(kh),rf={name:"punycode",title:"Punycode",category:"Encoding",type:"encoder"},af={basicRangeStart:0,basicRangeEnd:127,digitMapping:"abcdefghijklmnopqrstuvwxyz0123456789",delimiter:"-",caseSensitivity:!1,initialBias:72,initialN:128,tmin:1,tmax:26,skew:38,damp:700},of=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._bootstringEncoder=new yh,e._bootstringEncoder.setSettingValues(af),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return rf}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:e=e.toLowerCase(),t=e.split("."),n=new Array(t.length),r=0;case 4:if(!(r<t.length)){a.next=16;break}if(-1!==this._nonBasicCodePointIndex(t[r].getCodePoints())){a.next=9;break}n[r]=t[r],a.next=13;break;case 9:return a.next=11,regeneratorRuntime.awrap(this._bootstringEncoder.encode(t[r]));case 11:i=a.sent,n[r]="xn--"+i.getString();case 13:r++,a.next=4;break;case 16:return a.abrupt("return",el.join(n,"."));case 17:case"end":return a.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(-1===(t=this._nonBasicCodePointIndex(e.getCodePoints()))){o.next=3;break}throw new Hs("Invalid Punycode character at index ".concat(t));case 3:n=e.split("."),r=new Array(n.length),i=0;case 6:if(!(i<n.length)){o.next=18;break}if(0===n[i].indexOf("xn--")){o.next=11;break}r[i]=n[i],o.next=15;break;case 11:return a=n[i].substr("xn--".length),o.next=14,regeneratorRuntime.awrap(this._bootstringEncoder.decode(a));case 14:r[i]=o.sent;case 15:i++,o.next=6;break;case 18:return o.abrupt("return",el.join(r,"."));case 19:case"end":return o.stop()}}),null,this)}},{key:"_nonBasicCodePointIndex",value:function(e){return e.findIndex((function(e){return e>=128}))}}]),t}(sc),sf={name:"rail-fence-cipher",title:"Rail fence cipher",category:"Ciphers",type:"encoder"},lf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"key",type:"number",value:2,integer:!0,min:2,randomizeValue:function(e){return e.nextInteger(2,8)}},{name:"offset",type:"number",value:0,integer:!0,min:0,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return sf}}]),it(t,[{key:"performEncode",value:function(e){var t,n=this.getSettingValues(),r=n.key,i=n.offset,a=e.getLength(),o=2*r-2,s=new Array(r).fill("");for(t=0;t<a;t++)s[r-1-Math.abs(o/2-(t+i)%o)]+=e.getCharAt(t);return s.join("")}},{key:"performDecode",value:function(e){var t,n,r=this.getSettingValues(),i=r.key,a=r.offset,o=e.getLength(),s=2*i-2,l=new Array(o),u=-1;for(n=0;n<i;n++)for(t=0;t<o;t++)(n+t+a)%s!=0&&(n-t-a)%s!=0||(l[t]=e.getCodePointAt(++u));return l}}]),t}(sc),uf={name:"rc4",title:"RC4",category:"Modern cryptography",type:"encoder"},cf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"key",type:"bytes",value:new Uint8Array([99,114,121,112,116,105,105]),minSize:1,maxSize:32,randomizeSize:8},{name:"drop",type:"number",label:"Drop bytes",value:0,integer:!0,min:0,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return uf}}]),it(t,[{key:"performTranslate",value:function(e,t){for(var n=this.getSettingValue("key"),r=this.getSettingValue("drop"),i=n.length,a=e.getBytes(),o=a.length,s=new Uint8Array(o),l=new Uint8Array(256),u=0;u<256;u++)l[u]=u;for(var c=0,h=0;h<256;h++){var d=[l[c=(c+l[h]+n[h%i])%256],l[h]];l[h]=d[0],l[c]=d[1]}var f,g=0;c=0;for(var p=0;p<r+o;p++){var v=[l[c=(c+l[g=(g+1)%256])%256],l[g]];l[g]=v[0],l[c]=v[1],f=l[(l[g]+l[c])%256],p>=r&&(s[p-r]=a[p-r]^f)}return s}}]),t}(sc),hf={name:"replace",title:"Replace",category:"Transform",type:"encoder"},df=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"find",type:"text",value:"",randomizable:!1},{name:"replace",type:"text",value:"",randomizable:!1},{name:"caseSensitivity",type:"boolean",value:!1,randomizable:!1}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return hf}}]),it(t,[{key:"performTranslate",value:function(e,t){var n=this.getSettingValue("caseSensitivity"),r=this.getSettingValues(),i=r.find,a=r.replace;if(!t){var o=[a,i];i=o[0],a=o[1]}var s=e;n||(s=s.toLowerCase(),i=i.toLowerCase()),s=s.getCodePoints(),e=e.getCodePoints(),i=i.getCodePoints(),a=a.getCodePoints();for(var l=0,u=-1,c=[];-1!==(u=ms.indexOfSlice(s,i,u+1));)c=(c=c.concat(e.slice(l,u))).concat(a),l=u+i.length;return c.concat(e.slice(l))}}]),t}(sc),ff={name:"reverse",title:"Reverse",category:"Transform",type:"encoder"},gf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSetting({name:"type",label:"By",type:"enum",value:"character",elements:["byte","character","line"],labels:["Byte","Character","Line"],randomizable:!1,style:"radio"}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return ff}}]),it(t,[{key:"performTranslate",value:function(e,t){switch(this.getSettingValue("type")){case"byte":return e.getBytes().reverse();case"character":return el.join(e.getChars().reverse(),"");case"line":return el.join(e.split(/\r?\n/).reverse(),"\n")}}}]),t}(sc),pf={name:"rot13",title:"ROT13",category:"Ciphers",type:"encoder"},vf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSetting({name:"variant",type:"enum",value:"rot13",elements:["rot5","rot13","rot18","rot47"],labels:["ROT5 (0-9)","ROT13 (A-Z, a-z)","ROT18 (0-9, A-Z, a-z)","ROT47 (!-~)"],randomizable:!1,style:"radio"}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return pf}}]),it(t,[{key:"performTranslate",value:function(e,t){var n=this,r=this.getSettingValue("variant");return e.getCodePoints().map((function(e){return"rot5"!==r&&"rot18"!==r||(e=n._rotateCodePoint(e,48,57)),"rot13"!==r&&"rot18"!==r||(e=n._rotateCodePoint(e,97,122),e=n._rotateCodePoint(e,65,90)),"rot47"===r&&(e=n._rotateCodePoint(e,33,126)),e}))}},{key:"_rotateCodePoint",value:function(e,t,n){if(e>=t&&e<=n){var r=n-t+1;(e+=r/2)>n&&(e-=r)}return e}}]),t}(sc),yf={name:"spelling-alphabet",title:"Spelling alphabet",category:"Alphabets",type:"encoder"},mf=[{name:"nato",label:"NATO/ICAO phonetic alphabet",characters:"abcdefghijklmnopqrstuvwxxyz0123456789.",words:["Alfa","Bravo","Charlie","Delta","Echo","Foxtrot","Golf","Hotel","India","Juliett","Kilo","Lima","Mike","November","Oscar","Papa","Quebec","Romeo","Sierra","Tango","Uniform","Victor","Whiskey","X-ray","Xray","Yankee","Zulu","Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Stop"],spaceWord:"(space)"},{name:"dutch",label:"Dutch spelling alphabet",characters:["a","b","c","d","e","f","g","h","ij","ij","i","j","j","k","l","l","m","n","o","p","q","q","r","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],words:["Anton","Bernhard","Cornelis","Dirk","Eduard","Ferdinand","Gerard","Hendrik","IJmuiden","IJsbrand","Izaak","Johan","Jacob","Karel","Lodewijk","Leo","Maria","Nico","Otto","Pieter","Quirinius","Quinten","Richard","Rudolf","Simon","Theodoor","Utrecht","Victor","Willem","Xantippe","Ypsilon","Zacharias","Nul","Een","Twee","Drie","Vier","Vijf","Zes","Zeven","Acht","Negen"],spaceWord:"(spatiebalk)"},{name:"german",label:"German spelling alphabet",characters:"abcdefghijkklmnopqrsstuvwxxyzzäööüüßß0123456789",words:["Anton","Berta","Cäsar","Dora","Emil","Friedrich","Gustav","Heinrich","Ida","Julius","Kaufmann","Konrad","Ludwig","Martha","Nordpol","Otto","Paula","Quelle","Richard","Samuel","Siegfried","Theodor","Ulrich","Viktor","Wilhelm","Xanthippe","Xaver","Ypsilon","Zacharias","Zürich","Ärger","Ökonom","Österreich","Übermut","Übel","Eszett","Scharfes S","Null","Eins","Zwei","Drei","Vier","Fünf","Sechs","Sieben","Acht","Neun"],spaceWord:"(Leertaste)"},{name:"swedish",label:"Swedish Armed Forces' radio alphabet",characters:"abcdefghijklmnopqrstuvwxyzåäö0123456789",words:["Adam","Bertil","Caesar","David","Erik","Filip","Gustav","Helge","Ivar","Johan","Kalle","Ludvig","Martin","Niklas","Olof","Petter","Qvintus","Rudolf","Sigurd","Tore","Urban","Viktor","Wilhelm","Xerxes","Yngve","Zäta","Åke","Ärlig","Östen","Nolla","Ett","Tvåa","Trea","Fyra","Femma","Sexa","Sju","Åtta","Nia"],spaceWord:"(mellanslag)"},{name:"russian",label:"Russian spelling alphabet (official, excludes Ё)",characters:"абвгдежзийклмнопрстуфхцчшщъыьэюя0123456789.",words:["Анна","Борис","Василий","Григорий","Дмитрий","Елена","Женя","Зинаида","Иван","Иван краткий","Константин","Леонид","Михаил","Николай","Ольга","Павел","Роман","Семён","Татьяна","Ульяна","Фёдор","Харитон","Цапля","Человек","Шура","Щука","Твёрдый знак","Еры","Мягкий знак","Эхо","Юрий","Яков","Ноль","Один","Два","Три","Четыре","Пять","Шесть","Семь","Восемь","Девять","Точка"],spaceWord:"(пробел)"},{name:"russian-unofficial",label:"Russian spelling alphabet (unofficial, includes Ё)",characters:"абвгдеёжзийклмнопрстуфхцчшщъыьэюя0123456789.",words:["Антон","Борис","Василий","Галина","Дмитрий","Елена","Ёлка","Жук","Зоя","Иван","Йот","Киловатт","Леонид","Мария","Николай","Ольга","Павел","Радио","Сергей","Тамара","Ульяна","Фёдор","Харитон","Центр","Человек","Шура","Щука","Твёрдый знак","Игрек","Мягкий знак","Эмма","Юрий","Яков","Ноль","Один","Два","Три","Четыре","Пять","Шесть","Семь","Восемь","Девять","Точка"],spaceWord:"(пробел)"}],bf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._characterMap={},e._wordMap={},e.addSetting({name:"alphabet",type:"enum",elements:mf.map((function(e){return e.name})),labels:mf.map((function(e){return e.label})),randomizable:!1,style:"radio"}),e.buildTranslationMap(),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return yf}}]),it(t,[{key:"performTranslate",value:function(e,t){for(var n=Ws.normalizeWhitespaces(e.getString()),r=t?this._characterMap:this._wordMap,i=Object.keys(r).sort((function(e,t){return t.length-e.length})),a=0,o=[];a<n.length;){var s=i.find((function(e){return n.substr(a,e.length).toLowerCase()===e.toLowerCase()}));if(void 0!==s)o.push(r[s]),a+=s.length;else{var l=n.substr(a,1);(t||" "!==l)&&o.push(l),a++}}return o.join(t?" ":"")}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"alphabet":this.buildTranslationMap()}}},{key:"buildTranslationMap",value:function(){var e=this.getSettingValue("alphabet"),t=mf.find((function(t){return t.name===e}));if(void 0===t)throw new Error("Alphabet with name '".concat(e,"' is not defined"));var n="string"==typeof t.characters?t.characters.split(""):t.characters,r=t.words,i={};n.forEach((function(e,t){void 0===i[e]&&(i[e]=r[t])}));var a={};r.forEach((function(e,t){e=e.toLowerCase(),void 0===a[e]&&(a[e]=n[t])}));var o=t.spaceWord||"(space)";return i[" "]=o,a[o]=" ",this._characterMap=i,this._wordMap=a,this}}]),t}(sc),kf={name:"stress-deletion",title:"Stress Deletion",category:"Transform",type:"encoder"},wf={"è":"e","é":"e","à":"a","á":"a","ò":"o","ó":"o","í":"i","ì":"i","ù":"u","ú":"u","Á":"A","À":"A","È":"E","É":"E","Í":"I","Ì":"I","Ò":"O","Ó":"O","Ú":"U","Ù":"U"},_f=function(e){function t(){return nt(this,t),ht(this,ot(t).call(this))}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return kf}}]),it(t,[{key:"performTranslate",value:function(e,t){var n=e.getString();return cleanString=n.replace(/è|é|à|á|ò|ó|í|ì|ù|ú|Á|À|È|É|Í|Ì|Ò|Ó|Ú|Ù/g,(function(e){return wf[e]})),new el(cleanString).getCodePoints()}},{key:"settingValueDidChange",value:function(e,t){}}]),t}(sc),Sf={name:"tap-code",title:"Tap code",category:"Polybius square ciphers",type:"encoder"},xf="abcdefghijlmnopqrstuvwxyz",Vf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"tapMark",label:"Tap",type:"text",width:4,value:".",minLength:1,randomizable:!1},{name:"groupMark",label:"Group",type:"text",width:4,value:" ",minLength:1,randomizable:!1},{name:"letterMark",label:"Letter",type:"text",width:4,value:"  ",minLength:1,randomizable:!1}]),e._polybiusSquare=new fc,e._polybiusSquare.setSettingValues({alphabet:xf,rows:"12345",columns:"12345",separator:"",caseSensitivity:!1,includeForeignChars:!1}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Sf}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=this.getSettingValue("tapMark").getString(),n=this.getSettingValue("groupMark").getString(),r=this.getSettingValue("letterMark").getString(),c.next=5,regeneratorRuntime.awrap(this._polybiusSquare.encode(e.getString().replace(/k/gi,"c")));case 5:for(i=c.sent,a=i.getLength()/2,l="",u=0;u<a;u++)o=parseInt(i.getCharAt(2*u)),s=parseInt(i.getCharAt(2*u+1)),l+=(u>0?r:"")+t.repeat(o)+n+t.repeat(s);return c.abrupt("return",l);case 10:case"end":return c.stop()}}),null,this)}},{key:"performDecode",value:function(e){for(var t=this.getSettingValue("tapMark").getCodePoints(),n=t.length,r=e.getCodePoints(),i="",a=0,o=-1,s=0;-1!==(o=ms.indexOfSlice(r,t,o+1));)0===a||o===a+n?s++:(i+=s.toString(),s=1),a=o;return i+=s.toString(),this._polybiusSquare.decode(i)}}]),t}(sc),If={name:"text",title:"Text",category:"View",type:"viewer"},Cf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=bh,e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return If}}]),it(t,[{key:"performView",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.getView().setText(e.getString());case 1:case"end":return t.stop()}}),null,this)}},{key:"viewTextDidChange",value:function(e,t){var n=this;this.dare((function(){n.contentDidChange(el.wrap(t))}))}}]),t}(kh),Ef={name:"trifid-cipher",title:"Trifid cipher",category:"Polybius square ciphers",type:"encoder"},Af=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"key",type:"text",value:"",uniqueChars:!0,minLength:0,maxLength:27,caseSensitivity:!1},{name:"groupSize",type:"number",value:5,min:2}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Ef}}]),it(t,[{key:"performEncode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d,f,g;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:for(t=this.getSettingValues(),n=t.key,r=t.groupSize,i=el.wrap(n).extend("abcdefghijklmnopqrstuvwxyz+").getCodePoints(),a=e.toLowerCase().getCodePoints().map((function(e){return i.indexOf(e)})).filter((function(e){return-1!==e})),o=a.length,s=new Array(3*o),l=0;l<o;l++)for(h=Math.floor(l/r),d=l-h*r,f=Math.min(r,o-h*r),c=this.cartesianCoordinatesFromIndex(a[l]),u=0;u<3;u++)s[d+h*r*3+f*u]=c[u];for(g=new Array(o),l=0;l<o;l++)c=s.slice(3*l,3*(l+1)),d=this.indexFromCartesianCoordinates(c),g[l]=i[d];return p.abrupt("return",g);case 9:case"end":return p.stop()}}),null,this)}},{key:"performDecode",value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d,f,g;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:for(t=this.getSettingValues(),n=t.key,r=t.groupSize,i=el.wrap(n).extend("abcdefghijklmnopqrstuvwxyz+").getCodePoints(),a=e.toLowerCase().getCodePoints().map((function(e){return i.indexOf(e)})).filter((function(e){return-1!==e})),o=a.length,s=new Array(3*o),l=0;l<o;l++)for(c=this.cartesianCoordinatesFromIndex(a[l]),u=0;u<3;u++)s[3*l+u]=c[u];for(h=new Array(o),l=0;l<o;l++){for(d=Math.floor(l/r),f=l-d*r,g=Math.min(r,o-d*r),u=0;u<3;u++)c[u]=s[f+d*r*3+g*u];f=this.indexFromCartesianCoordinates(c),h[l]=i[f]}return p.abrupt("return",h);case 9:case"end":return p.stop()}}),null,this)}},{key:"cartesianCoordinatesFromIndex",value:function(e){var t=Math.floor(e/9),n=Math.floor((e-9*t)/3);return[t+1,n+1,e-9*t-3*n+1]}},{key:"indexFromCartesianCoordinates",value:function(e){var t=ft(e,3);return 9*(t[0]-1)+3*(t[1]-1)+(t[2]-1)}}]),t}(sc),Mf={name:"unicode-code-points",title:"Unicode code points",category:"Encoding",type:"encoder"},Tf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).setCharacterToBlockMode(),e.addSetting({name:"format",type:"enum",value:"unicode",elements:["unicode","decimal","hexadecimal","binary","octal","ncr-decimal","ncr-hexadecimal"],labels:["Unicode notation","Decimal","Hexadecimal","Binary","Octal","NCR (Decimal)","NCR (Hexadecimal)"],randomizable:!1,style:"radio"}),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Mf}}]),it(t,[{key:"performCharEncodeToBlock",value:function(e,t,n){switch(this.getSettingValue("format")){case"unicode":return"U+"+e.toString(16).toUpperCase();case"decimal":return e.toString(10);case"hexadecimal":return e.toString(16);case"binary":return e.toString(2);case"octal":return e.toString(8);case"ncr-decimal":return"&#".concat(e.toString(10),";");case"ncr-hexadecimal":return"&#x".concat(e.toString(16),";")}}},{key:"performBlockDecodeToChar",value:function(e,t,n,r){var i,a=0;switch(this.getSettingValue("format")){case"unicode":null!==(i=e.match(/^U\+([0-9A-F]+)$/i))&&(a=parseInt(i[1],16));break;case"decimal":a=parseInt(e,10);break;case"hexadecimal":a=parseInt(e,16);break;case"binary":a=parseInt(e,2);break;case"octal":a=parseInt(e,8);break;case"ncr-decimal":case"ncr-hexadecimal":null!==(i=e.match(/^&#x([0-9A-F]+);$/i))?a=parseInt(i[1],16):null!==(i=e.match(/^&#([0-9]+);$/))&&(a=parseInt(i[1],10))}if(!Js.validateCodePoint(a))throw new Hs("Invalid code point at index ".concat(t));return a}}]),t}(uc),Lf={name:"url-encoding",title:"URL encoding",category:"Encoding",type:"encoder"},Pf=function(e){function t(){return nt(this,t),ht(this,ot(t).apply(this,arguments))}return at(t,e),it(t,[{key:"performEncode",value:function(e){try{for(var t,n=e.getChars(),r="",i=0;i<n.length;i++)t=n[i],r+=-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.~".indexOf(t)?this.encodeBytes(e.getCharBytesAt(i)):t;return r}catch(t){if(t instanceof Ys)return this.encodeBytes(e.getBytes());throw t}}},{key:"encodeBytes",value:function(e){for(var t="",n=0;n<e.length;n++)t+="%"+("0"+e[n].toString(16)).slice(-2);return t}},{key:"performDecode",value:function(e){for(var t,n,r=e.getString(),i=[],a=0;a<r.length;)if("%"===(t=r[a])){if(null===(n=r.substr(a+1,2)).match(/[0-9a-f]{2}/i))throw new Hs("Invalid percent-encoded byte '%".concat(n,"' at index ").concat(a));i.push(parseInt(n,16)),a+=3}else if("+"===t)i.push(32),a++;else{if(-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.~".indexOf(t))throw new Hs("Invalid character '".concat(t,"' at index ").concat(a));i.push(t.charCodeAt(0)),a++}return new Uint8Array(i)}}],[{key:"getMeta",value:function(){return Lf}}]),t}(sc),Bf={name:"vigenere-cipher",title:"Vigenère cipher",category:"Ciphers",type:"encoder"},zf="abcdefghijklmnopqrstuvwxyz",Of=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this))).addSettings([{name:"variant",type:"enum",value:"standard",elements:["standard","beaufort-cipher","variant-beaufort-cipher","trithemius-cipher"],labels:["Standard Vigenère cipher","Beaufort cipher","Variant Beaufort cipher","Trithemius cipher"],randomizable:!1},{name:"key",type:"text",value:"cryptii",whitelistChars:zf,minLength:2,caseSensitivity:!1},{name:"keyMode",type:"enum",value:"repeat",elements:["repeat","autokey"],labels:["Repeat","Autokey"],randomizable:!1},{name:"language",type:"enum",value:"english",elements:["english","italian","other"],labels:["English","Italian","Other"],width:6,randomizable:!1},{name:"alphabet",type:"text",value:zf,uniqueChars:!0,minLength:2,caseSensitivity:!1,randomizable:!1},{name:"caseStrategy",type:"enum",value:"maintain",elements:["maintain","ignore","strict"],labels:["Maintain case","Ignore case","Strict (A ≠ a)"],width:6,randomizable:!1},{name:"includeForeignChars",type:"boolean",label:"Foreign Chars",width:6,value:!0,randomizable:!1,trueLabel:"Include",falseLabel:"Ignore"}]),e}return at(t,e),it(t,null,[{key:"getMeta",value:function(){return Bf}}]),it(t,[{key:"performTranslate",value:function(e,t){var n,r=this.getSettingValues(),i=r.variant,a=r.caseStrategy,o=r.includeForeignChars,s=this.getSettingValue("alphabet");"strict"!==a&&(n=(s=s.toLowerCase()).toUpperCase());var l=this.getSettingValues(),u=l.key,c=l.keyMode;"trithemius-cipher"===i&&(u=s,c="repeat");for(var h,d,f,g,p,v=e.getLength(),y=new Array(v),m=0,b=0,k=0;k<v;k++)if(d=e.getCodePointAt(k),f=!1,-1===(h=s.indexOfCodePoint(d))&&"strict"!==a&&(h=n.indexOfCodePoint(d),f=!0),-1!==h){switch(g=u.getCodePointAt(oc.mod(b,u.getLength())),p=s.indexOfCodePoint(g),i){case"beaufort-cipher":h=p-h;break;case"variant-beaufort-cipher":h=t?h-p:h+p;break;default:h=t?h+p:h-p}h=oc.mod(h,s.getLength()),y[m++]="maintain"===a&&f?n.getCodePointAt(h):s.getCodePointAt(h),"autokey"===c&&(g=t?d:s.getCodePointAt(h),u=el.join([u,el.wrap([g]).toLowerCase()],"")),b++}else o&&(y[m++]=d);return y.slice(0,m)}},{key:"settingValueDidChange",value:function(e,t){switch(e.getName()){case"variant":this.getSetting("key").setVisible("trithemius-cipher"!==t),this.getSetting("keyMode").setVisible("trithemius-cipher"!==t);break;case"alphabet":"abcdefghijklmnopqrstuvwxyz"!=t&&"abcdefghilmnopqrstuvz"!=t&&this.getSetting("language").setValue("other"),this.getSetting("key").setWhitelistChars(t);break;case"caseStrategy":this.getSetting("alphabet").setCaseSensitivity("strict"===t),this.getSetting("key").setCaseSensitivity("strict"===t);break;case"language":"english"==t?this.getSetting("alphabet").setValue("abcdefghijklmnopqrstuvwxyz"):"italian"==t&&(console.log("italian"),this.getSetting("alphabet").setValue("abcdefghilmnopqrstuvz"))}}}]),t}(sc),Ff=null,Nf=function(e){function t(){var e;return nt(this,t),e=ht(this,ot(t).call(this)),[Cf,_h,nf,df,gf,Nh,Qd,Hc,_f,Rd,bf,Kh,Oh,wc,vf,hc,Of,Tc,Vc,lf,fc,mc,Uc,$d,Vf,Af,Bc,Nc,Ec,jc,Tf,Pf,of,yh,Td,zd,th,cf,xd,Id].forEach(e.register.bind(ct(e))),e}return at(t,e),it(t,[{key:"register",value:function(e){var n=e.getMeta().name;return dt(ot(t.prototype),"register",this).call(this,n,e)}},{key:"getMeta",value:function(e){return this.getInvokable(e).getMeta()}},{key:"getLibrary",value:function(){var e=this;return this.getIdentifiers().map((function(t){return e.getMeta(t)}))}}],[{key:"getInstance",value:function(){return null===Ff&&(Ff=new t),Ff}}]),t}(en),Rf=function(e){function t(e){var n;return nt(this,t),(n=ht(this,ot(t).call(this)))._title=e,n._$trigger=null,n._visible=!1,n._value=null,n._finishCallback=null,n._cancelCallback=null,n._keyUpHandler=n.keyDidPress.bind(ct(n)),n._$outer=null,n._$dialog=null,n}return at(t,e),it(t,[{key:"isVisible",value:function(){return this._visible}},{key:"setVisible",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._visible!==t){this._visible=t;var r=this.getElement();t&&(document.body.appendChild(r),this._$trigger=document.activeElement);var i=this._$dialog.getBoundingClientRect().height;t?this._$dialog.style.height="0px":(this._$dialog.style.height="".concat(i,"px"),this._$outer.style.height="".concat(i,"px")),r.getBoundingClientRect(),r.addEventListener("transitionend",(function(){setTimeout(e.visibilityDidChange.bind(e,t,n),100)}),{once:!0}),t?(document.body.classList.add("modal-visible"),r.classList.add("modal--visible"),this._$dialog.style.height="".concat(i,"px"),this._keyUpHandler&&document.addEventListener("keyup",this._keyUpHandler)):(document.body.classList.remove("modal-visible"),r.classList.remove("modal--visible"),this._$dialog.style.height="0px",this._keyUpHandler&&document.removeEventListener("keyup",this._keyUpHandler))}return this}},{key:"visibilityDidChange",value:function(e,t){var n=this;e?(this._$dialog.removeAttribute("style"),this.getElement().focus()):(setTimeout((function(){n._$dialog.removeAttribute("style"),n._$outer.removeAttribute("style");var e=n.getElement();null!==e.parentNode&&e.parentNode.removeChild(e)}),100),!1===t&&null!==this._finishCallback?this._finishCallback(this._value):!0===t&&null!==this._cancelCallback&&this._cancelCallback(),this._$trigger&&(this._$trigger.focus(),this._$trigger=null),this._finishCallback=null,this._cancelCallback=null)}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){return this._value!==e&&(this._value=e,this.valueDidChange(e)),this}},{key:"valueDidChange",value:function(e){}},{key:"prompt",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0!==t&&this.setValue(t),new Promise((function(t,n){e._finishCallback=t,e._cancelCallback=n,e.open()}))}},{key:"open",value:function(){return this.setVisible(!0)}},{key:"cancel",value:function(){return this.setVisible(!1,!0)}},{key:"finish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0!==e&&this.setValue(e),this.setVisible(!1,!1)}},{key:"render",value:function(){var e=this;return this._$dialog=this.renderDialog(),this._$outer=Ht.createElement("div",{className:"modal__outer"},[this._$dialog]),Ht.createElement("div",{className:"modal",role:"dialog",tabIndex:-1},[Ht.createElement("div",{className:"modal__backdrop"}),Ht.createElement("div",{className:"modal__scrollable",role:"document",onClick:function(t){t.target===t.currentTarget&&(t.preventDefault(),e.cancel())}},[this._$outer])])}},{key:"renderDialog",value:function(){return Ht.createElement("div",{className:"modal__dialog"},[this.renderHeader(),this.renderContent()])}},{key:"renderHeader",value:function(){var e=this,t=Ht.createElement("button",{className:"modal__btn-close",onClick:function(t){t.preventDefault(),e.cancel()}});return t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M15 2.41L13.59 1 8 6.59 2.41 1 1 2.41 6.59 8 1 13.59 2.41 15 8 9.41 13.59 15 15 13.59 9.41 8z"/></svg>',Ht.createElement("header",{className:"modal__header"},[Ht.createElement("span",{className:"modal__title"},this._title),t])}},{key:"renderContent",value:function(){}},{key:"keyDidPress",value:function(e){27===e.keyCode&&(e.preventDefault(),this.cancel())}}]),t}(Ht),Df=function(e){function t(e){var n;return nt(this,t),(n=ht(this,ot(t).call(this,"Library")))._library=e,n._filteredLibrary=e,n._categories={},n}return at(t,e),it(t,[{key:"clearFilter",value:function(){return this._filteredLibrary=this._library,this.refresh(),this}},{key:"applyFilter",value:function(e){return this._filteredLibrary=this._library.filter(e),this.refresh(),this}},{key:"render",value:function(){var e=dt(ot(t.prototype),"render",this).call(this);return e.classList.add("modal-library"),e}},{key:"renderContent",value:function(){return Ht.createElement("div",{className:"modal__content"},[this.renderBricks()])}},{key:"renderBricks",value:function(){var e=this,t=[],n=[];return this._filteredLibrary.forEach((function(e){var r=t.indexOf(e.category);-1===r?(t.push(e.category),n.push([e])):n[r].push(e)})),Ht.createElement("ul",{className:"modal-library__categories"},t.map((function(t,r){return Ht.createElement("li",{className:"modal-library__category"},[Ht.createElement("span",{className:"modal-library__category-title"},t),Ht.createElement("ul",{className:"modal-library__bricks"},n[r].map(e.renderBrick.bind(e)))])})))}},{key:"renderBrick",value:function(e){var t=this;return Ht.createElement("li",{},[Ht.createElement("button",{className:"modal-library__brick modal-library__brick--"+e.type,onClick:function(n){n.preventDefault(),t.finish(e.name)}},[Ht.createElement("span",{className:"modal-library__brick-title"},e.title)])])}}]),t}(Rf),jf="pipe__scroll-handle--disabled",qf="application/vnd.cryptii.brick+json",$f=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._$scrollable=null,e._$content=null,e._draggingBrickView=null,e._draggingTargetIndex=null,e._$pipeParts=[],e._pipePartPositions=[],e._pipePartIndex=[],e._scrollMax=0,e._scrollPosition=0,e._scrollHandleIndex=null,e._scrollHandleStartPosition=null,e._scrollHandleStartTime=null,e}return at(t,e),it(t,[{key:"render",value:function(){this._$content=Ht.createElement("div",{className:"pipe__content"}),this._$scrollHandleLeft=Ht.createElement("div",{className:"pipe__scroll-handle pipe__scroll-handle--left pipe__scroll-handle--disabled",onMouseEnter:this.scrollHandleDidStart.bind(this,0),onDragEnter:this.scrollHandleDidStart.bind(this,0),onMouseLeave:this.scrollHandleDidStop.bind(this),onDragLeave:this.scrollHandleDidStop.bind(this)}),this._$scrollHandleRight=Ht.createElement("div",{className:"pipe__scroll-handle pipe__scroll-handle--right",onMouseEnter:this.scrollHandleDidStart.bind(this,1),onDragEnter:this.scrollHandleDidStart.bind(this,1),onMouseLeave:this.scrollHandleDidStop.bind(this),onDragLeave:this.scrollHandleDidStop.bind(this)});var e=document.querySelector(".pipe");return null===e&&(e=Ht.createElement("div")).classList.add("pipe"),e.ondrop=this.dragDidDrop.bind(this),e.ondragenter=this.dragDidEnterPipe.bind(this),e.ondragover=this.dragDidOverPipe.bind(this),this._$scrollable=e.querySelector(".pipe__scrollable"),null===this._$scrollable&&(this._$scrollable=Ht.createElement("div",{className:"pipe__scrollable"})),this._$scrollable.appendChild(this._$content),this._$scrollable.appendChild(this._$scrollHandleLeft),this._$scrollable.appendChild(this._$scrollHandleRight),e.appendChild(this._$scrollable),e.addEventListener("wheel",this.mouseDidWheel.bind(this)),e}},{key:"appendSubviewElement",value:function(e){return e instanceof Tu?(this.update(),this):dt(ot(t.prototype),"appendSubviewElement",this).call(this,e)}},{key:"removeSubviewElement",value:function(e){return dt(ot(t.prototype),"removeSubviewElement",this).call(this,e),e instanceof Tu&&this.update(),this}},{key:"update",value:function(){var e=this.getModel().getBricks(),t=e.map((function(e){return e.getView()}));this.getElement();var n,r=this._$content;t.forEach((function(e){var t=e.getElement();t.parentNode&&t.parentNode.removeChild(t)})),r.innerHTML="",this._$pipeParts=[],this._pipePartIndex=[];for(var i=[],a=0;a<e.length;a++)if(e[a].isHidden()){if(i.push(e[a]),a+1===e.length||!e[a+1].isHidden()){var o=a-i.length+1;n=this._createPipePart(o),this._$pipeParts.push(n),this._pipePartIndex.push(o),r.appendChild(n),r.appendChild(this._createCollapsedPart(i)),i=[]}}else n=this._createPipePart(a),this._$pipeParts.push(n),this._pipePartIndex.push(a),r.appendChild(n),r.appendChild(this._createBrickPart(t[a]));return n=this._createPipePart(t.length),this._$pipeParts.push(n),this._pipePartIndex.push(t.length),r.appendChild(n),this.layout(),this}},{key:"_createPipePart",value:function(e){var t=this;return Ht.createElement("button",{className:"pipe__part-pipe",onClick:function(n){t.getModel().viewAddButtonDidClick(t,e),n.preventDefault()}},[Ht.createElement("div",{className:"pipe__btn-add"},"Add encoder or viewer"),Ht.createElement("div",{className:"pipe__drop-handle"})])}},{key:"_createBrickPart",value:function(e){var t=e.getModel()instanceof sc?"encoder":"viewer";return Ht.createElement("div",{className:"pipe__part-brick pipe__part-brick--".concat(t),draggable:!0,onMouseDown:this.brickDragWillStart.bind(this,e),onDragStart:this.brickDragDidStart.bind(this,e),onDragEnd:this.brickDragDidEnd.bind(this,e)},e.getElement())}},{key:"_createCollapsedPart",value:function(e){var t=this;return Ht.createElement("button",{className:"pipe__part-collapsed",onClick:function(n){t.getModel().viewHiddenBrickGroupDidClick(t,e),n.preventDefault()}},e.map((function(){return Ht.createElement("div",{className:"pipe__part-collapsed-fold"})})))}},{key:"isBrickDragEvent",value:function(e){var t=e.dataTransfer.types;return void 0!==t.contains?t.contains(qf):-1!==t.indexOf(qf)}},{key:"isFieldMouseEvent",value:function(e){var t=e.target.nodeName.toLowerCase();return-1!==["textarea","input"].indexOf(t)}},{key:"brickDragWillStart",value:function(e,t){if(this.isFieldMouseEvent(t)||!e.getModel().isValid()){var n=e.getElement().parentNode;n&&(n.draggable=!1,setTimeout((function(){n.draggable=!0}),500))}}},{key:"brickDragDidStart",value:function(e,t){if(!this.isFieldMouseEvent(t)&&e.getModel().isValid()){this._draggingBrickView=e;var n=JSON.stringify(e.getModel().serialize());t.dataTransfer.setData(qf,n),t.dataTransfer.setData("application/json",n),t.dataTransfer.effectAllowed="copyMove"}}},{key:"brickDragDidEnd",value:function(e,t){this._draggingBrickView=null,this.setDraggingPipePartIndex(null)}},{key:"dragDidEnterPipe",value:function(e){this.isBrickDragEvent(e)&&e.preventDefault()}},{key:"dragDidOverPipe",value:function(e){if(this.isBrickDragEvent(e)){e.preventDefault();var t=e.pageX+this._scrollPosition,n=e.pageY,r=null,i=0;this._pipePartPositions.forEach((function(e,a){var o=Math.sqrt(Math.pow(t-e.x,2)+Math.pow(n-e.y,2));(null===r||o<r)&&(r=o,i=a)})),this.setDraggingPipePartIndex(i)}}},{key:"dragDidDrop",value:function(e){if(this.isBrickDragEvent(e)){e.preventDefault();var t="copy"===e.dataTransfer.effectAllowed,n=this._pipePartIndex[this._draggingTargetIndex];if(this.setDraggingPipePartIndex(null),null!==this._draggingBrickView){var r=this._draggingBrickView.getModel();this.getModel().viewBrickDidDrop(this,n,r,t)}else{var i=JSON.parse(e.dataTransfer.getData(qf));this.getModel().viewBrickDidDrop(this,n,i,t)}}}},{key:"setDraggingPipePartIndex",value:function(e){this._draggingTargetIndex!==e&&(null!==this._draggingTargetIndex&&this._$pipeParts[this._draggingTargetIndex].classList.remove("pipe__part-pipe--dragging"),this._draggingTargetIndex=e,null!==e?(this._$pipeParts[this._draggingTargetIndex].classList.add("pipe__part-pipe--dragging"),this.getElement().classList.add("pipe--dragging")):this.getElement().classList.remove("pipe--dragging"))}},{key:"mouseDidWheel",value:function(e){var t=e.deltaX,n=e.deltaY;Math.abs(t)<=Math.abs(n)||(e.preventDefault(),this.scrollTo(this._scrollPosition+t))}},{key:"scrollHandleDidStart",value:function(e){this._scrollHandleIndex=e,this._scrollHandleStartPosition=this._scrollPosition,this._scrollHandleStartTime=(new Date).getTime(),window.requestAnimationFrame(this.scrollHandleDidScroll.bind(this))}},{key:"scrollHandleDidScroll",value:function(){if(null!==this._scrollHandleIndex){var e=0===this._scrollHandleIndex?-1:1,t=((new Date).getTime()-this._scrollHandleStartTime)/1e3,n=e*Math.pow(t,2)*1e3;this.scrollTo(this._scrollHandleStartPosition+n),window.requestAnimationFrame(this.scrollHandleDidScroll.bind(this))}}},{key:"scrollHandleDidStop",value:function(){this._scrollHandleIndex=null,this._scrollHandleStartPosition=null,this._scrollHandleStartTime=null}},{key:"layout",value:function(){var e=this;dt(ot(t.prototype),"layout",this).call(this),this._scrollMax=this._$content.offsetWidth-this._$scrollable.offsetWidth,this.scrollTo(this._scrollPosition),0===this._scrollPosition?this._$scrollHandleLeft.classList.add(jf):this._$scrollHandleLeft.classList.remove(jf),this._scrollPosition===this._scrollMax?this._$scrollHandleRight.classList.add(jf):this._$scrollHandleRight.classList.remove(jf);var n=window.scrollY;this._pipePartPositions=this._$pipeParts.map((function(t){var r=t.getBoundingClientRect();return{x:r.left+.5*r.width+e._scrollPosition,y:r.top+.5*r.height+n}}))}},{key:"scrollTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e=parseInt(e),e=Math.max(Math.min(e,this._scrollMax),0),this._scrollPosition!==e&&(0===e?(this._$scrollHandleLeft.classList.add(jf),this.scrollHandleDidStop()):0===this._scrollPosition&&this._$scrollHandleLeft.classList.remove(jf),e===this._scrollMax?(this._$scrollHandleRight.classList.add(jf),this.scrollHandleDidStop()):this._scrollPosition===this._scrollMax&&this._$scrollHandleRight.classList.remove(jf),this._$content.style.transform=e>0?"translate(".concat(-e,"px, 0)"):"",this._scrollPosition=e),this}}]),t}(Ht),Uf=function(e){function t(){var e;return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=$f,e._brickFactory=null,e._service=null,e._id=null,e._url=null,e._title=null,e._description=null,e._bricks=[],e._brickState=[],e._bucketContent=[el.empty()],e._bucketListeners=[[]],e._selectedBucket=0,e._libraryModalView=null,e}return at(t,e),it(t,[{key:"getId",value:function(){return this._id}},{key:"setId",value:function(e){return this._id=e,this}},{key:"getUrl",value:function(){return this._url}},{key:"setUrl",value:function(e){return this._url=e,this}},{key:"getTitle",value:function(){return this._title}},{key:"setTitle",value:function(e){return this._title=e,this}},{key:"getDescription",value:function(){return this._description}},{key:"setDescription",value:function(e){return this._description=e,this}},{key:"getBrickFactory",value:function(){return this._brickFactory}},{key:"setBrickFactory",value:function(e){return this._brickFactory=e,this}},{key:"getService",value:function(){return this._service}},{key:"setService",value:function(e){return this._service=e,this}},{key:"getLibraryModalView",value:function(){if(null===this._libraryModalView){var e=this.getBrickFactory().getLibrary();this._libraryModalView=new Df(e)}return this._libraryModalView}},{key:"getLength",value:function(){return this._bricks.length}},{key:"getBricks",value:function(){return this._bricks.slice()}},{key:"getBrick",value:function(e){if(e<0||e>this._bricks.length)throw new Error("Brick index is out of bounds.");return this._bricks[e]}},{key:"containsBrick",value:function(e){return-1!==this._bricks.indexOf(e)}},{key:"addBrick",value:function(e){return this.spliceBricks(-1,0,[e]),this}},{key:"addBricks",value:function(e){return this.spliceBricks(-1,0,e),this}},{key:"duplicateBrick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.containsBrick(e))throw new Error("Brick is not part of the pipe.");return null===t&&(t=this._bricks.indexOf(e)),this.spliceBricks(t,0,[e.copy()]),this}},{key:"moveBrick",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Brick is not part of the pipe.");return t>n&&t--,this.spliceBricks(n,1),this.spliceBricks(t,0,[e]),this}},{key:"removeBrick",value:function(e){var t=e;if(e instanceof ic&&-1===(t=this._bricks.indexOf(e)))throw new Error("Brick is not part of the pipe and thus can't be removed.");return this.spliceBricks(t,1),this}},{key:"removeBricks",value:function(e){var t=this;return e.map((function(e){var n=e;if(e instanceof ic&&-1===(n=t._bricks.indexOf(e)))throw new Error("Brick is not part of the pipe and thus can't be removed.");return n})).sort((function(e,t){return t-e})).forEach((function(e){return t.spliceBricks(e,1)})),this}},{key:"replaceBrick",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Can't replace a brick not being part of the pipe.");return this.spliceBricks(n,1,[t]),this}},{key:"spliceBricks",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e=e>=0?e:Math.max(this._bricks.length+e+1,0),this._bucketListeners.map((function(e){return e.forEach((function(e){return e.reject("Pipe bricks have been changed.")})),[]})),r=r.map((function(e){return e instanceof ic?e:ic.extract(e,n.getBrickFactory())}));var i=this._bricks.splice.apply(this._bricks,[e,t].concat(r));this._brickState.splice.apply(this._brickState,[e,t].concat(r.map((function(){return{settingsVersion:1,busy:!1}}))));var a=0,o=0;if(r.forEach((function(e){e.setPipe(n),n.hasView()&&n.getView().addSubview(e.getView()),e instanceof sc&&a++,Pu.trigger("pipeAddBrick",{pipe:n,brick:e})})),i.forEach((function(e){n.hasView()&&n.getView().removeSubview(e.getView()),e.setPipe(null),e instanceof sc&&o++,Pu.trigger("pipeRemoveBrick",{pipe:n,brick:e})})),a>0||o>0){var s=this._bricks.reduce((function(t,n,r){return t+(n instanceof sc&&r<=e?1:0)}),0);0===s&&(s=1);var l=new Array(a).fill().map((function(){return el.empty()})),u=this._bucketContent.splice.apply(this._bucketContent,[s,o].concat(l));if(this._bucketListeners.splice.apply(this._bucketListeners,[s,o].concat(l.map((function(e){return[]})))),this._selectedBucket<=s-1)this._propagateContent(s-1,!0);else if(this._selectedBucket===s&&1===o&&1===a)this._bucketContent[this._selectedBucket]=u[0],this._propagateContent(this._selectedBucket,!1);else if(this._selectedBucket<=s-1+o)this._selectedBucket=s-1,this._propagateContent(this._selectedBucket,!0);else{var c=a-o;this._selectedBucket+=c,this._propagateContent(s+a,!1)}}else r.forEach((function(e){return n._triggerViewerView(e)}));return this.hasView()&&this.getView().layout(),i}},{key:"getBucketLength",value:function(){return this._bucketContent.length}},{key:"getContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t>=this._bucketContent.length)throw new Error("Bucket index ".concat(t," is out of bounds."));return n&&this.isBusy()?new Promise((function(n,r){e._bucketListeners[t].push({resolve:n,reject:r})})):this._bucketContent[t]}},{key:"setContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e=el.wrap(e),this.getContent(t,!1).isEqualTo(e)?this:(this._bucketContent[t]=e,(null===n||n instanceof kh)&&(this._selectedBucket=t),this._propagateContent(t,n),this)}},{key:"_propagateContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBricksAttachedToBucket(e),r=n.lowerEncoder,i=n.upperEncoder,a=n.viewers;return a.filter((function(e){return e!==t})).forEach(this._triggerViewerView.bind(this)),null!==r&&!0!==t&&r!==t&&this._triggerEncoderTranslation(r,!1),null!==i&&!1!==t&&i!==t&&this._triggerEncoderTranslation(i,!0),this}},{key:"_triggerViewerView",value:function(e){var t,n,r,i,a,o;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._getBrickState(e,"busy")){s.next=2;break}return s.abrupt("return",this);case 2:return this._setBrickState(e,"busy",!0),t=this.getBucketIndexForBrick(e),n=this.getContent(t,!1),r=this._getBrickState(e,"settingsVersion"),s.prev=6,s.next=9,regeneratorRuntime.awrap(e.view(n));case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(6),i=s.t0;case 14:if(this.containsBrick(e)){s.next=16;break}return s.abrupt("return");case 16:if(this._setBrickState(e,"busy",!1),a=this._getBrickState(e,"settingsVersion"),o=this.getBucketIndexForBrick(e),this.getContent(o,!1).isEqualTo(n)&&r===a||this._triggerViewerView(e),this.brickDidFinish(e,i),!i||i instanceof Hs){s.next=23;break}throw i;case 23:case"end":return s.stop()}}),null,this,[[6,11]])}},{key:"_triggerEncoderTranslation",value:function(e,t){var n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(!this._getBrickState(e,"busy")){d.next=2;break}return d.abrupt("return",this);case 2:return this._setBrickState(e,"busy",!0),n=this.getBucketIndexForBrick(e),r=this.getContent(n+(t?0:1),!1),i=this._getBrickState(e,"settingsVersion"),d.prev=6,d.next=9,regeneratorRuntime.awrap(e.translate(r,t));case 9:a=d.sent,d.next=15;break;case 12:d.prev=12,d.t0=d.catch(6),o=d.t0;case 15:if(this.containsBrick(e)){d.next=17;break}return d.abrupt("return");case 17:if(this._setBrickState(e,"busy",!1),s=this._getBrickState(e,"settingsVersion"),l=this.getBucketIndexForBrick(e),u=l+(t?0:1),c=this.getContent(u,!1),h=l+(t?1:0),!(t&&this._selectedBucket>=h||!t&&this._selectedBucket<=h)){d.next=26;break}return this._triggerEncoderTranslation(e,!t),d.abrupt("return");case 26:if(o||this.setContent(a,h,e),c.isEqualTo(r)&&i===s||this._triggerEncoderTranslation(e,t),this.brickDidFinish(e,o),!o||o instanceof Hs){d.next=31;break}throw o;case 31:case"end":return d.stop()}}),null,this,[[6,12]])}},{key:"_getBrickState",value:function(e,t){var n=this._bricks.indexOf(e);if(-1===n)throw new Error("Brick is not part of the pipe and thus has no state.");return this._brickState[n][t]}},{key:"_setBrickState",value:function(e,t,n){var r=this._bricks.indexOf(e);if(-1===r)throw new Error("Brick is not part of the pipe and thus has no state.");return this._brickState[r][t]=n,this}},{key:"isBusy",value:function(){var e=this;return this._bricks.reduce((function(t,n){return t||e._getBrickState(n,"busy")}),!1)}},{key:"getBucketIndexForBrick",value:function(e){for(var t=!1,n=0,r=-1;!t&&++r<this._bricks.length;)this._bricks[r]===e?t=!0:this._bricks[r]instanceof sc&&n++;if(!t)throw new Error("Can't find bucket for brick. Brick is not part of Pipe.");return n}},{key:"getBricksAttachedToBucket",value:function(e){for(var t,n=null,r=null,i=[],a=0,o=-1;++o<this._bricks.length&&a<=e;)(t=this._bricks[o])instanceof sc?(a===e-1?n=t:a===e&&(r=t),a++):a===e&&i.push(t);return{lowerEncoder:n,upperEncoder:r,viewers:i}}},{key:"viewerContentDidChange",value:function(e,t){if(this.containsBrick(e)){var n=this.getBucketIndexForBrick(e);this.setContent(t,n,e)}}},{key:"brickVisibilityDidChange",value:function(e,t){this.updateView()}},{key:"brickSettingDidChange",value:function(e){if(this.containsBrick(e))if(this._setBrickState(e,"settingsVersion",this._getBrickState(e,"settingsVersion")+1),e instanceof sc){var t=this.getBucketIndexForBrick(e),n=this._selectedBucket<=t;this._triggerEncoderTranslation(e,n)}else this._triggerViewerView(e)}},{key:"encoderDidReverse",value:function(e,t){if(3===this._bricks.length&&"viewer"===this._bricks[0].getMeta().type&&"encoder"===this._bricks[1].getMeta().type&&"viewer"===this._bricks[2].getMeta().type){var n=this.getContent(1,!1),r=this.spliceBricks(0,3);r.reverse(),this.setContent(n,0),this.spliceBricks(0,0,r)}else this.brickSettingDidChange(e)}},{key:"brickDidFinish",value:function(e,t){var n=this;this.isBusy()||this._bucketListeners.map((function(e,r){return e.forEach((function(e){return null!==t?e.resolve(n.getContent(r,!1)):e.reject(t)})),[]}))}},{key:"brickReplaceButtonDidClick",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if((t=this.getLibraryModalView()).applyFilter((function(t){return t.type===e.getMeta().type})),!t.isVisible()){i.next=4;break}return i.abrupt("return");case 4:return n=e.getMeta().name,i.prev=5,i.next=8,regeneratorRuntime.awrap(t.prompt(n));case 8:n=i.sent,i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(5),i.abrupt("return");case 14:n!==e.getMeta().name&&(r=this.getBrickFactory().create(n),e instanceof sc&&r instanceof sc&&r.setReverse(e.isReverse()),this.replaceBrick(e,r));case 15:case"end":return i.stop()}}),null,this,[[5,11]])}},{key:"viewAddButtonDidClick",value:function(e,t){var n,r,i;return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return Pu.trigger("pipeAddButtonClick",{pipe:this,index:t}),(n=this.getLibraryModalView()).clearFilter(),e.prev=3,e.next=6,regeneratorRuntime.awrap(n.prompt());case 6:r=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return");case 12:i=this.getBrickFactory().create(r),this.spliceBricks(t,0,[i]);case 14:case"end":return e.stop()}}),null,this,[[3,9]])}},{key:"viewBrickDidDrop",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n instanceof ic?r?this.duplicateBrick(n,t):this.moveBrick(n,t):this.spliceBricks(t,0,[n]),Pu.trigger("pipeBrickDrop",{pipe:this,index:t,brick:n,copy:r})}},{key:"viewHiddenBrickGroupDidClick",value:function(e,t){t.forEach((function(e){return e.setHidden(!1)})),Pu.trigger("pipeHiddenBrickGroupClick",{pipe:this,bricks:t})}},{key:"didCreateView",value:function(e){this._bricks.forEach((function(t){return e.addSubview(t.getView())}))}},{key:"store",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.getService().storePipe(this));case 2:return e=t.sent,t.abrupt("return",e.url);case 4:case"end":return t.stop()}}),null,this)}},{key:"serialize",value:function(){var e={};null!==this._id&&(e.id=this._id),null!==this._url&&(e.url=this._url),null!==this._title&&(e.title=this._title),null!==this._description&&(e.description=this._description),e.items=this._bricks.map((function(e){return e.serialize()}));var t=this._selectedBucket,n=this._bucketContent[t];if(!n.isEmpty()||t>0){e.content={},n.needsTextEncoding()?(e.content.data=Xs.base64StringFromBytes(n.getBytes()),e.content.encoding="base64"):e.content.data=n.getString();var r=this.getBricksAttachedToBucket(t).lowerEncoder;null!==r&&(e.content.index=this._bricks.indexOf(r)+1)}return e}}],[{key:"extract",value:function(e,n){if(!Array.isArray(e.items)||0===e.items.length)throw new Error("Pipe property 'items' is expected to be of type 'array' and must not be empty");var r=new t;if(r.setBrickFactory(n),r.addBricks(e.items),void 0!==e.id&&null!==e.id){if("number"!=typeof e.id)throw new Error("Optional pipe property 'id' is expected to be of type 'number'");r.setId(e.id)}if(void 0!==e.url&&null!==e.url){if("string"!=typeof e.url)throw new Error("Optional pipe property 'url' is expected to be of type 'string'");r.setUrl(e.url)}if(void 0!==e.title&&null!==e.title){if("string"!=typeof e.title)throw new Error("Optional pipe property 'title' is expected to be of type 'string'");r.setTitle(e.title)}if(void 0!==e.description&&null!==e.description){if("string"!=typeof e.description)throw new Error("Optional pipe property 'description' is expected to be of type 'string'");r.setDescription(e.description)}var i="",a=0;if(void 0!==e.content&&null!==e.content){if("object"!==tt(e.content))throw new Error("Optional pipe property 'content' is expected to be of type 'object'");if(void 0===e.content.data||"string"!=typeof e.content.data)throw new Error("Pipe property 'content.data' is expected to be of type 'string'");if(void 0!==e.content.encoding&&"string"!=typeof e.content.encoding)throw new Error("Optional pipe property 'content.encoding' is expected to be of type 'string'");if(void 0!==e.content.index&&"number"!=typeof e.content.index)throw new Error("Optional pipe property 'content.index' is expected to be of type 'number'");var o=e.content.encoding||"text";switch(o){case"text":i=e.content.data;break;case"base64":i=Xs.bytesFromBase64String(e.content.data);break;default:throw new Error("Optional pipe property 'content.encoding' is set to an unsupported "+"encoding '".concat(o,"'; Supported values: text, base64"))}var s=e.content.index||0;if(s===r.getLength())a=r.getBucketLength()-1;else{if(!(s>=0&&s<r.getLength()))throw new Error("Optional pipe property 'content.index' is expected to be a number "+"ranging from 0 to ".concat(r.getBucketLength()-1));a=r.getBucketIndexForBrick(r.getBrick(s))}}return r.setContent(i,a),r}}]),t}(Bu),Wf="v1",Gf=function(){function e(t){nt(this,e),this._rootEndpoint="".concat(t,"/").concat(Wf)}return it(e,[{key:"createSession",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(window.fetch("".concat(this._rootEndpoint,"/session")));case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Unable to create a session");case 5:return t.abrupt("return",e.json());case 6:case"end":return t.stop()}}),null,this)}},{key:"storePipe",value:function(e){var t,n,r;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.createSession());case 2:return t=i.sent,i.next=5,regeneratorRuntime.awrap(window.fetch("".concat(this._rootEndpoint,"/pipes"),{method:"POST",headers:{"Content-type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify(e.serialize())}));case 5:if((n=i.sent).ok){i.next=8;break}throw new Error("Unable to store this pipe");case 8:return i.next=10,regeneratorRuntime.awrap(n.json());case 10:if(void 0===(r=i.sent).error){i.next=13;break}throw new Error("Unable to store this pipe: "+r.error.message);case 13:return i.abrupt("return",r);case 14:case"end":return i.stop()}}),null,this)}}]),e}(),Hf={version:"4.0.8+master.8c1558b",scope:"/",serviceEndpoint:"https://cryptii.com/api",serviceWorkerUrl:null},Kf=null,Zf=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return nt(this,t),(e=ht(this,ot(t).call(this)))._viewPrototype=Kt,e._pipe=null,e._config=Object.assign(Hf,n),e._service=new Gf(e._config.serviceEndpoint),Kf=ct(e),e}return at(t,e),it(t,[{key:"run",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Yc.placeBrowserAttribute(),null!==t?this._pipe=Uf.extract(t,Nf.getInstance()):(this._pipe=new Uf,this._pipe.setBrickFactory(Nf.getInstance())),this._pipe.setService(this._service);var n=this.getView();return n.layout(),setTimeout(n.layout.bind(n),100),"undefined"!=typeof navigator&&"serviceWorker"in navigator&&(this._config.serviceWorkerUrl?navigator.serviceWorker.register(this._config.serviceWorkerUrl,{scope:this._config.scope}):navigator.serviceWorker.getRegistrations().then((function(e){return e.forEach((function(e){return e.unregister()}))}))),Yc.isBrowser()&&document.addEventListener("keydown",(function(t){t.ctrlKey&&"i"===t.key&&(t.preventDefault(),alert(e.debug()))})),this}},{key:"debug",value:function(){return JSON.stringify({version:this._config.version,env:Yc.identify(),pipe:this.getPipe().serialize()})}},{key:"getPipe",value:function(){return this._pipe}},{key:"didCreateView",value:function(e){e.addSubview(this._pipe.getView())}}],[{key:"getInstance",value:function(){return Kf}}]),t}(Bu);if(Yc.isBrowser()&&null!==document.querySelector("script[data-cryptii-init]")){var Xf=function(){var e=document.querySelector("script[data-cryptii-pipe]"),t=null!==e?JSON.parse(e.innerHTML):null,n=document.querySelector("script[data-cryptii-config]"),r=null!==n?JSON.parse(n.innerHTML):{};new Zf(r).run(t)};"loading"!==document.readyState?Xf():window.addEventListener("DOMContentLoaded",Xf)}e.App=Zf,e.ArrayUtil=ms,e.Brick=ic,e.BrickFactory=Nf,e.ByteEncoder=Xs,e.ByteEncodingError=Ks,e.Chain=el,e.Encoder=sc,e.EnvUtil=Yc,e.EventManager=Pu,e.Factory=en,e.Field=zu,e.FieldFactory=nc,e.Form=rc,e.GenericError=Gs,e.InvalidInputError=Hs,e.LibraryModalView=Df,e.MathUtil=oc,e.ModalView=Rf,e.Pipe=Uf,e.Random=ys,e.StringUtil=Ws,e.TextEncoder=Js,e.TextEncodingError=Ys,e.View=Ht,e.Viewable=Bu,e.Viewer=kh,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=cryptii.js.map
